{"texts": ["WorkGroup Data Service with JSON / Web based API", "I'm wondering if this code can be made more clear and fluent:\n\nusing System;\nusing System.Threading.Tasks;\nusing Windows.Data.Json;\nusing System.Collections.ObjectModel;\nusing System.Net.Http;\nusing System.Collections.Generic;\nusing Newtonsoft.Json;\nusing System.Linq;\nusing eTest.Space.Log;\nusing eTest.Space.Interface;\nusing eTest.Objects;\n\nnamespace eTest.Space.Services\n{\n\n    public class WorkGroupDataService : IWorkgroupDataService\n    {\n\n\n        public string WebApiUri\n        {\n            get { return Constants.ServerAddress; }\n        }\n\n        private ObservableCollection&lt;IWorkgroup&gt; Groups;// = new ObservableCollection&lt;IWorkgroup&gt;();\n\n        public async Task&lt;ObservableCollection&lt;IWorkgroup&gt;&gt; GetAllWorkGroups()\n        {\n            Groups = new ObservableCollection&lt;IWorkgroup&gt;();\n            //if (Groups.Count == 0)\n            {\n                Uri dataUri = new Uri(WebApiUri + \"api/workgroup/\");\n\n                using (var client = new Windows.Web.Http.HttpClient())\n                {\n                    var response = await client.GetAsync(dataUri).AsTask(); ;\n\n                    string jsonText = response.Content.ReadAsStringAsync().GetResults();\n                    JsonArray jsonArray = JsonArray.Parse(jsonText);\n\n                    foreach (JsonValue groupValue in jsonArray)\n                    {\n                        JsonObject groupObject = groupValue.GetObject();\n                        IWorkgroup group = new Workgroup();\n                        group.GroupState = (int)groupObject[\"GroupState\"].GetNumber();\n                        group.WorkgroupName = groupObject[\"WorkgroupName\"].GetString();\n                        group.WorkgroupSecretary = groupObject[\"WorkgroupProba\"].GetString();\n                        group.ObjectID = groupObject[\"ObjectID\"].GetString();\n                        Uri dataUri1 = new Uri(WebApiUri + \"api/etest/\" + group.ObjectID);\n                        using (var client1 = new Windows.Web.Http.HttpClient())\n                        {\n                            var response1 = await client.GetAsync(dataUri1).AsTask();\n                            if (response1.StatusCode == Windows.Web.Http.HttpStatusCode.Ok)\n                            {\n                                string jsonText1 = response1.Content.ReadAsStringAsync().GetResults();\n                                List&lt;TestSession&gt; Test = JsonConvert.DeserializeObject&lt;List&lt;TestSession&gt;&gt;(jsonText1);\n                                group.Test = Test;\n                            }\n                        }\n                        if (group.Test.Count &gt; 0)\n                        {\n                            Groups.Add(group);\n                        }\n\n                    }\n                }\n            }\n            Groups = new ObservableCollection&lt;IWorkgroup&gt;(Groups.OrderByDescending((x =&gt; x.Test.Count)));\n            return Groups;\n        }\n    }\n}"], "tags": ["c#", "linq", "json"]}
{"texts": ["Design pattern for logger implementation", "I have two classes ExceptionLog and DebugLog\n\npublic class ExceptionLog {\n    public static String StackTrace {get; set;}\n    public static String ClassName {get; set;}\n    public static String MethodName {get; set;}\n    public static String LogType {get;set;}\n    public static Exception ex {get;set;}\n\n    public Static void Debug(Exception ex)\n    {\n        logType = 'EXCEPTION'; \n        ex = ex;\n        log();\n    }\n\n    public Static void log()\n    {\n        try\n        {\n            extractException(); \n            writeToObject(); \n\n        }\n        catch(Exception e)\n        {\n            //new ExceptionLog().Module('LogException').log(e);            \n        }    \n    }\n\n    public static void extractException()\n    {\n        // Logic here            \n    }\n\n    public static void writeToObject()\n    {        \n        // data save to object logic here       \n    }    \n}\n\n\nand \n\npublic class DebugLog {\n    public static String LogType {get;set;}\n    public static String DebugMessage {get;set;} \n\n    public Static void Debug(String message)\n    {\n        Debug(null, message);\n    }\n\n    public Static void Debug(LoggingLevel level, String message)\n    {\n        if(level != null )\n        {\n            LogType = String.valueOf(level);             \n        }        \n\n        DebugMessage = message;\n\n        log();\n    }\n\n    public Static void log()\n    {\n        // Log logic here   \n    }        \n\n}\n\n\nWhat I want to achieve is, write a controller class that will make decision of which debug method needs to be called\n\npublic class Log {\n    public void Debug(String message)\n    {\n        DebugLog.Debug(message);\n    }\n    public void Debug(loggingLevel loggingLevel, String message)\n    {\n        DebugLog.Debug(loggingLevel, message);    \n    }\n    public void Debug(Exception ex)\n    {\n        ExceptionLog.Debug(ex);\n    }\n}\n\n\nThat is, if I pass Exception in the debug method, it will call the ExceptionLog.Debug(ex) else it will call the debug method from DebugLog class.\n\nWhat should be the aprroach here ?"], "tags": ["object-oriented", "design-patterns", "salesforce-apex"]}
{"texts": ["Temperature calculator in Rust", "Just on a chapter 3 of Rust Book so not much good in Rust.\nso tried to implement a simple temprature calculator as suggest in this chapter.\nso i would like you guys to point anything you feel\n\nuse std::io;\n\nfn main() {\n    println!(\"Enter Temperature as 56f or 98c\");\n\n    let mut usr_inpt = String::new();\n\n    io::stdin()\n        .read_line(&amp;mut usr_inpt)\n        .expect(\"can not read user input\");\n\n    let usr_inpt = usr_inpt.trim_end().to_lowercase();\n\n    if usr_inpt.ends_with(\"f\") || usr_inpt.ends_with(\"c\") {\n        // remove the last indication 56f -&gt; 56 or 56c -&gt; 56\n        let _temp: String = usr_inpt.chars().take(usr_inpt.len() - 1).collect();\n        let num: u32 = match _temp.parse() {\n            Ok(num) =&gt; num,\n            Err(_) =&gt; 0,\n        };\n\n        if usr_inpt.ends_with(\"f\") {\n            println!(\"celcius -&gt; {}\", (num - 32) * 5 / 9);\n        } else if usr_inpt.ends_with(\"c\") {\n            println!(\"farenheit -&gt; {}\", num * 9 / 5 + 32);\n        }\n    } else {\n        println!(\"invalid input\");\n    }\n}"], "tags": ["beginner", "rust", "unit-conversion"]}
{"texts": ["Read binary serial data and parse integers", "I'm reading serial data in binary format from a stream, and I'm not happy with how I extract the data because it takes so much operations to extract the binary data from a simple line of binary data.\n\nEach line starts with a character indicating the type of data, and afterwards follow a few 16 bit integers (big endian), followed by a checksum character and a newline.\n\nHere's a sample of what line would be after reading:\n\nline = \"F{3x 16 bit int big endian}{checksum character}\\n\"\n\n\nThis is the simplified code in question:\n\n  byte[] b = new byte[2];\n  System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();\n\n  // Check that the port is open. If not skip and do nothing\n    if (SerialPort.IsOpen)\n    {\n        while(SerialPort.BytesToRead &gt; 50){\n\n            // read line and turn string in byte array\n            string line = SerialPort.ReadLine();\n            byte[] encoded = enc.GetBytes(line);\n\n            if (line[0]=='F'){\n\n                // copy 16 bit int into byte-array\n                Array.Copy(encoded, 1, b, 0, 2);\n                // -&gt; big endian\n                Array.Reverse(b);\n\n                // turn into integer\n                short value1 = BitConverter.ToInt16(b, 0);\n\n                Array.Copy(encoded, 3, b, 0, 2);\n                Array.Reverse(b);\n                short value1 = BitConverter.ToInt16(b, 0);\n\n\n                Array.Copy(encoded, 5, b, 0, 2);\n                Array.Reverse(b);\n                short value3 = BitConverter.ToInt16(b, 0);\n            }\n\n        }\n        this.bytesAvailable = SerialPort.BytesToRead;\n\n\nIs there a smarter way to accomplish the result of my code above?"], "tags": ["c#", "serial-port"]}
{"texts": ["Brain-flak interpreter", "I'm learning Go, so I decided to make a Brain-flak interpreter for practice.\n\npackage main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"bufio\"\n    \"os\"\n)\n\nvar openToClose map[rune]rune = map[rune]rune {\n    '(': ')',\n    '[': ']',\n    '{': '}',\n    '&lt;': '&gt;',\n    '&amp;': '^',\n}\n\nvar bracketNames map[rune]string = map[rune]string {\n    '(': \"round\",\n    '[': \"square\",\n    '{': \"curly\",\n    '&lt;': \"angle\",\n    '&amp;': \"internal\",\n}\n\ntype bracket struct {\n    bracketType rune\n    subExprs []bracket\n}\n\nfunc (b bracket) String() string {\n  var stringSubs []string\n  for _, subExpr := range b.subExprs {\n    stringSubs = append(stringSubs, subExpr.String())\n  }\n  return bracketNames[b.bracketType] + \"(\" + strings.Join(stringSubs, \", \") + \")\"\n}\n\ntype stack []int\n\nfunc (s *stack) push(val int) {\n    *s = append(*s, val)\n}\n\nfunc (s *stack) pop() int {\n    var size int = len(*s)\n    if size == 0 {\n        return 0\n    } else {\n        var val int = (*s)[size - 1]\n        *s = (*s)[:size - 1]\n        return val\n    }\n}\n\nfunc (s stack) peek() int {\n  var size int = len(s)\n  if size == 0 {\n    return 0\n  } else {\n    return s[size - 1]\n  }\n}\n\ntype environment struct {\n    active stack    \n    inactive stack\n}\n\nfunc (e *environment) swap() {\n    e.active, e.inactive = e.inactive, e.active\n}\n\nfunc (e *environment) push(val int) {\n    e.active.push(val)\n}\n\nfunc (e *environment) pop() int {\n    return e.active.pop()\n}\n\nfunc (e environment) peek() int {\n  return e.active.peek()\n}\n\nfunc (e environment) size() int {\n    return len(e.active)\n}\n\nfunc (e *environment) EvalArgs(args []bracket) int {\n  var result int = 0\n  for _, arg := range args {\n    result += e.EvalArg(arg)\n  }\n  return result\n}\n\nfunc (e *environment)EvalArg(arg bracket) int {\n  var nilad bool = len(arg.subExprs) == 0\n  var name string = bracketNames[arg.bracketType]\n  var args = arg.subExprs\n  switch name {\n  case \"round\":\n    return e.round(args, nilad)\n  case \"square\":\n    return e.square(args, nilad)\n  case \"curly\":\n    return e.curly(args, nilad)\n  case \"angle\":\n    return e.angle(args, nilad)\n  case \"internal\":\n    return e.EvalArgs(args)\n  default:\n    panic(\"Tried to execute bad command \" + name)\n  }\n}\n\nfunc (e *environment) round(args []bracket, nilad bool) int {\n  if nilad {\n    return 1\n  } else {\n    var result int = e.EvalArgs(args)\n    e.push(result)\n    return result\n  }\n}\n\nfunc (e *environment) square(args []bracket, nilad bool) int {\n  if nilad {\n    return e.size()\n  } else {\n    return -e.EvalArgs(args)\n  }\n}\n\nfunc (e *environment) curly(args []bracket, nilad bool) int {\n  if nilad {\n    return e.pop()\n  } else {\n    var result int = 0\n    for e.peek() != 0 {\n      result += e.EvalArgs(args)\n    }\n    return result\n  }\n}\n\nfunc (e *environment) angle(args []bracket, nilad bool) int {\n  if nilad {\n    e.swap()\n  } else {\n    e.EvalArgs(args)\n  }\n  return 0\n}\n\nfunc (e *environment) Interpret(code string) int {\n  return e.EvalArgs(Parse(code))\n}\n\nfunc parseHelper(code []rune, index int) (bracket, int) {\n    var openingBracket rune = code[index]\n    var closingBracket rune = openToClose[openingBracket]\n    var subExprs []bracket = []bracket{}\n    var currInd int = index + 1\n    var newExpr bracket\n    for code[currInd] != closingBracket {\n        newExpr, currInd = parseHelper(code, currInd)\n        subExprs = append(subExprs, newExpr)\n    }\n    return bracket{openingBracket, subExprs}, currInd + 1\n}\n\nfunc Parse(code string) []bracket {\n  parsed, _ := parseHelper([]rune(\"&amp;\" + code + \"^\"), 0)\n  return parsed.subExprs\n}\n\nfunc main() {\n    var e environment\n    codeReader := bufio.NewReader(os.Stdin)\n    for {\n      code, _ := codeReader.ReadString('\\n')\n      code = strings.Trim(code, \"\\n\")\n      fmt.Println(code)\n      fmt.Println(e.Interpret(code))\n    }\n}\n\n\nMy main questions are:\n\n\nIs there a better way to implement that switch statement? It doesn't\nreally follow DRY.\nWould it be better to replace the \"internal\" bracket system with\nthe loop in parseHelper?\nHow could I make this shorter and more readable?"], "tags": ["parsing", "go", "interpreter"]}
{"texts": ["Implement bash auto completion in Python", "I created a script supposed to use python to autocomplete Python commands. The full code is available here, however, I can give you an example. For instance, let's consider:\n\n\ncommand, the command I want to give completion to (it does not have to actually exist).\nscript.py, the auto completion script.\n\n\nimport os, shlex\n\n\ndef complete(current_word, full_line):\n    split = shlex.split(full_line)\n    prefixes = (\"test\", \"test-\u4e2d\u6587\", 'test-\ud55c\uae00')\n    items = list(i + \"-level-\" + current_word for i in prefixes)\n    word = \"\" if len(split) - 1 &lt; int(current_word) else split[int(current_word)]\n    return list(i for i in items if i.startswith(word))\n\n\nif __name__ == \"__main__\":\n    os.sys.stdout.write(\" \".join(complete(\n            *os.sys.argv.__getitem__(slice(2, None)))))\n    os.sys.stdout.flush()\n\n\nThe following script can be executed directly into the shell, or added in the .bashrc to keep the changes persistent.\n\n__complete_command() {\n    COMPREPLY=($(python3 script.py complete $COMP_CWORD \"${COMP_LINE}\"));\n};\ncomplete -F __complete_command command\n\n\nTested on Ubuntu 18.04 with python 3.8.\nIf you want, you can type the following in a new console\n\ncd $(mktemp -d)\n__complete_command() {\n    COMPREPLY=($(python3 script.py complete $COMP_CWORD \"${COMP_LINE}\"));\n};\ncomplete -F __complete_command command\necho '\nimport os, shlex\n\n\ndef complete(current_word, full_line):\n    split = shlex.split(full_line)\n    prefixes = (\"test\", \"test-\u4e2d\u6587\", \"test-\ud55c\uae00\")\n    items = list(i + \"-level-\" + current_word for i in prefixes)\n    word = \"\" if len(split) - 1 &lt; int(current_word) else split[int(current_word)]\n    return list(i for i in items if i.startswith(word))\n\n\nif __name__ == \"__main__\":\n    os.sys.stdout.write(\" \".join(complete(\n            *os.sys.argv.__getitem__(slice(2, None)))))\n    os.sys.stdout.flush()' &gt; script.py\n\n\nIs it the most efficient way to do this?"], "tags": ["python", "python-3.x", "bash", "autocomplete"]}
{"texts": ["How well or poorly structured are my routes in this NodeJS app?", "This is for an app built with Express. One of my concerns is the routes ending with / which I did because our previous site was an ASP app. So they named the folders that way for SEO purposes, then the page would be index.aspx .But in my case I just did, for example \n\nscience.jade and routed it from /science-bruxzir-zirconia-dental-crown/\n\nHere is what I got for routes\n\napp.js\n\nvar express = require('express');\nvar routes = require('./routes');\nvar user = require('./routes/user');\nvar http = require('http');\nvar path = require('path');\n\nvar app = express();\n\n// all environments\napp.set('port', process.env.PORT || 3000);\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\napp.use(express.favicon(path.join(__dirname, 'public/images/template/favicon.ico')));\napp.use(express.logger('dev'));\napp.use(express.json());\napp.use(express.urlencoded());\napp.use(express.methodOverride());\napp.use(app.router);\napp.use(require('stylus').middleware(path.join(__dirname, 'public')));\napp.use(express.static(path.join(__dirname, 'public')));\n\n// development only\nif ('development' == app.get('env')) {\n  app.use(express.errorHandler());\n}\n\napp.get('/', function(req, res){\n  res.render('home', {\n    title: 'Home'\n  });\n});\n\napp.get('/features-bruxzir-zirconia-dental-crown/', function(req, res){\n  res.render('features', {\n    title: 'BruxZir Features'\n  });\n});\n\napp.get('/science-bruxzir-zirconia-dental-crown/', function(req, res){\n  res.render('science', {\n    title: 'Scientific Validation'\n  });\n});\n\napp.get('/video-bruxzir-zirconia-dental-crown/', function(req, res){\n  res.render('videos', {\n    title: 'BruxZir Video Gallery'\n  });\n});\n\napp.get('/cases-bruxzir-zirconia-dental-crown/', function(req, res){\n  res.render('cases', {\n    title: 'Before &amp; After Case Gallery'\n  });\n});\n\napp.get('/testimonials-bruxzir-zirconia-dental-crown/', function(req, res){\n  res.render('testimonials', {\n    title: 'Bruxzir Testimonials'\n  });\n});\n\napp.get('/authorized-bruxzir-labs-zirconia-dental-crown/', function(req, res){\n  res.render('labs', {\n    title: 'Authorized BruxZir Labs'\n  });\n});\n\napp.get('/contact-bruxzir-zirconia/', function(req, res){\n  res.render('contact', {\n    title: 'Bruxzir Contact Form'\n  });\n});\n\napp.get('/users', user.list);\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  console.log('Express server listening on port ' + app.get('port'));\n});"], "tags": ["javascript", "node.js"]}
{"texts": ["\u201cProper\u201d Asynchronous implementation", "I need some opinion if my code below is proper for an async process. This code only reformats text. Please let me know if this implementation is not proper or needs some improvement.\n\nstatic void Main(string[] args)\n{\n    Task.Factory.StartNew(() =&gt; ReadCharacter(\"File 1.txt\"));\n    Task.Factory.StartNew(() =&gt; ReadCharacter(\"File 2.txt\"));\n    Console.WriteLine(\"Main Task\");         \n    Console.ReadLine();\n}\n\nstatic void ReadCharacter(string inputFile)\n{\n    string result;\n    using (StreamReader sr = new StreamReader(inputFile))\n    using (StreamWriter sw = new StreamWriter(string.Format(\"C:\\\\Out--{0}\",inputFile)))\n    {\n        Console.WriteLine(\"Opening file : {0}\", inputFile.ToString());\n        while (!sr.EndOfStream)\n        {\n            result = sr.ReadLine();\n            sw.WriteLine(string.Format(\"{0} --&gt; {1}\",result,Task.CurrentId.ToString()));\n        } \n        Console.WriteLine(\"Finish {0}\", inputFile);\n        sr.Close(); sw.Close();\n    }\n}"], "tags": ["c#", "asynchronous"]}
{"texts": ["Determining whether a loop iterated at least one element in generator function", "I have a case in which I need to determine whether a for loop yielded at least one element:\n\n@property\ndef source_customers(self):\n    \"\"\"Yields source customers\"\"\"\n    for config in RealEstatesCustomization.select().where(\n            RealEstatesCustomization.customer == self.cid):\n        yield config.source_customer\n    # Yield self.customer iff database\n    # query returned no results\n    try:\n        config\n    except UnboundLocalError:\n        yield self.customer\n\n\nIs this a pythonic way to go or shall I rather use a flag for that like so:\n\n@property\ndef source_customers(self):\n    \"\"\"Yields source customers\"\"\"\n    yielded = False\n    for config in RealEstatesCustomization.select().where(\n            RealEstatesCustomization.customer == self.cid):\n        yield config.source_customer\n        yielded = True\n    # Yield self.customer iff database\n    # query returned no results\n    if not yielded:\n        yield self.customer\n\n\nWhat is preferable?"], "tags": ["python", "python-3.x", "generator"]}
{"texts": ["Output JavaScript object into HTML table of key-value pairs using jQuery", "This function is meant to take an object, loop through the key-values and generate/build a HTML table at a particular ID:\n\nfunction insertBasicTable(basic_data, insert_id) {\n  /* Insert the key/value pairs into a table element on the DOM.\n\n  basic_data = object containing key/value pairs\n  insert_id  = the id on the DOM to insert the table into \n\n  Intentionally not including closing tags in the jquery requests;\n  http://stackoverflow.com/a/14737115/2355035 */\n\n  table_id = '#' + insert_id;\n  var array_length = Object.keys(basic_data).length;\n  var array_obj_names = Object.keys(basic_data);\n\n  // create the table header\n  $(table_id).empty();\n  $(table_id).append('&lt;thead&gt;');\n  $(table_id).find('thead:last').append('&lt;th&gt;Tag');\n  $(table_id).find('thead:last').append('&lt;th&gt;Data');\n\n  // begin the table body and iterate through key/value pairs\n  $(table_id).append('&lt;tbody&gt;');\n  for (var i = 0; i &lt; array_length; i++) {\n    var attr_name = array_obj_names[i];\n    var tag       = '&lt;td&gt;' + array_obj_names[i];\n    var data      = '&lt;td&gt;' + basic_data[attr_name];\n\n    $(table_id).find('tbody:last').append('&lt;tr&gt;' + tag + data);\n  }\n}\n\n\nThis function is then used, along with a number of D3 scripts, to populate elements on the DOM:\n\nlinePlot.render(someObject.modules.qual.quintiles);\nboxPlot.render(someObject.modules.qual.quintiles);\ninsertBasicTable(someObject.modules.basic, 'basic-stats-table');\n// etc, etc...\n\n\nAny comments about how this is being achieved? Am I overlooking either a basic tenant of how JS \"should\" be used (this is a huge side-effect for instance, should I be returning a formatted string then placing that string into the DOM for instance) or over-complicating things by jQuery'ing a bunch of times?"], "tags": ["javascript", "jquery"]}
{"texts": ["Registration and login", "Right now I'm creating a community. You can register and create your own profile and post on a forum etc. I'm just doing this for fun and learning. I'm not planning on becoming a professional programmer this is just a hobby of mine.\n\nAnyway, I want do it right though. Please review my script and tell me if it seems OK and safe. And please if you have a suggestion or anything go ahead. \n\nThis is the login (I use sessions):\n\n// Trim values sent from form\n$username = trim($_POST['username']);\n$password = trim($_POST['password']);\n\n// Get user info and their rights matching login attempt\n$stmt = $db-&gt;prepare(\"SELECT id, username, g_can_delete_users, g_can_edit_post, g_can_handle_reports FROM users LEFT JOIN groups ON groups.g_id = users.group_id WHERE users.username = ? AND SHA1(CONCAT(users.salt, ?)) = users.password\");\n$stmt-&gt;execute(array($username, $password));\n$row = $stmt-&gt;fetch();\n\n// Did we find a match?\nif ($row) {\n    $_SESSION['user'] = $row; \n    header(\"Location: index.php\");\n    exit;\n} else {\nheader(\"Location: index.php\");\nexit;\n}\n\n\nAnd the registration part:\n\n// Example of a generated salt: &amp;O93Wrl`x#iY\n\n\n$username = trim($_POST['username']);\n$email = strtolower(trim($_POST['email']));\n    $password1 = trim($_POST['password1']);\n    $password2 = trim($_POST['password2']);\n\n    // Validate the username\n    if (strlen($username) &lt; 4)\n        $errors[] = \"Username must be at least 4 characters.\";\n    // ... and the password\n    else if (strlen($password1) &lt; 4)\n        $errors[] = \"Password too short\";\n    else if ($password1 != $password2)\n        $errors[] = \"Passwords do not match\";\n    else \n\n\n$stmt = $db-&gt;prepare(\"INSERT INTO users (username, password, email, salt, registered, registration_ip) VALUES (:username, :password, :email, :salt, :registered, :registration_ip)\");\n        $stmt-&gt;execute(array(':username'=&gt;$username, ':password'=&gt;sha1($salt.$password1), ':email'=&gt;$email, ':salt'=&gt;$gen_salt, ':registered'=&gt;time(), ':registration_ip'=&gt;$_SERVER['REMOTE_ADDR']));"], "tags": ["php", "pdo", "authentication"]}
{"texts": ["Searching a Join List for an index Attempt #2", "Originally I posted this incorrect attempt - Searching a Join List for an index.\n\nGiven a JoinList:\n\ndata JoinList m a = Empty\n                  | Single m a\n                  | Append m (JoinList m a) (JoinList m a)\n    deriving (Eq, Show)\n\n\nwhere m represents the size of the JoinList, find the element (Maybe a) at the given index in the JoinList structure.\n\nindexJ :: (Sized b, Monoid b) =&gt; Int -&gt; JoinList b a -&gt; Maybe a\nindexJ _ Empty             = Nothing\nindexJ i (Single _ x) \n  | i == 0                 = Just x\n  | otherwise              = Nothing\nindexJ i (Append _ left right)\n  | leftHt &gt; i             = indexJ i left\n  | (rightHt + leftHt) &gt; i = indexJ (i-leftHt) right\n  | otherwise              = Nothing\n  where leftHt  = (getSize. size . tag) left\n        rightHt = (getSize. size . tag) right\n\n\nwhere tag = \n\ntag :: Monoid m =&gt; JoinList m a -&gt; m\ntag Empty          = mempty\ntag (Single x _)   = x\ntag (Append x _ _) = x \n\n\nTesting\n\nData\n\njlIndex2 :: JoinList Size String\njlIndex2 = Append (Size 3) \n                       (Single (Size 1) \"foo\") \n                       (Append (Size 2) \n                             (Single (Size 1) \"bar\") \n                             (Single (Size 1) \"baz\"))\n\njlIndex3 :: JoinList Size String\njlIndex3 = Append (Size 4) (Single 1 \"biz\") jlIndex2\n\n\nTests\n\n*JoinList&gt; indexJ 3 jlIndex3\nJust \"baz\"\n*JoinList&gt; indexJ 0 jlIndex3\nJust \"biz\"\n*JoinList&gt; indexJ 100 jlIndex3\nNothing\n\n\nNote - I would've used QuickCheck, but I'm not sure how to use it with algebraic data types."], "tags": ["haskell", "tree"]}
{"texts": ["C function to find and delete a node from a singly linked list", "I'm looking for the most commonly used style for writing the delete_item() function of a singly linked list, that find a matching item and deletes it. Is what I have the 'typical' or 'normal' solution? Are there more elegant ones?\n\nWhat seems inelegant to me about my solution below, although I don't know a better way to express it, is that the code needs to check the first record individually (i.e. a special case), then as it goes through the iteration, it's not checking iter, it's checking iter-&gt;next, ahead of the iterator's present location, because in a singly linked list you can't go backwards.\n\nSo, is there a cleaner way to write the delete_item() function?\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node {\n    int x;\n    struct node *next;\n};\n\nstruct node *head;\n\nstruct node *create_item(int x);\nvoid print_list();\nvoid delete_item(int x);\n\nint main(int argc, int argv) {\n\n    struct node *n;\n    int i;\n\n    // initialise a linked list with a few items\n    head = create_item(1);\n    n = head;\n\n    for (i = 2; i &lt; 10; i++) {\n        n-&gt;next = create_item(i);\n        n = n-&gt;next;\n    }\n\n    // before\n    print_list();\n\n    // delete 7.\n    delete_item(7);\n\n    // after\n    print_list();\n\n    // lets delete all odd numbers for effect.\n    delete_item(1);\n    delete_item(3);\n    delete_item(5);\n    delete_item(9);\n\n    print_list();\n}\n\nstruct node *create_item(int x) {\n    struct node *new;\n\n    new = (struct node *) malloc (sizeof(struct node));\n    new-&gt;x = x;\n    return new;\n}\n\nvoid print_list() {\n    struct node *iter;\n\n    iter = head;\n\n    while (iter != NULL) {\n        printf(\"num: %i\\n\", iter-&gt;x);\n        iter = iter-&gt;next;\n    }\n}\n\n//We're looking for the best way to right this.\n//This is _my_ standard solution to the problem.\n// (that is, to test the first element explicitly\n// the use current-&gt;next != NULL to be one behind\n// the search).\n//I wondered what other people's is or if there\n//is a convention?\nvoid delete_item(int x) {\n\n    struct node *iter;\n    iter = head;\n\n    if (iter == NULL) {\n        printf(\"not found\\n\");\n        return;\n    }\n\n    if (iter-&gt;x == x) {\n        printf(\"found in first element: %i\\n\", x);\n            head = head-&gt;next;\n        return;\n    }\n\n    while (iter-&gt;next != NULL) {\n        if (iter-&gt;next-&gt;x == x) {\n            printf(\"deleting element: %i\\n\", x);\n            iter-&gt;next = iter-&gt;next-&gt;next;\n            return;\n        }\n\n        iter = iter-&gt;next;\n    }\n\n    printf(\"not found\\n\");\n}\n\n\nThis is a complete example that can be compiled and tested. The output:\n\n23:28: ~$ gcc -o ll linked_list.c\n23:28: ~$ ./ll\nnum: 1\nnum: 2\nnum: 3\nnum: 4\nnum: 5\nnum: 6\nnum: 7\nnum: 8\nnum: 9\ndeleting element: 7\nnum: 1\nnum: 2\nnum: 3\nnum: 4\nnum: 5\nnum: 6\nnum: 8\nnum: 9\nfound in first element: 1\ndeleting element: 3\ndeleting element: 5\ndeleting element: 9\nnum: 2\nnum: 4\nnum: 6\nnum: 8"], "tags": ["c", "linked-list"]}
{"texts": ["Streaming floating point data in Python2", "I am in the process of creating a brain-computer interface, and one task is to stream electroencephalograph (EEG) data into a Python script for real-time analysis. Included in this question are two Python scripts: (1) to generate and stream fake EEG data (32 random floating points for testing purposes), and (2) to receive the EEG data and convert it to a numpy array of the shape (n_channels, n_samples). The second script extracts a sliding window of the last X seconds of data.\n\nGenerate and stream synthetic EEG data\n\n# file is named \"stream_eeg_realtime.py\"\nimport random, threading, time\n\nnominal_srate = 500.  # sampling rate in Hz. Must be float.\nsleep_time = 1/nominal_srate\n\n# Define all of the channel names.\nchannels = ['Fp1','Fp2','AF3','AF4','F3','F4','F7','F8','FC5','FC6','T7','T8',\n'FC1','FC2','C3','C4','CP5','CP6','P7','P8','CP1','CP2','P3','P4','01','02',\n'PO3','PO4','Oz','Pz','Cz','Fz']\n\none_sample = [round(random.uniform(-4.,4.), 5) for _ in channels]\ndata = []\n\ndatalock = threading.RLock()\ndef synthesize_data():\n    while True:\n        with datalock:\n            data.append(one_sample)\n        time.sleep(sleep_time)\n\nt1 = threading.Thread(target=synthesize_data, name=\"EEG\")\nt1.daemon = True\nt1.start()\nprint(\"Now streaming synthetic data...\")\n\n\nReceive and convert data to Numpy array (Jupyter Notebook)\n\nIn [1]:\nimport numpy as np\nimport stream_eeg_realtime as ser\n\nDATA_DURATION = 20\nsfreq = float(ser.nominal_srate)\nlast_rows_index = int(DATA_DURATION*sfreq)\nthread_lock = ser.datalock\ndef get_data(raw_data, index, thread_lock, full_data=False):\n    # Data comes in as array-like with shape (n_samples, n_channels).\n    with thread_lock:\n        if full_data==False:\n            d = [row[:] for row in raw_data[-index:]]\n        # If we want all of the data, instead of the X-second window.\n        elif full_data==True:\n            d = [row[:] for row in raw_data]\n    data = np.array(d, dtype=\"float64\").T\n    return data\n\nIn [2]:\nraw_array = get_data(ser.data, last_rows_index, thread_lock, full_data=False)\nprint raw_array.shape\n\n\nThis code has to be as fast as possible. I optimized the code as much as I could as an advanced-beginner, but can I make it faster? Is it OK to use threading in this case, or would multiprocessing be better? (I have no idea how to use multiprocessing)\n\nHere are some things I tried before arriving at the code I posted. At first, I tried to append \"columns\" to the nested lists with list comprehension. That was fast, but it turns out it is much faster to append \"rows\" (no list comprehension needed) and then transpose. I also tried to deepcopy the list in the second script, and then I used nested list comprehension to make a copy. Using the slicing syntax in the list comprehension was the fastest method to copy the list."], "tags": ["python", "performance", "beginner", "multithreading", "python-2.x"]}
{"texts": ["Given two vectors of ints, determine whether one vector is a prefix of the other", "Given two vectors of ints, write a program to determine whether one vector is a prefix of the other.\n\nFor vectors of unequal length, compare the number of elements of the smaller vector.\nFor example, given the vectors containing 0, 1, 1, 2, and 0, 1, 1, 2, 3, 5, 8, respectively, your program should return true.\n\n\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    const std::vector&lt;int&gt; ivec1 = { 0, 1, 1, 2 };\n    const std::vector&lt;int&gt; ivec2 = { 0, 1, 1, 2, 3, 5, 8 };\n\n    const decltype(ivec1.size()) size = ivec1.size() &lt; ivec2.size() ? ivec1.size() : ivec2.size();\n    const std::vector&lt;int&gt;&amp; smallVec = ivec1.size() &lt; ivec2.size() ? ivec1 : ivec2;\n    const std::vector&lt;int&gt;&amp; bigVec = smallVec == ivec1 ? ivec2 : ivec1;\n\n    bool bPrefix = true;\n    for(decltype(ivec1.size()) i = 0; i &lt; size; ++i)\n    {\n        if(smallVec[i] != bigVec[i])\n        {\n            bPrefix = false;\n            break;\n        }\n    }\n\n    std::cout &lt;&lt; &quot;small vector:\\n&quot;;\n    for (const auto i : smallVec)\n        std::cout &lt;&lt; i &lt;&lt; &quot;, &quot;;\n    std::cout &lt;&lt; &quot;\\nIs prefix of big vector:\\n&quot;;\n    for (const auto i : bigVec)\n        std::cout &lt;&lt; i &lt;&lt; &quot;, &quot;;\n    std::cout &lt;&lt; &quot;\\n&quot; &lt;&lt; (bPrefix ? &quot;true&quot; : &quot;false&quot;) &lt;&lt; std::endl;\n}"], "tags": ["c++", "vectors", "iteration"]}
{"texts": ["Creating zip but for dictionaries", "I found myself needed zip but for dictionaries, and wanted to know if there is any way I can make this shorter and more concise, and/or faster. Also I cannot figure out what the type hinting might be for the return (I would like to put it in the reStructuredText).\n\ndef dict_zip(*args):\n    \"\"\"The zip utility but for dictionaries\n\n    :param args:\n        A bunch of **identical** dicts\n    :type args:\n        dict\n    :return:\n        A dict of all the keys in the input dict, \n        mapped to a list of all the values fro that key\n    :rtype:\n        dict\n    \"\"\"\n    out = {i: [] for i in args[0]}\n    for dic in args:\n        for key in out:\n            out[key].append(dic[key])\n    return out\n\nif __name__ == \"__main__\":\n    dict1 = {\"first\": True, \"name\": \"John\"}\n    dict2 = {\"first\": False, \"name\": \"sue\"}\n    print dict_zip(dict1, dict2)\n\n\nOutput:\n\n{'name': ['John', 'sue'], 'first': [True, False]}"], "tags": ["python", "python-2.x", "hash-map"]}
{"texts": ["Selecting one MySQL date with month reduced by one", "I was thinking in a way to improve the following query if possible:\n\nSELECT CONCAT(DATE_FORMAT(start_date, '%Y'), ',', \n       (MONTH(start_date) -1), ',', DATE_FORMAT(start_date, '%d')) as start_date\nFROM PROJECTS\n\n\nI need start_date in this format: dd/mm-1/yyyy.\n\nNote: I am using an API that use month from 0 to 11, and MySQL uses 1 to 12 &ndash; that's why I need month - 1."], "tags": ["sql", "datetime", "mysqli"]}
{"texts": ["Using datetime in order to name files", "I have a script that makes use of datetime in order to name files.\n\nOnly business days (Mon - Fri) are used.\n\nHere is my part of the code that finds the last business day:\n\nlastBusDay = datetime.datetime.today()\nshift = datetime.timedelta(max(1,(lastBusDay.weekday() + 6) % 7 - 3))\nlastBusDay = lastBusDay - shift\nyesterday = lastBusDay.strftime('%d%m%y')\n\n\nThese variables are outside of any function and are the first part of my script after the imports. I've heard that global variables are bad, and I understand why.\n\nBut does this fall under the same category?\n\nOnly the yesterday variable is used later on in the script and is used to specify the new name in an the os.renames function."], "tags": ["python", "datetime"]}
{"texts": ["Covering array scraper and sorter", "A covering array is an \\$N \\times k\\$ array in which each element is a from a set of \\$v\\$ symbols, and for every \\$t\\$ columns, every possible set of \\$v^t\\$ choices of the symbols appears at least once. The covering array number \\$\\mathrm{CA}(t,k,v)\\$ is the smallest \\$N\\$ for which a covering array exists, given \\$t\\$, \\$k\\$, and \\$v\\$. A list of known covering array numbers (CANs) is available here.\n\nI want to parse all of the known CANs from these pages and to find how \"efficient\" they are\u2014what I mean by this is the ratio of \\$\\mathrm{CA}(t,k,v)\\$ compared to \\$v^t\\$. \n\nI developed Python code that access every covering array page, and parses the tables. I then sort the list of covering arrays by this ratio, and plot it using matplotlib.pyplot (using a log-scale for the y axis).\n\nfrom urllib.request import urlopen\nfrom bs4 import BeautifulSoup\nimport matplotlib.pyplot as plt\n\n# covering array object\nclass CAElement:\n    def __init__(self, N, t, k, v):\n        self.N = N\n        self.t = t\n        self.k = k\n        self.v = v\n    def set_ratio(self, ratio):\n        self.ratio = ratio\n    def __str__(self):\n        return \"CA(N=%d; t=%d, k=%d, v=%d) -&gt; %f\" % (self.N, self.t, self.k, self.v, self.ratio)\n\nCAArray = []\n\n# iterate over v, t in the known table ranges\nfor v in range(2, 26):\n    for t in range(2, 7):\n        # download the webpage and find the elements\n        url = \"http://www.public.asu.edu/~ccolbou/src/tabby/%d-%d-ca.html\" % (t, v)\n        response = urlopen(url)\n        soup = BeautifulSoup(response)\n        tables = soup.findChildren('table')\n        table = tables[0]\n        rows = table.findChildren('tr')\n\n        # iterate over all rows in the one table\n        for row in rows:\n            cells = row.findChildren('td') # has all of the table's elements\n            elements = []\n            for cell in cells:\n                value = cell.string\n                if value is not None and value != \"k\" and value != \"N\" and value != \"Source\":\n                        elements.append(value)\n            if len(elements) &gt;= 2:\n                kParsed = int(elements[0])\n                NParsed = int(elements[1])\n                element = CAElement(NParsed, t, kParsed, v)\n                ratio = element.N / pow(element.v, element.t)\n                element.set_ratio(ratio)\n                CAArray.append(element)\n\n# sort by N/(v^t)\nCAArray.sort(key=lambda x: (x.ratio, x.N, x.v, x.t, x.k), reverse=True)\n\n# print each element (in sorted order)\nfor element in CAArray:\n    print(element)\n\n# plotting - using log scale for y axis\n# each point is colored according to t (i.e., the \"strength\" of the CA)\nxs = range(0, len(CAArray))\nys = [y.ratio for y in CAArray]\ncolors = {2:\"red\", 3:\"blue\", 4:\"green\", 5:\"yellow\", 6:\"orange\"}\nplt.scatter(xs, ys, c=[colors[x.t] for x in CAArray])\nplt.axis([min(xs), max(xs), min(ys), max(ys)])\nplt.yscale('log')\nplt.show()\n\n\nThis code does exactly what I want it to do. However, there are some problems:\n\n\nAccessing the webpages is somewhat slow, and could be faster.\nThe code does not seem very Pythonic (and by making it so could make iterating over the array much faster).\n\n\nAny suggestions are welcome!"], "tags": ["python", "python-3.x", "combinatorics", "beautifulsoup", "matplotlib"]}
{"texts": ["Size improvements for cat reimplementation", "I have written a reimplementation of cat that will be compliant with most scripts, and that is as small and fast as possible. Can anybody suggest some size improvements for it?\n\n#include &lt;stdio.h&gt;              /* we need printf, fprintf, FILE,\n                         * fopen, fclose and that sort of\n                         * stuff */\n#include &lt;stdlib.h&gt;             /* for exit, EXIT_SUCCESS, and\n                         * EXIT_FAILURE */\n\nint main(int argc, char *argv[])\n{\n    FILE *fp;               /* file to cat */\n    short int ch;               /* character to print */\n    unsigned short int cp;          /* currently printing argv[?] */\n    unsigned short int failed = 0;      /* how many failed to print */\n\n    if (argc &lt; 2) {             /* if not enough args act as pipe */\n        for (;;) {          /* infinite loop */\n            if ((ch = fgetc(stdin)) == EOF) {\n                exit(EXIT_SUCCESS);\n            } else {\n                printf(\"%c\", ch);\n            }\n        }\n    }\n\n    for (cp = 1; cp &lt;= argc - 1; cp++) {    /* for each file in cli args */\n        fp = fopen(argv[cp], \"r\");  /* open the file */\n\n        if(fp == NULL) {\n            fprintf(stderr, \"%s: cannot open %s\\n\", argv[0], argv[cp]);\n            failed++;       /* increment the number of failed */\n            continue;       /* go back to beginning */\n        }\n\n        while ((ch = fgetc(fp)) != EOF) {\n            printf(\"%c\", ch);\n        }\n\n        fclose(fp);         /* close the file */\n    }\n\n    exit(failed);               /* exit with the number of files */\n}                       /* that failed */\n\n\nI'm sorry that the indentation is messed up, I use tabs in my code.\n\nIn clang version 3.5.0 on Ubuntu the generated binary size is 5200 bytes with these options:\n\n-Oz -fomit-frame-pointer -s\n\n\nImprovements\n\nI added some more error checking, added -u and - and also wrote a function that writes out a file to avoid repeating myself. Also changed short int to int, printf to putchar, and some other things.\n\n#include &lt;stdio.h&gt;              /* we need printf, fprintf, FILE,\n                         * fopen, fclose and that sort of\n                         * stuff */\n#include &lt;stdlib.h&gt;             /* for exit, EXIT_SUCCESS, and\n                         * EXIT_FAILURE */\n#include &lt;string.h&gt;             /* need strcmp */\n\nvoid write_file(char *file, char *progname) /* function to print individual file */\n{\n    FILE *fp;               /* file to write */\n    int ch;                 /* temporary variable */\n\n    if (strcmp(file, \"-\") == 0) {       /* check if using stdin */\n        fp = stdin;         /* use standard input */\n    } else {\n        fp = fopen(file, \"r\");      /* open file for writing */\n    }\n\n    if (fp == NULL) {           /* error in opening file */\n        fprintf(stderr, \"%s: cannot open %s\\n\", progname, file);\n        exit(EXIT_FAILURE);\n    }\n\n    while ((ch = fgetc(fp)) != EOF) {\n        if (putchar(ch) == EOF) {\n            fprintf(stderr, \"%s: can't read %s\\n\", progname, file);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    if (ferror(fp) != 0) {          /* IO error, perhaps? */\n        fprintf(stderr, \"%s: error reading %s\\n\", progname, file);\n        exit(EXIT_FAILURE);\n    }\n\n    if (strcmp(file, \"-\") != 0) {       /* close the file unless stdin */\n        fclose(fp);\n    }\n\n    return;\n}\n\nint main(int argc, char *argv[])\n{\n    unsigned short int cp = 1;      /* currently printing argv[?] */\n\n    if (argc &lt; 2) {             /* act as pipe */\n        write_file(\"-\", argv[0]);\n        exit(EXIT_SUCCESS);\n    }\n\n    if (strcmp(argv[1], \"-u\") == 0) {   /* support -u option for SUS compat */\n        cp++;               /* increment the argv pointer var */\n    }\n\n    for (; cp &lt;= argc - 1; cp++) {      /* for each file in cli args */\n        write_file(argv[cp], argv[0]);  /* print the file */\n    }\n\n    exit(EXIT_SUCCESS);\n}"], "tags": ["c", "reinventing-the-wheel", "io"]}
{"texts": ["Login Script Utilising List Comprehension", "This a fairly basic script I made for use in some other projects, nothing too complex or sophisticated and obviously lacking in some features (Password/Username encryption, Missing file contingencies etc.).\n\nIt loads a text file (formatted as USERNAME, PASSWORD\\nUSERNAME, PASSWORD\\n) into a 2D array, then checks the inputs against it, until 2 separate logins are used. \n\n\n\nI'm what I'd consider intermediate in terms of python competency, but there are always things to be improved upon: any suggestions? I tend to use something similar to this for all projects that require a login, so any improvements or areas to look into, no matter how minor, would be greatly appreciated.\n\n\n\ndef login():\n    player_count, details = 0, [[data.strip() for data in line.split(\",\")] for line in open(\"username_password.txt\", \"r\").read().splitlines()]\n    while player_count != 2:\n        username, password = input(\"USERNAME\"), input(\"PASSWORD\")\n        for data in details:\n            if username == data[0] and password == data[1]:\n                print(\"LOGIN CORRECT\")\n                details.pop(details.index(data))\n                player_count += 1\n                break\n        else:\n            print(\"INCORRECT\")\n    main()\n\ndef main():\n    print(\"LOGGED IN\\nMAIN\")\n\nlogin()"], "tags": ["python", "performance", "python-3.x"]}
{"texts": ["Chat room using GenServer", "It seems odd that state must be passed around all the time. Can't State module hold itself, so I could do something like\n\nstate = %State{size: size}\ncase state.is_full? do\n    ...\n\n\nHere state is always passed. I suppose this is how it is in FP?\n\ndefmodule Chatter.Room do\n  use GenServer  \n\n  defmodule State do\n    defstruct size: 3, players: []\n\n    def is_full?(state) do\n      Enum.count(state.players) &gt;= state.size\n    end\n\n    def add_player(state, player) do\n      case State.is_full?(state) do\n        true -&gt; {:room_is_full, state}\n        _    -&gt; {:ok, append_player(state, player)}\n      end\n    end\n\n    defp append_player(state, player) do\n      %{state | players: state.players ++ [player]}\n    end\n  end\n\n  def open(size) do\n    {:ok, pid} = GenServer.start_link(__MODULE__, %State{size: size})\n    pid\n  end\n\n  def join(room, user) do\n    GenServer.call(room, {:join, user})\n  end\n\n  def players(room) do\n    GenServer.call(room, :players)\n  end\n\n\n  def init(state) do\n    {:ok, state}\n  end\n\n  def handle_call(:players, _from, state) do\n    {:reply, state.players, state}\n  end\n\n  def handle_call({:join, player}, _from, state) do\n    case State.add_player(state, player) do\n      {:ok, state} -&gt; {:reply, :ok, state}\n      {error, state} -&gt; {:reply, error, state}\n    end\n  end\nend"], "tags": ["state-machine", "chat", "elixir"]}
{"texts": ["Using phantom types to represent amounts and exchange rates of currencies", "I posted the following snippet to StackOverflow, and someone said there was much to be improved.\n\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nclass (Show a) =&gt; Currency a where unphantom :: a\n\ndata USD = USD deriving Show\ndata EUR = EUR deriving Show\n\ninstance Currency USD where unphantom = USD\ninstance Currency EUR where unphantom = EUR\n\ndata Amount a where\n  Amount :: Currency a =&gt; Float -&gt; Amount a\ninstance Show (Amount a) where \n  show (Amount x) = show x ++ show (unphantom :: a)\n\ndata Rate a b where\n  Rate :: (Currency a, Currency b) =&gt; Float -&gt; Rate a b\n-- ...\n\n\nHaving to define an unphantom function for each currency is a bit annoying but I don't really see a way around it. Also, note that my use of Float to represent monetary values is just a placeholder.\n\nHow can I improve this code?"], "tags": ["haskell"]}
{"texts": ["I was wondering if there was a better way to improve my XNA joystick code? (Vb. Net)", "I'm on a high school robotics team and I'm trying to code a Xbox 360 controller so that it'll controller the motors with variable speed. So far it works alright, but where I'm quite the novice coder I'd like to have more experienced eyes peer at my code and see if they can find a better way, or more effective way to do the same thing. As of now, as the code shows, when the sticks are moved it causes the value (-1 to 1) to be multiplied by 100 and sent to the motor controller as a value for its speed. A timer is also attached to continuously update the values to have the most accuracy possible. So far the only issue I've encountered is a minor dead zone at each perfect diagonal. I've pondered just coding in the diagonals just like the other directions but I've had little luck. Any pointers would be appreciated! Here's the current code:\n\nPrivate Sub JoySticks()\n    'Left Joystick drive motor controls.\n    Dim LY As Integer\n    Dim LX As Integer\n    LY = GamePad.GetState(PlayerIndex.One).ThumbSticks.Left.Y * 100\n    LX = GamePad.GetState(PlayerIndex.One).ThumbSticks.Left.X * 100\n    HScrollLX.Value = LX\n    VScrollLY.Value = LY\n    If LY &gt; 0 Then\n        MC1.Velocity(0) = LY\n        MC1.Velocity(1) = LY\n    ElseIf LY &lt; 0 Then\n        MC1.Velocity(0) = LY\n        MC1.Velocity(1) = LY\n    ElseIf LX &gt; 0 Then\n        MC1.Velocity(0) = LX\n        MC1.Velocity(1) = LX * -1\n    ElseIf LX &lt; 0 Then\n        MC1.Velocity(0) = LX\n        MC1.Velocity(1) = LX * -1\n    ElseIf LX Or LY = 0 Then\n        MC1.Velocity(0) = 0\n        MC1.Velocity(1) = 0\n    End If\nEnd Sub\n\nPrivate Sub TimerJoysticks_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TimerJoysticks.Tick\n    JoySticks()\nEnd Sub"], "tags": ["vb.net", "xna"]}
{"texts": ["Making a row of bricks", "We want to make a row of bricks that is goal inches long. We have a number of small bricks (1 inch each) and big bricks (5 inches each). Return true if it is possible to make the goal by choosing from the given bricks.\n\n\nbool make_bricks(int small,int big,int goal)\n{\n    if(big &gt; 0)\n    {\n        double test = (double)goal/((double)big*5.0);//The above if statement eliminates the possibility of division by zero\n        if(test &gt; 1.0)//This means we cannot make the row with big bricks alone\n        {\n            if(small &gt;= (goal-big*5))//If we have enough small bricks after using all our big bricks\n            {\n                return true;\n            }\n            else//If we don't have enough small bricks to finish the row\n            {\n                return false;\n            }\n        }\n        else if(test == 1)//If we have exactly enough big bricks to make the row\n        {\n            return true;\n        }\n        else//We have enough big bricks to make the row, but perhaps not enough small bricks\n        {\n            if(small &gt;= (goal%5))//If we have enough small bricks after using as many big bricks as possible\n            {\n                return true;\n            }\n            else//We do not have enough small bricks after using as many big bricks as possible\n            {\n                return false;\n            }\n        }\n  }\n  else//If the big is not greater than 0, we depend solely on small bricks to make the row.\n  {\n      if(small &gt;= goal)//If we have enough small bricks to make the row or more than enough\n      {\n          return true;\n      }\n      else//We do not have enough small bricks to make the row\n      {\n          return false;\n      }\n  }\n}"], "tags": ["c++"]}
{"texts": ["Python Pandas - finding duplicate names and telling them apart", "(Somewhat) new to python and coding in general! Using python 3.7 and pandas, I'm running code to create a searchable list of people in my dataframe, and I feel like my way of telling duplicates apart is very roundabout. I would love some advice on making it simpler and more efficient. \n\nI have a database in pandas, 'df2', which has three relevant rows: 'First Name', 'Last Name' and 'People ID'. Some people will have the same name, and these can be told apart by their 'People ID'. I start by making the 'Name' column as thus:\n\ndf2['Name'] = df2['First Name'] + ' ' + df2['Last Name']\n\n\nNow I make a Dict, nameid, to find out how many different People IDs are associated to each unique 'Name' string.\n\nnameid = {}\nfor i in df2.index:\n    try:\n        nameid[df2.loc[i, 'Name']].append(df2.loc[i, 'People ID'])\n    except:\n        nameid[df2.loc[i, 'Name']] = [df2.loc[i, 'People ID']]\n\n\nThere are multiple occurences of each person in the spreadsheet, so I want to just have each unique instance of a different 'People ID' using set().\n\nfor i in nameid.keys():\n    nameid[i] = list(set(nameid[i]))\n\n\nNow I create a second dict, namead, which is a \"filtered\" version of nameid where we've removed all reviewer names with just one ID value associated (those are fine as they are). \n\nnamead = {}\n\nfor i in nameid.keys():\n    paceholder = ['Nothing']\n    try:\n        paceholder.append(nameid[i][1])\n        namead[i] = nameid[i]\n    except:\n        pass\n\n\nFinally, I use namead to make dupes, the list of index values of df2 where there are names belonging to different reviewers. I then pass that through df2 to add the 'People ID' to those names and ensure there is no confusion.\n\ndupes = [i for i in df2.index if df2.loc[i, 'Name'] in namead.keys()]\nfor i in duperevs:\n    df2.loc[i, 'Name'] += ' ' + str(df2.loc[i, 'People ID'])\n\n\nWhew! I feel like I added several layers of complexity here but I'm not sure where to start - help would be much appreciated!\n\nEDIT - I'm not sure how to put an extract of the dataframe in this textbox. Clarification: each row of data has information, and I need it to be searchable by name for the end user, with a placeholder to differentiate identical names (the People ID). The resulting data looks like: \"Frank Jones / 14498\", \"Mitin Nutil / 35589\", \"Maveh Kadini 1433 / 1433\" (indicating that there's more than one Maveh Kadini in the data). Each person (by People ID) will appear in many different rows of data."], "tags": ["python", "python-3.x", "pandas"]}
{"texts": ["Reducing code with two identical objects", "I have two identical objects on the page, so I get more of the same lines of code.  Can anything be made simpler, perhaps with merging?\n\nfor(var i=0;i&lt;ticks.length,i&lt;ticks2.length;i++) {\n\n  var tick = ticks[i];\n  var tick2 = ticks2[i];\n  var tickCenter = tick.offsetWidth / 2\n  var offset = (i - currentTick) * pixelsPerTick;\n  var percent = 1-(Math.abs(i-currentTick)/10);\n\n  tick2.style.top = ((offset + center - tickCenter)|0) + \"px\";\n  tick2.style.opacity = percent;\n\n  tick.style.top = ((offset + center - tickCenter)|0) + \"px\";\n  tick.style.opacity = percent;\n}"], "tags": ["javascript"]}
{"texts": ["Design for a protocol based software in C++", "I want a good design to implement a master-slave protocol. The protocol is proprietary and similar to cctalk.\nWe have:\n\nMaster: HEADER [ DATA ] CHECKSUM\nSlave: HEADER [ DATA ] CHECKSUM\n\nMy choice was to have concrete base classes for request and for response:\n\nclass PacketReq {\npublic:\n    typedef std::vector&lt;uint8_t&gt;       container;\n    typedef container::const_iterator  const_iterator;\n\n    PacketCommand command() const\n    {\n        return static_cast&lt; PacketCommand &gt;( mBuffer[ 2 ] );\n    };\n\n    const container&amp; data() const\n    {\n        return mBuffer;\n    }\n\n    const_iterator begin() const\n    {\n        return mBuffer.begin();\n    }\n\n    const_iterator end() const\n    {\n        return mBuffer.end();\n    }\n\nprotected:\n    container mBuffer;\n};\n\nclass PacketOut1 : public PacketReq {\npublic:\n    PacketOut1()\n    {\n        mBuffer.reserve( PacketHeaderHelper::HEADER_SIZE );\n        mBuffer.push_back( /* something. */ );\n        mBuffer.push_back( /* something. */ );\n        mBuffer.push_back( /* something. */ );\n        mBuffer.push_back( /* something. */ );\n    }\n};\n\n\nThe response can be a good response or a NACK (an error). My Implentation is:\n\nclass PacketRes {\npublic:\n    PacketRes(const std::vector&lt;uint8_t&gt;&amp; buffer) \n    {\n        if (!checkChecksum( buffer ))\n        {\n            throw Error(\"invalid checksum\");\n        }\n\n        PacketHeaderHelper header( buffer );\n        mCommand = header.command();\n\n        if (header.len() &gt; PacketHeaderHelper::HEADER_SIZE)\n        {\n            const size_t bodySize = header.len() - PacketHeaderHelper::HEADER_SIZE;\n\n            mData.reserve( bodySize );\n\n            mData.insert(\n                mData.end(),\n                buffer.begin() + PacketHeaderHelper::HEADER_SIZE - 1,\n                buffer.end() - 1\n                );\n        }        \n    }\n\n    virtual ~PacketReq() {}\n\n    PacketCommand command() const\n    {\n        return mCommand;\n    }    \n\n    const std::vector&lt;uint8_t&gt;&amp; body() const\n    {\n        return mData;\n    }\n\nprivate:\n    bool checkChecksum(const std::vector&lt;uint8_t&gt;&amp; buffer) const\n    {\n        /* calc checksum. */\n    }\n\nprivate:\n    std::vector&lt;uint8_t&gt; mData;\n    PacketCommand mCommand;\n};\n\nclass PacketInAck : public PacketReq {\npublic:\n    PacketInAck(const std::vector&lt;uint8_t&gt;&amp; buffer) : PacketReq( buffer )\n    {\n    }\n};\n\n\nSo if I want make a request the sequence is:\n\nlock_guard \nsend( const PacketOut&amp; p ) \nstd::unique_ptr&lt; PacketRes &gt; read();\n\n\nBut I don't like this design, but it works.\n\nIs there some other way to implement this?"], "tags": ["c++", "design-patterns"]}
{"texts": ["MultiThreaded TCP Server with high CPU usage", "I wrote simple C# TCP Server application and my program use a lot of cup, i was wondering anyone can review my code and would be grateful for any hints and suggestion. \n\nThis is my code.\n\npublic class Program\n    {\n        static void Main(string[] args)\n        {\n            int _Port = Convert.ToInt32(System.Configuration.ConfigurationManager.AppSettings[\"TCPPort\"]);\n            string _IP = System.Configuration.ConfigurationManager.AppSettings[\"TCPIP\"];\n            TcpServer server = new TcpServer(_Port);\n        }\n    }\n\n\n  public class TcpServer\n    {\n        private TcpListener _server;\n        private Boolean _isRunning;\n        private static int defaultMax = 8;\n        public TcpServer(int port)\n        {\n            _server = new TcpListener(IPAddress.Any, port);\n            _server.Start();\n            _isRunning = true;          \n            LoopClients();\n        }\n\n\n\npublic void LoopClients()\n    {\n        while (_isRunning)\n        {\n\n            TcpClient newClient = _server.AcceptTcpClient();\n            SentFirstTimeData_New(newClient);\n            Thread t = new Thread(new ParameterizedThreadStart(HandleClient));\n            t.Start(newClient);\n        }\n    }\n\n    public void HandleClient(object obj)\n    {\n\n        int requestCount = 0;\n        byte[] bytesFrom = new byte[209666];\n        string dataFromClient = null;\n        Byte[] sendBytes = null;\n        requestCount = 0;\n        int byteread = 0;\n        string respdata = string.Empty;\n        byte[] buffer = new byte[4096];\n        int numberOfBytesRead;\n\n        TcpClient client = (TcpClient)obj;         \n        NetworkStream networkStream = client.GetStream();\n        IPAddress address = ((IPEndPoint)client.Client.RemoteEndPoint).Address;\n\n        Boolean bClientConnected = true;\n        int id = Thread.CurrentThread.ManagedThreadId;\n        while (bClientConnected)\n        {\n\n            try {\n                if (networkStream.DataAvailable)\n                {\n                    byteread = networkStream.Read(bytesFrom, 0, (int)client.ReceiveBufferSize);\n                    dataFromClient = Encoding.ASCII.GetString(bytesFrom).TrimEnd('\\0');\n                    System.Text.Encoding.ASCII.GetString(bytesFrom);\n\n                    XmlDocument doc = new XmlDocument();\n                    string xml = Encoding.UTF8.GetString(bytesFrom).TrimEnd('\\0');\n                    doc.LoadXml(xml);\n                    XElement incc = XElement.Load(new XmlNodeReader(doc));\n                    respdata = AysncTCPIncomeString(incc);\n\n                    sendBytes = Encoding.ASCII.GetBytes(respdata);\n                    networkStream.Write(sendBytes, 0, sendBytes.Length);\n                    networkStream.Flush();\n\n                }\n\n            }\n            catch (Exception ex)\n            {\n                Helper.WriteLog(\"Exception=\" + ex.Message);\n            }\n\n        }\n    }\n\n    public void SentFirstTimeData_New(TcpClient tc)\n    {\n        try\n        {\n            int threadid = Thread.CurrentThread.ManagedThreadId;\n            string Msg = HLStatusResponse.FirstTimeStatusSuccessfulResponse(\"STATUS\", \"1\");\n            NetworkStream _NetworkStream = tc.GetStream();\n            if (_NetworkStream != null)\n            {\n                byte[] data = Encoding.ASCII.GetBytes(Msg);\n                _NetworkStream.Write(data, 0, data.Length);\n\n                Helper.WriteLog(\"ThreadId=\" + threadid.ToString() + \";SentFirstTimeData :\\t \" + Msg);\n            }\n\n        }\n        catch (Exception ex)\n        {\n            Helper.WriteLog(\"Sent Though Tcp Eror :\" + ex.ToString());\n\n        }\n    }\n\n\n\n}"], "tags": ["c#", "multithreading", "server", "tcp"]}
{"texts": ["Format names to title case", "So I'm writing a program to format names to title case and display them in alphabetic order.  Any advice please?  And how can i add more methods?\n\npublic static void main (String [] args)\n{    \n    //local variables\n    string name1;\n    string name2;\n\n     myLib = new Library();\n\n     /********************   Start main method  *****************/\n\n     //prompt user for first Name\n     System.out.print(\"Enter First Name : \");\n     name1 = Keyboard.readChar(); \n\n     //prompt user for second\n     System.out.print(\"Enter Second Name : \");\n     name2 = Keyboard.readChar(); \n\n     //Format names to Title Case\n     name1.replace(0, name1.length(), name1.toString().toLowerCase());\n     name2.replace(0, name2.length(), name2.toString().toLowerCase()); \n\n     name1.setCharAt(0, Character.toTitleCase(name1.charAt(0)));\n     name2.setCharAt(0, Character.toTitleCase(name2.charAt(0)));\n\n     //clear the screen\n     myLib.clrscr();\n\n     //Display names in alphabet order\n     if (name1.toString().compareTo(name2.toString()) &gt;= 0) {\n         System.out.println(name2 + \" \" + name1);    \n     } else {\n         System.out.println(name1 + \" \" + name2);\n     }    \n\n     //pause the screen\n     //myLib.pause();\n\n  } //end main method\n\n} //end"], "tags": ["java", "homework", "functional-programming"]}
{"texts": ["Stop Watch Application 2.0", "After the tips from my previous review. I have come up with these changes:\n\n\nChanged my braces to start on a new line\nUsed the Single Responsibility Principle\nReturn early whenever possible \nUse a namespace that doesn't start with an underscore\n\n\nI'm not entirely sure I have used the namespace correctly. If it's wrong, can you please give me a push in the right direction? Any other comments would be appreciated. \n\nnamespace Difficult.StopWatch0002\n{\n    public partial class StopWatchForm : Form\n    {\n    StateEnum state;\n    Stopwatch stopWatch;\n    TimeSpan timeSpan;\n    string elapsedTime;\n    List&lt;string&gt; times = new List&lt;string&gt;();\n\n    public StopWatchForm()\n    {\n        InitializeComponent();\n        state = StateEnum.Stoped;\n    }\n\n    private void StartAndLapButton_Click(object sender, EventArgs e)\n    {\n        if (state == StateEnum.Stoped)\n        {\n            stopWatch = Stopwatch.StartNew();\n            state = StateEnum.Started;\n            ChangeButtonText(StartAndLapButton, \"Lap\");\n            ChangeFormTitle(\"Started\");\n            timer1.Enabled = true;\n        } else if (state == StateEnum.Started)\n        {\n            times.Add(elapsedTime);\n        }\n    }\n\n    private void StopButton_Click(object sender, EventArgs e)\n    {\n        if (state == StateEnum.Started)\n        {\n            ChangeButtonText(StartAndLapButton, \"Start\");\n            ChangeFormTitle(\"Stop Watch\");\n            stopWatch.Stop();\n            times.Add(elapsedTime);\n            state = StateEnum.Stoped;\n            timer1.Enabled = false;\n        }\n    }\n\n    private void FileButton_Click(object sender, EventArgs e)\n    {\n        if (!times.Any())\n        {\n            return;\n        }\n        var filename = PromtSaveAsFileName();\n        if (filename == null)\n        {\n            return;\n        }\n        WriteResultsToFile(filename);\n        times.Clear();\n    }\n\n    private void WriteResultsToFile(string filename)\n    {\n        System.IO.File.WriteAllLines(filename, times);\n    }\n\n    private string PromtSaveAsFileName()\n    {\n        var dialog = new SaveFileDialog\n        {\n            DefaultExt = \"txt\",\n            Filter = \"txt files (*.txt)|*.txt|All files (*.*)|*.*\",\n            FilterIndex = 2,\n            RestoreDirectory = true\n        };\n\n        if (dialog.ShowDialog() == DialogResult.OK)\n        {\n            return dialog.FileName;\n        }\n\n        return null;\n    }\n\n\n    void ChangeButtonText(Button button, string text)\n    {\n        button.Text = text;\n    }\n\n    private void ChangeFormTitle(string text)\n    {\n        this.Text = text;\n    }\n\n    private void timer1_Tick(object sender, EventArgs e)\n    {\n        timeSpan = stopWatch.Elapsed;\n        elapsedTime = String.Format(\"{0:00}:{1:00}:{2:00}\", timeSpan.Hours, timeSpan.Minutes, timeSpan.Seconds);\n        TimeKeeperText.Text = elapsedTime;\n    }\n}\n}"], "tags": ["c#", "winforms", "timer"]}
{"texts": ["Local maxima 3D array python", "I'm trying to find the local maxima in a 3D numpy array, but I can't seem to find an easy way to do that using numpy, scipy, or anything else.\n\nFor now I implemented it using scipy.signal.argrelexrema. But it's very long to process large arrays, and only works on separated axes.\n\nimport numpy as np\nfrom scipy.signal import argrelextrema\n\n\ndef local_maxima_3D(data, order=1):\n    \"\"\"Detects local maxima in a 3D array\n\n    Parameters\n    ---------\n    data : 3d ndarray\n    order : int\n        How many points on each side to use for the comparison\n\n    Returns\n    -------\n    coordinates : ndarray\n        coordinates of the local maxima\n    values : ndarray\n        values of the local maxima\n    \"\"\"\n    # Coordinates of local maxima along each axis\n    peaks0 = np.array(argrelextrema(data, np.greater, axis=0, order=order))\n    peaks1 = np.array(argrelextrema(data, np.greater, axis=1, order=order))\n    peaks2 = np.array(argrelextrema(data, np.greater, axis=2, order=order))\n\n    # Stack all coordinates\n    stacked = np.vstack((peaks0.transpose(), peaks1.transpose(),\n                         peaks2.transpose()))\n\n    # We keep coordinates that appear three times (once for each axis)\n    elements, counts = np.unique(stacked, axis=0, return_counts=True)\n    coords = elements[np.where(counts == 3)[0]]\n\n    # Compute values at filtered coordinates\n    values = data[coords[:, 0], coords[:, 1], coords[:, 2]]\n\n    return coords, values\n\n\nI know this solution is far from optimal and only works with order=1. Is there any better way to find local maxima in a 3D array in Python?"], "tags": ["python", "numpy", "scipy"]}
{"texts": ["Nested switch to return configuration for combination of 3 database types and 4 domains", "I am currently doing a code review for a coworker.\n\nI have encountered something like this:\n\nswitch (type)\n{\n    case DatabaseType.Type1:\n        switch (domain)\n        {\n            case DOMAIN_1:\n                return DatabaseConfigType.Type1Domain1;\n            case DOMAIN_2:\n                return DatabaseConfigType.Type1Domain2;\n            case DOMAIN_3:\n                return DatabaseConfigType.Type1Domain3;\n            case DOMAIN_4:\n                return DatabaseConfigType.Type1Domain4;\n            default:\n                Trace.Error(\"Undefined Type1 domain :\" + domain);\n                throw new ArgumentOutOfRangeException(\"domain\", domain, null);\n        }\n    case DatabaseType.Type2:\n        switch (domain)\n        {\n            case DOMAIN_1:\n                return DatabaseConfigType.Type2Domain1;\n            case DOMAIN_2:\n                return DatabaseConfigType.Type2Domain2;\n            case DOMAIN_3:\n                return DatabaseConfigType.Type2Domain3;\n            case DOMAIN_4:\n                return DatabaseConfigType.Type2Domain4;\n            default:\n                Trace.Error(\"Undefined Type2 domain :\" + domain);\n                throw new ArgumentOutOfRangeException(\"domain\", domain, null);\n        }\n    case DatabaseType.Type3:\n        switch (domain)\n        {\n            case DOMAIN_1:\n                return DatabaseConfigType.Type3Domain1;\n            case DOMAIN_2:\n                return DatabaseConfigType.Type3Domain2;\n            case DOMAIN_3:\n                return DatabaseConfigType.Type3Domain3;\n            case DOMAIN_4:\n                return DatabaseConfigType.Type3Domain4;\n            default:\n                Trace.Error(\"Undefined Type3 domain :\" + domain);\n                throw new ArgumentOutOfRangeException(\"domain\", domain, null);\n        }\n    default:\n        Trace.Error(\"Undefined type :\" + type);\n        throw new ArgumentOutOfRangeException(\"type\", type, null);\n}\n\n\nObviously, Types and Domains have actual wordy names, I just changed them for the question because they are irrelevant and probably sensitive information. On the other hand, the actual names for the DatabaseConfigType Enum are literally of the format TypeDomain, with the actual names of the type and domain instead of my numbered version.\n\nI see this code, and it just feels wrong. There is some obvious redundancy by having three times (possibly more in the future) the exact same switch conditions inside each \"outer\" switch case, but since they return an Enum with different values, I just can't figure out a way to actually make this better.\n\nThe enum is in no particular order, and can't be expected to stay the same, so I can't do some math-ish unreadable but fast solution, not that I think it would be better anyway.\n\nThe code is probably as fast as it can be while still being readable, I'm mostly looking for a way to reduce the copy-paste aspect, therefore the lines of code, because I can't shake the feeling that there has to be a better way. If there isn't, feel free to tell me that."], "tags": ["c#", "enum", "configuration"]}
{"texts": ["C program that reverses a string", "As practice with the (ever so painful) C Strings I wrote a string reversal program. I am new to C, so I wanted to make sure that I am not using bad coding practices. It runs just fine (at least with expected input), but I am not sure if the logic is as good as it could be. \n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nchar* strreverse(char* c) \n{\n    char input[500], output[500] = {}, buffer[2] = {' ', '\\0'};\n    strcpy(input, c);\n    int i;\n    for(i = strlen(input); i &gt;= 0; i--)\n    {\n        buffer[0] = input[i];\n        strcat(output, buffer);\n    }\n    return (char*) output;\n}\n\nint main(void)\n{\n    char* in = malloc(256);\n    printf(\"Enter a string: \");\n    scanf(\"%s\", in);\n    char* out = strreverse(in);\n    printf(\"%s\", out);\n    return 0; \n}"], "tags": ["c", "strings"]}
{"texts": ["Simple menu with sub-levels", "The following works as intended, however is there a more concise way to write this script without changing it too much? It's a simple menu with sub-levels which have a plus/minus icon when each li opens/closes.\n\njQuery:\n\n$(document).ready(function() {\n    $li = $('#main &gt; li.expand');\n    $li.click(function(){\n        $ul = $(this).find('ul.sub-level').delay(200).slideDown(400);\n        $(this).removeClass('expand').addClass('minus');\n        $('#main &gt; li &gt; ul').not($ul).slideUp('slow');\n        $('#main &gt; li.minus').not($(this)).removeClass('minus').addClass('expand');\n\n    })\n\n    $li2 = $('.sub-level &gt; li.expand');\n    $li2.click(function(){\n        $(this).find('ul.sub-level2').delay(200).slideToggle(400);\n        $li2.toggleClass('minus').toggleClass('expand');\n    })      \n});\n\n\nHTML:\n\n&lt;ul id=\"main\"&gt;\n&lt;li class=\"expand\"&gt;test-1\n&lt;ul class=\"sub-level\"&gt;\n    &lt;li class=\"expand\"&gt;sub-test-1\n        &lt;ul class=\"sub-level2\"&gt;\n            &lt;li&gt;sfasfasf&lt;/li&gt;\n            &lt;li&gt;sfafasf&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n  &lt;/li&gt;\n  &lt;li&gt;test-2&lt;/li&gt;\n  &lt;li class=\"expand\"&gt;test-3\n  &lt;ul class=\"sub-level\"&gt;\n    &lt;li&gt;sub-test-2&lt;/li&gt;\n    &lt;/ul&gt;\n   &lt;/li&gt;\n   &lt;li&gt;test-4&lt;/li&gt;\n   &lt;/ul&gt;"], "tags": ["javascript", "jquery", "html"]}
{"texts": ["Variation of the internal PHP hashtable", "I'm working on a PHP extension in an attempt to learn some C. I've implemented a variation of the internal PHP hashtable, which uses a lookup table and a separate bucket table. The lookup table simply points to the head of the collision chain (an index in the bucket table), and the next index in the chain is embedded in each bucket. Buckets are inserted into the table in insertion order.\n\n#define INVALID_INDEX ((uint32_t) -1)\n\ntypedef struct _HBucket {\n\n    zval          key;\n    zval          value;  // Collision chain index in here\n    zend_ulong    hash;\n\n} HBucket;\n\ntypedef struct _HTable {\n\n    HBucket   *buckets;\n    uint32_t  *lookup;    \n    uint32_t   next;      // Index at which the next bucket will be created\n    uint32_t   size;      // Number of actual items in the table\n    uint32_t   capacity;  // Power of two size buffer\n\n} HTable;\n\n\n\n\nHBucket *htable_lookup_or_create(HTable *table, zval *key)\n{\n    HBucket *bucket;\n    HBucket *buckets = table-&gt;buckets;\n\n    const zend_ulong hash = get_hash(key);\n\n    uint32_t l_index = hash &amp; (table-&gt;capacity - 1);  // Lookup index\n    uint32_t b_index = table-&gt;lookup[l_index];        // Bucket index\n\n    if (b_index == INVALID_INDEX) {\n\n        // Lookup should point to the head of the collision chain,\n        // which is where the new entry will be.\n        table-&gt;lookup[l_index] = table-&gt;next;\n\n    } else {\n\n        // Traverse the collision chain...\n        for (;;) {\n\n            bucket = &amp;buckets[b_index];\n\n            // If the bucket's key is a match, we've found the bucket.\n            if (bucket-&gt;hash == hash &amp;&amp; is_identical(&amp;bucket-&gt;key, key)) {\n                return bucket;\n\n            } else {\n\n                // Index of the next bucket in the chain\n                uint32_t next = Z_NEXT(bucket-&gt;value);\n\n                // Check to see if we're at the end of the chain,\n                // and set that bucket's next as the new entry.\n                if (next == INVALID_INDEX) {\n                    Z_NEXT(bucket-&gt;value) = table-&gt;next;\n                    break;\n                }\n\n                b_index = next;\n            }\n        }\n    }\n\n    // Initialize the new bucket\n    bucket = &amp;buckets[table-&gt;next];\n\n    bucket-&gt;hash = hash;\n    ZVAL_COPY(&amp;bucket-&gt;key, key);\n    ZVAL_NULL(&amp;bucket-&gt;value);\n\n    // New bucket doesn't have a next\n    Z_NEXT(bucket-&gt;value) = INVALID_INDEX;\n\n    table-&gt;size++;\n    table-&gt;next++;\n\n    if (table-&gt;next == table-&gt;capacity) {\n        htable_increase_capacity(table);\n        return &amp;table-&gt;buckets[table-&gt;size - 1];  // Address may have changed.\n    }\n\n    return bucket;\n}\n\n\nI realise that there are multiple zend macros, but their effects are negligible for the sake of this question. I'd be happy to expand them all if required.\n\nI'm developing on OS X, and I've been profiling adding millions of values to determine where things might be slowing down, and it comes down to this function almost entirely.\n\nIs there anything obvious that I could do or try to improve the performance?"], "tags": ["c", "hash-map"]}
{"texts": ["Upload csv file to sqlserver with python", "I have to weekly upload a csv file to sqlserver, and I do the job using python 3.\nThe problem is that it takes too long for the file to be uploaded (around 30 minutes), and the table has 49000 rows and 80 columns.\n\nHere is a piece of the code, where I have to transform the date format and replace quotes as well. I have already tried it with pandas, but took longer than that.\n\nimport csv\nimport os\nimport pyodbc\nimport time\nsrv='server_name'\ndb='database'\ntb='table'\nconn=pyodbc.connect('Trusted_Connection=yes',DRIVER='{SQL Server}',SERVER=srv,DATABASE=db)\nc=conn.cursor()\n\ncsvfile='file.csv'\n\nwith open(csvfile,'r') as csvfile:\nreader = csv.reader(csvfile, delimiter=';')\n    cnt=0\n    for row in reader:\n        if cnt&gt;0:\n            for r in range(0,len(row)):\n                #this is the part where I transform the date format from dd/mm/yyyy to yyyy-mm-dd\n                if (len(row[r])==10 or len(row[r])==19) and row[r][2]=='/' and row[r][5]=='/':\n                    row[r]=row[r][6:10]+'-'+row[r][3:5]+'-'+row[r][0:2]\n\n                #here I replace the quote to nothing, since it is not important for the report\n                if row[r].find(\"'\")&gt;0:\n                    row[r]=row[r].replace(\"'\",\"\")\n\n        #at this part I query the index to increment by 1 on the table\n        qcnt=\"select count(1) from \"+tb\n        resq=c.execute(qcnt)\n        rq=c.fetchone()\n        rq=str(rq[0])\n\n        #here I insert each row into the table that already exists\n        insrt=(\"insert into \"+tb+\" values(\"+rq+\",'\"+(\"', '\".join(row))+\"')\")\n        if cnt&gt;0:\n            res=c.execute(insrt)\n            conn.commit()\n        cnt+=1\nconn.close()\n\n\nAny help will be appreciated. Thanks!"], "tags": ["python", "sql-server", "csv"]}
{"texts": ["Basic templating engine in F# using F# syntax", "I've been working on a rough idea for a templating engine (mostly as a learning project) using the F# syntax. How \"correct\" is my code in terms of being idiomatic F#? Are there F# features which would make the code simpler? More easily understood? \n\nThe template files are loaded at runtime using a script I've not posted here The code is also provided as a gist for easier reading.\n\nTemplate\n\n#r \"program.exe\"\nopen System\nopen Lib\n\nlet intToText i = div [] [Text((sprintf \"I is %i\" i))]\n\nTemplate (\n    html [] [\n        div [(\"id\", \"123\");(\"class\", \"me\")] [\n            div [] [   \n                Text \"SOME TEXT\"\n            ]\n            div [] [\n                Text \"SOME MORE TEXT\"\n            ]\n            foreach [1;2;3] intToText\n            input [(\"type\", \"text\"); (\"value\", \"1\")]\n        ]\n    ]\n)\n\n\nLib\n\nmodule Lib\nopen System\nopen System.Text\n\ntype Attributes = (string * string) list\n\ntype Element =\n    | Tag of (string * Attributes * Element list)\n    | TagSelfClosing of (string * Attributes)\n    | Collection of (Element list)\n    | Text of string\n\nlet html (attrs:Attributes) el:Element = Tag(\"html\", attrs, el)\nlet div (attrs:Attributes) el:Element = Tag(\"div\", attrs, el)\nlet input (attrs:Attributes) = TagSelfClosing(\"input\", attrs)\nlet foreach data fn = \n    let elems = data |&gt; List.map fn\n    Collection(elems)\n\ntype Token = \n    | OPEN_TAG of (string * Attributes)\n    | CLOSE_TAG of string\n    | SELF_CLOSING_TAG of (string * Attributes)\n    | TEXT of string \n\nlet Template el =\n    let rec expandTree el output = \n        match el with\n        | Tag(tagName, attrs, children) -&gt; \n            let childContent = \n                children\n                |&gt; List.fold (fun state item -&gt; state @ (expandTree item [])) []\n\n            let addition = [OPEN_TAG(tagName, attrs)]@childContent@[CLOSE_TAG(tagName)]\n            output@addition\n        | TagSelfClosing(tagName, attrs) -&gt;\n            let addition = [SELF_CLOSING_TAG(tagName, attrs)]\n            output@addition\n        | Collection(elements) -&gt;\n            let collectionContent =\n                elements\n                |&gt; List.map (fun e -&gt; expandTree e output)\n                |&gt; List.fold (fun state item -&gt; state@item) []\n            output @ collectionContent\n        | Text(string) -&gt;\n            output@[TEXT(string)]\n\n    let tokenWriter token = \n        let attributeWriter (tuple:string*string) =\n            let (name, value) = tuple\n            sprintf \" %s=\\\"%s\\\"\" name value\n\n        let foldAttributes attrs =\n            attrs\n            |&gt; List.map attributeWriter\n            |&gt; List.fold (fun state item -&gt; state+item) \"\" \n\n        match token with\n        | OPEN_TAG(name, attrs) -&gt; \n            let attributes = foldAttributes attrs\n            sprintf \"&lt;%s%s&gt;\" name attributes\n        | CLOSE_TAG(name) -&gt; sprintf \"&lt;/%s&gt;\" name\n        | SELF_CLOSING_TAG(name, attrs) -&gt; \n            let attributes = foldAttributes attrs\n            sprintf \"&lt;%s%s /&gt;\" name attributes\n        | TEXT(content) -&gt; sprintf \"%s\" content \n\n    let expandedTree = expandTree el []\n    let content = \n        expandedTree \n        |&gt; List.map tokenWriter \n        |&gt; List.fold (fun state item -&gt; state+item) \"\"\n\n    printf \"%s\" content"], "tags": ["f#", "template-meta-programming"]}
{"texts": ["Simple Java Singleton", "Below is a Singleton that I designed as a piece of sample code for a website I'm working on for fun. The goal is to use the Singleton to hold an Earth object since Earth is unique and there is only 1 of them. Please let me know your thoughts on the implementation. \n\nSingleton.java\n\npackage design.patterns;\n\n /**\n  * This class is a Singleton, we can only have 1 instance of it no matter what!\n  * \n  * We mark the class final so that no other classes try to extend it. Some\n  * designs would want the Singleton to be extendable but we do not!\n  */\npublic final class Earth {\n\n    // A static instance of an Earth object\n    private static Earth earth;\n\n    // Some earthly variables\n    private long ageInYears = 4500000000L;\n    private float daysForFullOrbit = 365.26f;\n    private float degreesOfAxisTilt = 23.4f;\n    private long population = 7046000000L;\n\n    // Prevent client from instantiating new Earth objects\n    private Earth() {\n    }\n\n    /**\n     * Global access point (no pun intended :)\n     * \n     * Synchronized so its thread safe.\n     */\n    public static synchronized Earth getInstance() {\n\n        // \"Lazy load\" an Earth Object\n        if (earth == null) {\n            earth = new Earth();\n        }\n\n        return earth;\n    }\n\n    // Basic getters and setters\n    public double getAgeInYears() {\n        return ageInYears;\n    }\n\n    public void setAgeInYears(long ageInYears) {\n        this.ageInYears = ageInYears;\n    }\n\n    public float getdaysForFullOrbit() {\n        return daysForFullOrbit;\n    }\n\n    public void setdaysForFullOrbit(float daysForFullRotation) {\n        this.daysForFullOrbit = daysForFullRotation;\n    }\n\n    public float getDegreesOfAxisTilt() {\n        return degreesOfAxisTilt;\n    }\n\n    public void setDegreesOfAxisTilt(float degreesOfAxisTilt) {\n        this.degreesOfAxisTilt = degreesOfAxisTilt;\n    }\n\n    public double getPopulation() {\n        return population;\n    }\n\n    public void setPopulation(int population) {\n        this.population = population;\n    }\n\n    public static void setEarth(Earth earth) {\n        Earth.earth = earth;\n    }\n}\n\n\nClient.java\n\npackage design.patterns;\n\npublic class Client {\n\n    public static void main(String args[]){\n\n        Earth earth = Earth.getInstance();\n\n        //Invoke Earth's methods from the instance created on line 7\n        System.out.printf(\"Earth is over %1$,.0f Days old. \\n\", earth.getAgeInYears());\n\n        //Invoke Earth's methods from the Singleton directly\n        System.out.println(\"Earth's orbit takes \" + Earth.getInstance().getdaysForFullOrbit() + \" days to complete.\");\n\n        //Invoke Earth's methods both ways\n        System.out.println(\"Earth sits on a \" + earth.getDegreesOfAxisTilt() + \" degree tilt.\");\n        System.out.printf(\"As of 1/20/2014, there are %1$,.0f people on Earth!\", + Earth.getInstance().getPopulation());\n    }\n}"], "tags": ["java", "singleton"]}
{"texts": ["Efficient Django model for blog post", "I'm currently trying to create a travel blog using Django whereby users will be able to create a travel plan with the following features:\n\n\nEach user can create a travel event based on the start date and end date for specific locations, with some meaningful description\nHe/She can also upload images for associated with specific travel event\nA travel plan can consists of multiple travel events of various date\n\n\nWill the following model be an efficient design?\n\n    from django.db import models\n    import datetime\n\n    from __future__ import unicode_literals\n    from django.core.urlresolvers import reverse\n    from django.core.exceptions import ValidationError\n    from django.utils import timezone\n    from django.utils.translation import ugettext_lazy as _\n    from django.conf import settings\n    from django.utils.encoding import python_2_unicode_compatible\n\n    # Create your models here.\n\n    auth_user_model = getattr(settings, \"AUTH_USER_MODEL\", \"auth.User\")\n\n    class Entry(models.Model):\n        title = models.CharField(max_length=100)\n        start_date = models.DateTimeField(_(\"start date\"))\n        end_date = models.DateTimeField(_(\"end date\"))\n        description = models.TextField(_(\"description\"))\n        accomodation = models.TextField(_(\"accomodation\"))\n        location = models.TextField(_(\"location\"))\n        images = models.ManyToManyField(\"Image\", verbose_name=_(\"images\"), blank=True, null=True)\n        post_entry = models.ForeignKey(Post_Entry)\n\n    class Post_Entry(models.Model):\n        author = models.ForeignKey(User)\n        created_by = models.ForeignKey(auth_user_model, verbose_name=_(\"created by\"))\n        categories = models.ManyToManyField(\"Category\", verbose_name=_(\"categories\"), blank=True)\n        created_on = models.DateTimeField(auto_now_add = True)  \n        remarks = models.TextField(_(\"Remarks\"))\n\n    @python_2_unicode_compatible\n    class Image(models.Model):\n        title = models.CharField(max_length=60, blank=True, null=True)\n        image = models.FileField(upload_to=\"images/\")\n        width = models.IntegerField(blank=True, null=True)\n        height = models.IntegerField(blank=True, null=True)\n\n        def __str__(self):\n            return self.image.name\n\n    @python_2_unicode_compatible\n    class Category(models.Model):\n        title = models.CharField(_('title'), max_length=255)\n\n        def __str__(self):\n            return self.title\n\n        class Meta:\n            verbose_name_plural = 'Categories'"], "tags": ["python", "django"]}
{"texts": ["Should I put a JavaScript function in a local or global scope?", "I have many pages with functions that appear only once, which I am sure is really typical.  I read that it's the best idea to use the local scope for functions when possible because the local scope is searched first, thereby making the function found sooner.\n\nIf I have no intention of reusing a function, is this the best way to create and use this function?\n\nvar doCancel = function doCancel() {\n    // DO SOME CANCELLING TYPE STUFF\n}\n\n\nOr is this a better way?\n\nfunction doCancel() {\n    // DO SOME CANCELLING TYPE STUFF\n}"], "tags": ["javascript"]}
{"texts": ["Better way to return data via AJAX?", "Let's say I have three files: a page that is used for searching data called search, a file that handles requests called controller, and a file that has functions which the controller calls based on what POST parameter is passed. From the search page, I post some data and specify my action (search) via AJAX to the controller. The controller then takes that and calls a function that returns the data (which is inserted into the appropriate place in the DOM) which looks something like this:\n\n&lt;?php\nfunction fetchStudentData($search, $roster) {\n\n    //If a user is not logged in or the query is empty, don't do anything\n    if(!isLoggedIn() || empty($search)) {\n        return;\n    }\n    global $db;\n\n    //Placement roster search\n    if($roster == \"placement\") {\n        $query = $db-&gt;prepare(\"SELECT t1.id,\n                t2.placement_date,\n                t2.placement_room,\n                t1.student_id,\n                t1.student_type,\n                t1.last_name,\n                t1.first_name,\n                t1.satr,\n                t1.ptma,\n                t1.ptwr,\n                t1.ptre,\n                t1.ptlg,\n                t1.waiver,\n                t2.tests_needed,\n                t2.blackboard_id\n                FROM student_data AS t1\n                JOIN additional_data AS t2\n                ON t1.id = t2.student_data_id\n                WHERE t2.placement_date = :search\n                ORDER BY t1.last_name ASC\");\n        $query-&gt;bindParam(\":search\", $search);\n        $query-&gt;execute();\n\n        if($query-&gt;rowCount() == 0) {\n            return;\n        }\n\n        echo \"&lt;div id='searchHeader'&gt;\n            &lt;div class='searchSubHead'&gt;&lt;em&gt;Placement Roster For $search&lt;/em&gt;&lt;/div&gt;\n            &lt;br /&gt;\n            &lt;span&gt;Placement Room&lt;/span&gt;\n            &lt;span&gt;Student ID&lt;/span&gt;\n            &lt;span&gt;Student Type&lt;/span&gt;\n            &lt;span&gt;Last Name&lt;/span&gt;\n            &lt;span&gt;First Name&lt;/span&gt;\n            &lt;span&gt;SATR&lt;/span&gt;\n            &lt;span&gt;PTMA&lt;/span&gt;\n            &lt;span&gt;PTWR&lt;/span&gt;\n            &lt;span&gt;PTRE&lt;/span&gt;\n            &lt;span&gt;PTLG&lt;/span&gt;\n            &lt;span&gt;Waiver&lt;/span&gt;\n            &lt;span&gt;Tests Needed&lt;/span&gt;\n            &lt;span&gt;Blackboard ID&lt;/span&gt;\n        &lt;/div&gt;\";\n        while($row = $query-&gt;fetch()) {\n            echo \"&lt;div id='{$row['id']}' class='placementRosterRecord'&gt;\n                &lt;span&gt;{$row['placement_room']}&lt;/span&gt;\n                &lt;span&gt;{$row['student_id']}&lt;/span&gt;\n                &lt;span&gt;{$row['student_type']}&lt;/span&gt;\n                &lt;span&gt;{$row['last_name']}&lt;/span&gt;\n                &lt;span&gt;{$row['first_name']}&lt;/span&gt;\n                &lt;span&gt;{$row['satr']}&lt;/span&gt;\n                &lt;span&gt;{$row['ptma']}&lt;/span&gt;\n                &lt;span&gt;{$row['ptwr']}&lt;/span&gt;\n                &lt;span&gt;{$row['ptre']}&lt;/span&gt;\n                &lt;span&gt;{$row['ptlg']}&lt;/span&gt;\n                &lt;span&gt;{$row['waiver']}&lt;/span&gt;\n                &lt;span&gt;{$row['tests_needed']}&lt;/span&gt;\n                &lt;span&gt;{$row['blackboard_id']}&lt;/span&gt;\n            &lt;/div&gt;\";\n        }\n    }\n}\n?&gt;\n\n\nThis is obviously working very well for me but I wanted to know if there's a better way I should be doing this? Should I be returning the raw data from the database and encoded as JSON and then have my JavaScript take care of creating elements/structure? I see that a lot with various API's but this is something internal to my company and not something that other developers will be using. Is there anything wrong with my approach?"], "tags": ["javascript", "php", "mysql", "ajax", "json"]}
{"texts": ["Player Rotation script", "This is my player rotation script. I just want to make sure my naming conventions are right. If there is any way to make this code more readable I'm open to suggestions. This is also my 3rd post about along the same line so please be brutal.\n\npublic class ShipRotation : MonoBehaviour\n{\n    [SerializeField] Canvas canvas;\n    ShipManager shipControls;\n    GameObject ship;\n    DebugController debugController;\n    Camera shortHandCamera;\n    [SerializeField] GameObject mainCamera;\n    float distFromCamera;\n\n    void Start()\n    {\n        shortHandCamera = Camera.main;\n        shipControls = GetComponent&lt;ShipManager&gt;();\n        debugController = canvas.GetComponent&lt;DebugController&gt;();\n        ship = GameObject.Find(\"Player\");\n        distFromCamera = Mathf.Abs(mainCamera.transform.position.z);\n        target = new Vector3(0f, 2f, ship.transform.position.z);\n    }\n\n    enum StateOfRotation\n    {\n        waiting,\n        rotating\n    }\n\n    public LayerMask touchInputMask;\n    Vector3 target;\n    void Update()\n    {\n        foreach (Touch touch in Input.touches)\n        {\n            Ray ray = Camera.main.ScreenPointToRay(touch.position);\n            RaycastHit hit;\n            if (!Physics.Raycast(ray, out hit, touchInputMask)) { continue; }\n\n            GameObject recipient = hit.transform.gameObject;\n            if (recipient.tag != \"Player\")\n            {\n                target = Camera.main.ScreenToWorldPoint(new Vector3(touch.position.x, touch.position.y, ship.transform.position.z + distFromCamera));\n            }\n        }\n        ship.transform.LookAt(target);\n        debugController.ChangeText(6, target.ToString());\n    }\n}"], "tags": ["c#", "unity3d"]}
{"texts": ["Counting occurrences of Char8s in a file", "To learn some Data.Map and Control.Monad.State, I have written the following code, which should count the occurrences of Char8 in a given file.\n\nmodule Main where\n\nimport           Control.Monad.State\nimport qualified Data.ByteString.Char8 as B\nimport           Data.Char\nimport           Data.Map              (Map)\nimport qualified Data.Map              as M\nimport           Data.Maybe\nimport           System.Environment\n\ntype Counter = ([Char], (Char, Integer), (Char, Integer), Map Char Integer)\n\nmain :: IO ()\nmain = do\n  file &lt;- liftM head getArgs\n  string &lt;- B.readFile file\n  let (chars, seldom, often, counter) = execState (countChars string) ([], (' ', 10^12), (' ', 0), M.empty)\n  mapM_ (\\k -&gt; putStrLn ('\\'':k:\"' \" ++ show (fromJust $ M.lookup k counter))) chars\n  putStrLn $ \"minimum occurence: \" ++ show (fst seldom) ++ \", \" ++ show (snd seldom)\n  putStrLn $ \"maximum occurence: \" ++ show (fst often)  ++ \", \" ++ show (snd often)\n  putStrLn $ \"overal chars     : \" ++ show (B.length string)\n\ncountChars :: B.ByteString -&gt; State Counter ()\ncountChars bs | B.null bs = return ()\n              | otherwise = do\n  let c  = B.head bs\n  let cs = B.tail bs\n  unless (not . isPrint $ c) $ do\n    (pre, minOcc, maxOcc, counter) &lt;- get\n    newPre &lt;- return $ if (c `elem` pre)\n                         then pre\n                         else pre ++ [c]\n    newCounter &lt;- return (M.insertWith (+) c 1 counter)\n    let newMinOcc = (\\ (k1, v1) (k2, v2) -&gt; if v2 &lt; v1 then (k2, v2) else (k1, v1)) minOcc (c, newCounter M.! c)\n    let newMaxOcc = (\\ (k1, v1) (k2, v2) -&gt; if v2 &gt; v1 then (k2, v2) else (k1, v1)) maxOcc (c, newCounter M.! c)\n    put (newPre, newMinOcc, newMaxOcc, newCounter)\n  countChars cs\n\n\nThis code works as I want it for small files, counting and displaying the stats of the file, but it fails when the file gets bigger:\n\n$ ls -l 46000.txt.utf-8\n-rw-r--r-- 1 nobbz nobbz 156315 Jun 16 20:33 46000.txt.utf-8\n\n$ ./Main 46000.txt.utf-8\nStack space overflow: current size 8388608 bytes.\nUse `+RTS -Ksize -RTS' to increase it.\n\n\nI don't grasp why a file of about 150kiB can overflow an 8Mib stack. If I increase to 10 MiB (./Main 46000.txt.utf-8 +RTS -k10M) it works, but using also -sstderr shows that the Program consumes 107 MiB in total.\n\nHow could I decrease memory usage, so it would work with large files and default stack-size?\n\nEdit\n\nJust to mention:\n\nI want to keep the list of chars and their count of occurrence in the order of occurrence of the corresponding char, also I want that on equal count for most often and most seldom used chars that one \"wins\" that has occurred first.\n\nAlso I am aware of the fact that I have a file that states to be UTF-8 encoded and my program can only \"see\" ASCII, but I just took a random book from gutenberg.org to have a real text and not some \"random\" bytes in huge binarys or something comparable."], "tags": ["haskell", "memory-management", "state", "hash-map"]}
{"texts": ["Trigger breakpoint when string is not a Google-owned domain", "Basically, I want the code to break when strLink doesn't contain any domains in the googleDomains link.\n\nThe code seems to be very awkward. I wonder if there is a way to make this more elegant.\n\nDim googleDomains = {\"google.com\", \"blogger.com\", \"youtube.com\"}\nDim pass = False\nFor Each domaingoogle In googleDomains\n    If strLink.Contains(domaingoogle) Then\n        pass = True\n    End If\nNext\nIf Not pass Then\n    Dim hello2 = 1 'set breakpoint here.\nEnd If"], "tags": ["vb.net"]}
{"texts": ["refactor ruby method", "i have 3 method which do almost the same thing,they different models to achieve the same      goal.I did small refactoring but its still not looks like\n   ruby,can we improve it?\n   Thanks in advance. \n\nafter: \n\ndef get_list(id,list_name,attribute_id,attribute,locale_string)    \n  map={ \"resentact\" =&gt; ResenAct }, \"stageact\" =&gt; StageAct , \"payact\" =&gt; PayAct\" }\n  @temp=\"\"\n  @list=map[list_name.downcase].find(:all, :conditions =&gt; {'id' =&gt; \"#      {id}\".chop_space})\n   @list.each do |item|\n      @temp = @temp + get_data(item.attribute_id,item) + \" \" + item.attribute + \" \" +   locale_string+ \", \" \n   end\n   return  @temp.pop(2) if @temp.length &gt; 1\n  end\n\n\nmethod call : get_list(id,payact,payact_id,date,\"some_string\")\n\nbefore:\n\n def get_resentact_list(id)    \n @temp=\"\"\n  @resentacts=ResentAct.find(:all, :conditions =&gt; {'product_id' =&gt; \"#{id}\".chop_space})\n   @resentacts.each do |item|\n      @temp = @temp + get_data(item.shop_id,\"resentact\") + \" \" + item.cost.to_s + \" \" + \"string1\" + \", \" \n   end\n   @temp = @temp[0,@temp.length-2] if @temp.length &gt; 1\n   return @temp\n\n\nend \n\n def get_stageact_list(id)     \n  @temp=\"\"\n\n    @stageacts=StageAct.find(:all, :conditions =&gt; {'product_id' =&gt; \"#{id}\".chop_space})\n    @stageacts.each do |item|\n       @temp = @temp + \"string1\" + \": \" + get_data(item.type_id,\"type\") + \", \" + \"str2\" + \": \" + item.summ + \" \" + \"str3\" + \", \"\n    end\n    @temp = @temp[0,@temp.length-2] if @temp.length &gt; 1\n    return @temp\n end \n\n\ndef get_payact_list(id)  \n  @temp=\"\"\n\n   @payacts=PayAct.find(:all, :conditions =&gt; {'product_id' =&gt; \"#{id}\".chop_space})\n      @payacts.each do |item|\n         @temp = @temp + \"str1\" + \": \" + item.date + \", \" + \"str2\" + \": \" + item.summ + \" \" + \"str3\" + \", \"\n      end\n      @temp = @temp[0,@temp.length-2] if @temp.length &gt; 1\n      return @temp\n  end"], "tags": ["ruby"]}
{"texts": ["Compare multiple values of an array in the same time in Javascript", "As of now the below code working As expected. But in future if the newFilterArr have new record again I want to reedit this functionality. So how to overcome this?\n\nfunction Optimiz() {\n    let courseFilter = this.newFilterArr.find(k =&gt; k.key === 'courseId'),\n        rateTypeFilter = this.newFilterArr.find(k =&gt; k.key === 'rateTypeId');\n\n    this.rateSetupDataUI = this.originalRateSetupDataUI.filter(x =&gt; {\n        if (courseFilter &amp;&amp; rateTypeFilter) {\n            return x['courseId'] === courseFilter.filtered.id &amp;&amp; x['rateTypeId'] === rateTypeFilter.filtered.id;\n        } else if (courseFilter &amp;&amp; !rateTypeFilter) {\n            return x['courseId'] === courseFilter.filtered.id\n        } else if (!courseFilter &amp;&amp; rateTypeFilter) {\n            return x['rateTypeId'] === rateTypeFilter.filtered.id;\n        }\n    });\n}"], "tags": ["javascript", "angular-2+"]}
{"texts": ["Local (In-Process) Publish/Subscribe", "I have a handful of objects that don't have references to each-other that all need to receive an update. \n\nFrom what I've read, it seems like a Publish-Subscribe Messaging Channel is an appropriate pattern. Searching for an existing solution mainly turned up messaging libraries for application integration (between processes). Those solutions were much more than what I needed, so I wrote this simple Publisher.\n\nQuestions:\n\n\nIs there already something simple like this in the .NET framework that I overlooked? Or another light-weight library?\nIs this an appropriate implementation and application of the Pub/Sub pattern? What might be done to improve it?\nWhat gotchas are there? For example, I presume I need to Unsubscribe in the subscriber's finalizer.\n\n\n\n\npublic interface ISubscriber\n{\n    void SubscriptionUpdate(object message);\n}\n\npublic interface IPublisher\n{\n    void Subscribe(ISubscriber subscriber, string channel);\n    void Unsubscribe(ISubscriber subscriber, string channel);\n    void Publish(string channel, object message);\n}\n\npublic class Publisher : IPublisher\n{\n    static Publisher _instance = new Publisher();\n    public static Publisher Instance { get { return _instance; } }\n    Dictionary&lt;string, List&lt;ISubscriber&gt;&gt; _subscribers = new Dictionary&lt;string, List&lt;ISubscriber&gt;&gt;();\n\n    public void Subscribe(ISubscriber subscriber, string channel)\n    {\n        if (!Exists(channel))\n            _subscribers[channel] = new List&lt;ISubscriber&gt;();\n        if (!_subscribers[channel].Contains(subscriber))\n            _subscribers[channel].Add(subscriber);\n    }\n\n    public void Unsubscribe(ISubscriber subscriber, string channel)\n    {\n        if (Exists(channel))\n            _subscribers[channel].Remove(subscriber);\n    }\n\n    public void Publish(string channel, object message)\n    {\n        if (!Exists(channel)) return;\n        foreach (var subscriber in _subscribers[channel])\n            subscriber.SubscriptionUpdate(message);\n    }\n\n    bool Exists(string channel)\n    {\n        return _subscribers.ContainsKey(channel);\n    }\n}"], "tags": ["c#", "design-patterns"]}
{"texts": ["Three functions to make a JSON array", "Currently I'm using these three functions, that in the end produces a JSON array. I went this way so that I could fetch data from a specific table. But now it just seems bloated and poorly written, mixed with stdClass and arrays.\n\npublic static function getFraga($quiz_id = false)\n{\n    $database = DatabaseFactory::getFactory()-&gt;getConnection();\n    $sql = \"SELECT * FROM questions\";\n    $arg = false;\n    if($quiz_id) {\n        $sql .= \" WHERE quiz_id = :quiz_id\";\n        $arg  = array(':quiz_id' =&gt; $quiz_id);\n    }\n    $query = $database-&gt;prepare($sql);\n    if($arg) {\n        $query-&gt;execute($arg);\n    } else {\n        $query-&gt;execute();\n    }\n    $data = $query-&gt;fetchAll();\n    $data = json_decode(json_encode($data), true);\n    $out = array();\n    foreach($data as $key =&gt; $row) {\n        $out[$row['id']] = $row;\n    }\n    return $out;\n}\n\npublic static function getAnswers()\n{\n    $database = DatabaseFactory::getFactory()-&gt;getConnection();\n    $sql = \"SELECT * FROM choices\";\n    $query = $database-&gt;prepare($sql);\n    $query-&gt;execute();\n    $data = $query-&gt;fetchAll();\n    $data = json_decode(json_encode($data), true);\n    $out = array();\n    foreach($data as $key =&gt; $row) {\n        $out[$row['id']] = $row;\n    }\n    return $out;\n}\n\npublic static function qAndA($quiz_id = false)\n{\n    $questions = Self::getFraga($quiz_id);\n    $answers = Self::getAnswers();\n    $combined  = array();\n    foreach($answers as $answer) {\n        if(!isset($questions[$answer['question_id']])) continue;\n        $q_key = 'question-'.$answer['question_id'];\n        if(!isset($combined[$q_key])) {\n            $combined[$q_key] = $questions[$answer['question_id']];\n        }\n        $combined[$q_key]['answer'][$answer['id']] = $answer;\n    }\n    return $combined;\n}\n\n\nAnd I call the qAndA() to get this result, with json_encode():\n\n{\n  \"question\": {\n    \"question-5\": {\n      \"id\": \"5\",\n      \"content\": \"Har jag laddad upp en bild?\",\n      \"source\": \"99\",\n      \"image_url\": \"156ebc02fd6281_kljqpiohfngme.jpeg\",\n      \"lastmodified\": \"2016-03-18 09:45:35\",\n      \"quiz_id\": \"1\",\n      \"answer\": {\n        \"17\": {\n          \"id\": \"17\",\n          \"content\": \"Nej\",\n          \"correct\": \"1\",\n          \"question_id\": \"5\"\n        },\n        \"18\": {\n          \"id\": \"18\",\n          \"content\": \"ja\",\n          \"correct\": \"0\",\n          \"question_id\": \"5\"\n        },\n        \"19\": {\n          \"id\": \"19\",\n          \"content\": \"kanske\",\n          \"correct\": \"0\",\n          \"question_id\": \"5\"\n        },\n        \"20\": {\n          \"id\": \"20\",\n          \"content\": \"vet inte\",\n          \"correct\": \"0\",\n          \"question_id\": \"5\"\n        }\n      }\n    }\n  }\n}\n\n\nNarrow it down to one function? Other improvements?"], "tags": ["performance", "php", "json"]}
{"texts": ["Find factors of a number", "I am a beginner in C. I have just written this program to find the factors of a provided number \\$n\\$ where \\$1\\leq n \\leq 10^9\\$. However, when I input large numbers (e.g. the maximum, \\$10^9\\$), the program takes a long time to finish finding the larger factors. How do I reduce its time taken? Also, are there any possible improvements for this code?\n\n#include&lt;stdio.h&gt;\nint main(){\n    int a,i;\n    scanf(\"%d\",&amp;a);\n    for(i=1;i&lt;(a/2+1);i++){\n        if(a%i==0){\n            printf(\"%d\\n\",i);\n        }\n    }\n    printf(\"%d\\n\",a);\n    return 0;\n}"], "tags": ["performance", "beginner", "c"]}
{"texts": ["Storing realm objects using Kotlin extensions", "I am a Java Android Developer and I'm approaching Kotlin.\n\nI have defined the following class:\n\nopen class Player : RealmObject() {\n    ...\n}\n\n\nAnd I defined the following two extensions, one for the generic RealmObject class and one for the specific Player class:\n\nfun RealmObject.store() {\n    Realm.getDefaultInstance().use { realm -&gt;\n        realm.beginTransaction()\n        realm.copyToRealmOrUpdate(this)\n        realm.commitTransaction()\n    }\n}\n\nfun Player.store(){\n    this.loggedAt = Date()\n    (this as RealmObject).store()\n}\n\n\nWhat I want is if I call .store() on any RealmObject object, the RelamObject.store() extension will be called BUT if i call .store() on a Player instance the extension that will be called will be Player.store().\n(No problem for now)\nI don't want to copy paste the same code, i love to write less reuse more.\nSo i need that internally the Player.store() will call the generic RealmObject.store()\n\nI got it. The code I wrote up there is actually working as expected :D\n\nIs this the good way? Or there is some better way?"], "tags": ["object-oriented", "android", "extension-methods", "kotlin"]}
{"texts": ["Returning items which are different from their preceding items from a list", "I have a list of tuples (key, value1, value2, ...). I simplify the tuple here so it is only of length 2. Keys contain duplicated figures.\n\nxs = zip([1,2,2,3,3,3,4,1,1,2,2], range(11)) # simple to input\n\n[(1, 0),\n (2, 1),\n (2, 2),\n (3, 3),\n (3, 4),\n (3, 5),\n (4, 6),\n (1, 7),\n (1, 8),\n (2, 9),\n (2, 10)]\n\n\nNow, I would like to build a function, which takes the list as input, and return a list or generator, which is a subset of the original list.\n\nIt must captures all items where the keys are changed, and include the first and last items of the list if they are not already there.\n\nf1(xs) = [(1, 0), (2, 1), (3, 3), (4, 6), (1, 7), (2, 9), (2, 10)]\nf1([]) = []\n\n\nThe following is my code, it works, but I don't really like it:\n\nxs = zip([1,2,2,3,3,3,4,1,1,2,2], range(11))\n\ndef f1(xs):\n    if not xs:\n        return\n    last_a = None # I wish I don't have to use None here.\n    is_yield = False\n    for a, b in xs:\n        if a != last_a:\n            last_a = a\n            is_yield = True\n            yield (a, b)\n        else:\n            is_yield = False\n    if not is_yield:\n        yield (a, b) # Ugly...in C# a, b is not defined here.\n\nprint list(f1(xs))\nprint list(f1([]))\n\n\nWhat's a better (functional or nonfunctional) way of doing this?"], "tags": ["python"]}
{"texts": ["Apply arbitrary action during recursive generator function", "I've got this recursive generator function. It will traverse an object looking for \"leafs\", any keys that don't point to sub-objects.\n\nThen it applies one of two actions on the leaf and yields it.\nAny suggestions for improvement would be appreciated. :)\n\n\r\n\r\nconst obj = {\n  a: 'a',\n  b: 'b',\n  c: {\n    d: 'd',\n    e: 'e',\n  }\n};\n\nconst clone = toClone =&gt; JSON.parse(JSON.stringify(toClone))\n\nfunction* leafIterator(object, action) {\n  for (const key of Object.keys(object)) {\n    if (typeof object[key] === 'object') {\n      for (const inner of leafIterator(object[key], action)) {\n        let oclone = clone(object);\n        oclone[key] = inner;\n        yield oclone;\n      }\n    }\n    else {\n      let oclone = clone(object);\n      action(oclone, key);\n      yield oclone;\n    }\n  }\n}\n\nfor (let o of leafIterator(obj, (s, key) =&gt; delete s[key])) {\n  console.log('result', o);\n}"], "tags": ["javascript", "recursion", "ecmascript-6", "iterator", "callback"]}
{"texts": ["Simple timer checking class", "This is a simple class that runs a timer every 10 seconds to update the title with some information like how long the application has been up, depending on the datetime that is set in another class when the application has finished booting up and is responsive. This application is part of a game server and it just displays how long the server has been up so I know when it was last launched.\n\nIn the future it will also include the number of players connected in the title. it is important to continuously reload it as this is a console application and there isn't really much room anywhere else to display such data.\n\nI'm really not sure about the method name CheckServer but I was feeling very unmotivated at the time, if anyone could think of a better name, be sure to post that too.\n\nI'm looking for basic improvements in overall performance.\n\ninternal sealed class ServerProcessWorker : IDisposable\n{\n    private Timer _serverTimer;\n    private readonly int _timerInterval;\n    private DateTime _lastUpdate;\n    private bool _disposing;\n\n    public ServerProcessWorker()\n    {\n        _timerInterval = 10000;\n    }\n\n    public void Start()\n    {\n        _serverTimer = new System.Threading.Timer(e =&gt; CheckServer(), null, TimeSpan.Zero, TimeSpan.FromMilliseconds(_timerInterval));\n    }\n\n    private void CheckServer()\n    {\n        if ((DateTime.Now - _lastUpdate).TotalMilliseconds &lt;= _timerInterval )\n        {\n            return;\n        }\n\n        var serverUptime = DateTime.Now - Sirius.GetServer().GetServerInformation().ServerStarted;\n\n        var days = serverUptime.Days + \" day\" + (serverUptime.Days != 1 ? \"s\" : \"\") + \", \";\n        var hours = serverUptime.Hours + \" hour\" + (serverUptime.Hours != 1 ? \"s\" : \"\") + \", and \";\n        var minutes = serverUptime.Minutes + \" minute\" + (serverUptime.Minutes != 1 ? \"s\" : \"\");\n        var uptimeString = days + hours + minutes;\n\n        Console.Title = Sirius.GetServer().GetServerInformation().ServerName + \" - Uptime: \" + uptimeString;\n\n        _lastUpdate = DateTime.Now;\n    }\n\n    public void Dispose()\n    {\n        if (_disposing)\n        {\n            return;\n        }\n\n        _disposing = true;\n\n        _serverTimer.Dispose();\n        _serverTimer = null;\n    }\n}"], "tags": ["c#", ".net", "datetime", "timer"]}
{"texts": ["LinkedHashMap as LRU cache", "I have a simple implementation for a LRU cache using LinkedHashMap. \n\n\nI want it to be as generic as   possible. \nThis is not for production use, just practice, so I don't care\nif its thoroughly robust as far as it\nis correct. However, I will welcome\nany comments, especially the ones\nwhich might make this better with\nsimple changes :) \nAre there any other ways of doing this?\n\n\n\n\nclass LRUCache&lt;E&gt; {\n\n    @SuppressWarnings(\"unchecked\")\n    LRUCache(int size)\n    {\n        fCacheSize = size;\n\n        // If the cache is to be used by multiple threads,\n        // the hashMap must be wrapped with code to synchronize \n        fCacheMap = Collections.synchronizedMap\n        (\n            //true = use access order instead of insertion order\n            new LinkedHashMap&lt;Object,E&gt;(fCacheSize, .75F, true)\n            {                                \n                @Override\n                public boolean removeEldestEntry(Map.Entry eldest)  \n                {\n                    //when to remove the eldest entry\n                    return size() &gt; 99 ;   //size exceeded the max allowed\n                }\n            }\n        );\n    }\n\n    public void put(Object key, E elem)\n    {\n        fCacheMap.put(key, elem);\n    }\n\n    public E get(Object key)\n    {\n        return fCacheMap.get(key);\n    }\n\n    private Map&lt;Object,E&gt; fCacheMap;\n    private int fCacheSize;\n}"], "tags": ["java", "cache", "collections"]}
{"texts": ["100 gunmen in circle kill next person", "The question is here.\n\n\n  100 people are standing in a circle with gun in their hands. 1 kills 2, 3 kills 4, 5 kills 6 and so on till we are left with only one person. Who will be the last person alive. Write code to implement this efficiently.\n\n\nHere is my Java implementation:\n\npublic static void main(String[] args) throws Exception {\n    int numberOfGuys = 100;\n    MyObject[] objetList = new MyObject[numberOfGuys];\n    for(int i=1;i&lt;numberOfGuys+1;i++) {\n        objetList[i-1] = new MyObject(i);\n    }\n    boolean oneElementLeft = false;\n    while(!oneElementLeft) {\n\n        for(int i=0;i&lt;objetList.length;i++) {\n            if(i != objetList.length-1 &amp;&amp; (i+1)%2==1) {\n                objetList[i+1]=null;\n            }\n            if(i == objetList.length-1 &amp;&amp; objetList[i] != null) {\n                objetList[0]=null;\n            }\n        }\n        List&lt;MyObject&gt; newList = new ArrayList&lt;MyObject&gt;();\n        for (MyObject myObject:objetList) {\n            if(myObject != null) {\n                newList.add(myObject);\n            }\n        }\n        objetList = new MyObject[newList.size()];\n        for(int i=0;i&lt;newList.size();i++) {\n            objetList[i] = newList.get(i);\n        }\n        if(objetList.length==1) {\n            oneElementLeft = true;\n        }\n    }\n    System.out.println(objetList[0].getIndex());\n}\n\n\nI am not a math guy, so I do not really understand the clever solutions with formulas, recursion etc...\n\nAny review or better code with explanations are welcome."], "tags": ["java", "programming-challenge"]}
{"texts": ["Security feedback sought on Perl code running command on unsafe filename in Unix env", "I'm looking for security feedback on the following fully functional code.\n\nThe code is trying to safely use the Unix 'file' command to give details about the file.\n\nA hard link is used to create a safe filename that can be used in a command line.\n\nThe paramref is a hash read from config, and considered safe. file_base_dir is a directory with only alphanumerics in the name. The 'file' command is the standard one.\n\nWhat ways could my code be exploited?\n\nsub file_details {\n    my ( $self, %arg ) = @_;\n    my $filename = $arg{'filename'};\n    my $paramref = $arg{'paramref'};\n    my $file_cmd = '/usr/bin/file';\n\n    my $safe_filename = $$paramref{'file_base_dir'} . \"/link_to_unsafe_file_file_type_build\";\n\n    # Just in case the link exists.\n    unlink($safe_filename);\n    if ( not link( $filename, $safe_filename ) ) {\n        confess \"Failed to create link $safe_filename to $filename because $!\";\n    }\n\n    my $file_type = `$file_cmd '$safe_filename'`;\n\n    # remove the link\n    unlink($safe_filename);\n    $file_type =~ s/\\A[^:]+://x;\n    chomp $file_type;\n\n    return $file_type;\n} ## end sub file_details"], "tags": ["security", "perl", "unix"]}
{"texts": ["Looking for primes with all-different digits", "I recently answered a question on Mathematics Stack Exchange, where I used a small Python program to check the following :\n\nFor all 6-digit numbers, with all digits being different, choosing the digits one by one from left to right, the second last digit can always be chosen so that the number will never be a prime.\n\nIn a nutshell, I go through all the hundreds and check for each ten if there is at least one prime number. If this is true for all the tens in the hundred, then we check if the rule of all digits are different has been violated.\n\nThere is not much complicated algorithmic involved, but I look for an elegant and fast way to do this.\n\nHere is the code :\n\n# -*- encoding: utf-8 -*-\n\nfrom math import sqrt\nfrom _collections import defaultdict\n\n\ndef is_prime(n):\n\"\"\"checks primality of n\"\"\"\n    if n == 2:\n        return True\n    if n % 2 == 0 or n &lt;= 1:\n        return False\n    sqr = int(sqrt(n)) + 1\n    for divisor in xrange(3, sqr, 2):\n        if n % divisor == 0:\n            return False\n    return True\n\n\ndef has_primes(n):\n\"\"\"checks if there are any primes in [n, n+9]\nwith the last digit different from the others\"\"\"\n    m = n / 10\n    l = [int(i) for i in str(m)]\n    for i in xrange(n + 1, n + 10, 2):\n        if (i % 10 not in l) and is_prime(i):\n            return True\n    return False\n\nif __name__ == '__main__':\n    s = 100000\n    e = 1000000\n    res = list()\n    for h in xrange(s, e, 100):  # hundreds\n        for t in xrange(h, h + 100, 10):  # tens\n            if not has_primes(t):\n                break\n        else:  # every ten has at least one prime\n            l = [int(i) for i in str(h / 100)]\n            d = defaultdict(int)\n            for i in l:  # counting occurrences of each digit\n                d[i] += 1\n            print h\n            for i in d:\n                if d[i] &gt; 1:\n                    print '&gt;', i\n                    break\n            else:\n                res.append(h)\n    print '\\nres :'\n    for n in res:\n        print n\n\n\nI'd like to know how I could improve it. I'm particularly not satisfied with my testing of the doublon digits; it could maybe go only through the numbers with all-different digits. I don't know how to implement this efficiently.\n\nIf you are any other suggestions, they're very welcome. Thank you."], "tags": ["python", "performance", "primes", "hash-map"]}
{"texts": ["What's a better way to decrease cardinality when serializing records", "I need to transfer data from one vendor's system to another.\n\nThe source vendor has a view that generates data that combines invoice and line-item data into records w/ line-item cardinality:\n\n\"Invoice\",\"Date\",\"Line\",\"Description\",\"Price\"\n\"A\",\"2/1/2020\",\"1\",\"something\",\"100\"\n\"A\",\"2/1/2020\",\"2\",\"something else\",\"75\"\n\"B\",\"1/1/2020\",\"1\",\"lorem ipsum\",\"25\"\n\"C\",\"12/15/2020\",\"1\",\"foo bar\",\"10.25\"\n\"C\",\"12/15/2020\",\"2\",\"foo bar\",\"99.99\"\n\n\nThe data needs to be transmitted, however, as a unit that combines the invoice and its line items:\n\n&lt;I&gt;\n  &lt;Invoice&gt;A&lt;/Invoice&gt;\n  &lt;Date&gt;02/01/20&lt;/Date&gt;\n  &lt;Items&gt;\n    &lt;Item&gt;\n      &lt;Line&gt;1&lt;/Line&gt;\n      &lt;Description&gt;something&lt;/Description&gt;\n      &lt;Price&gt;100&lt;/Price&gt;\n    &lt;/Item&gt;\n    &lt;Item&gt;\n     &lt;Line&gt;2&lt;/Line&gt;\n     &lt;Description&gt;something else&lt;/Description&gt;\n     &lt;Price&gt;75&lt;/Price&gt;\n    &lt;/Item&gt;\n  &lt;/Items&gt;\n&lt;/I&gt;\n\n\nTowards this end, I've written the following:\n\n# create testing data\nfunction Get-Data\n{\n    [PSCustomObject]@{\n        Invoice = 'A'\n        Date='2/1/2020'\n        Line=1\n        Description = 'something'\n        Price = 100.0\n    }\n\n    [PSCustomObject]@{\n        Invoice = 'A'\n        Date='2/1/2020'\n        Line=2\n        Description = 'something else'\n        Price = 75.0\n    }\n\n    [PSCustomObject]@{\n        Invoice = 'B'\n        Date='1/1/2020'\n        Line=1\n        Description = 'lorem ipsum'\n        Price = 25.0\n    }\n    [PSCustomObject]@{\n        Invoice = 'C'\n        Date='12/15/2020'\n        Line=1\n        Description = 'foo bar'\n        Price = 10.25\n    }\n    [PSCustomObject]@{\n        Invoice = 'C'\n        Date='12/15/2020'\n        Line=2\n        Description = 'foo bar'\n        Price = 99.99\n    }\n\n}\n\n# serialize related line items\nfunction ConvertTo-LineItemXml {\n    [CmdletBinding()]\n    param (\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [int]$Line,\n\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [string]$Description,\n\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [decimal]$Price\n    )\n    begin {}\n    process\n    {\n        $xml += \"&lt;Item&gt;&lt;Line&gt;$Line&lt;/Line&gt;&lt;Description&gt;$Description&lt;/Description&gt;&lt;Price&gt;$Price&lt;/Price&gt;&lt;/Item&gt;\"\n    }\n    end\n    {\n        $xml\n    }\n}\n\n# convert data to required Xml message and post\nfunction Send-Invoice {\n    [CmdletBinding()]\n    param (\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [string]$Invoice,\n\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [datetime]$Date,\n\n        [Parameter(ValueFromPipelineByPropertyName)]\n        [pscustomobject]$Items\n    )\n\n    begin {}\n    process {\n\n        $xml = \"&lt;I&gt;&lt;Invoice&gt;$Invoice&lt;/Invoice&gt;&lt;Date&gt;$($Date.ToString('MM/dd/yy'))&lt;/Date&gt;&lt;Items&gt;\"\n\n        $xml += $Items | ForEach-Object { \n            $_ | ConvertTo-LineItemXml \n        } \n\n        $xml += '&lt;/Items&gt;&lt;/I&gt;'\n\n        Invoke-WebRequest -Method Post -Uri $Uri -Body $xml -ContentType 'application/xml'\n    }\n    end {}\n}\n\n# controller \nGet-Data | \n    # group by invoice\n    Group-Object {$_.Invoice} |\n        # for each group\n        ForEach-Object {\n\n            # get invoice-specific information from the group's first record\n            $i = $_.Group | Select-Object -First 1 Invoice, Date\n\n            # get the line-item-specific information from the group's records\n            $li = $_.Group | Select-Object Line, Description, Price\n\n            # assign to property\n            $i | Add-Member -MemberType NoteProperty -Name 'Items' -Value $li\n\n            # return structure\n            $i \n\n        } | \nSend-Invoice # format as xml and post\n\n\nI should probably move ConvertTo-LineItemXml from within Send-Invoice to allow the caller to have more control over the processing.\n\nWhat other improvements can I make?"], "tags": ["powershell"]}
{"texts": ["User Confirmation using a Userform Modeless and DoEvents", "Can this be done more efficiently?\n\nThe code does the following: \n\n\nDo Stuff\nShow UserForm and ask user to confirm the shown data is ok\nUser can manipulate and controll excel as usual\nAs soon as user clicks the \"yes\" button \"do some other stuff\" is called\n\n\nThe Module\n\nSub ControlDataUI()\nDim Ui As New UserForm1\nDim IsConfirmed As Boolean\n\nDebug.Print \"dostuff\"\n\nApplication.ScreenUpdating=True\nWith Ui\n    .Show (0)\n    While Not .IsHiden\n        DoEvents\n    Wend\n    If .IsCancelled Then Exit Sub\n    IsConfirmed = .Confirmed\nEnd With\n\nDebug.Print \"Do some more stuff!\"\n\nIf IsConfirmed Then\n    Debug.Print \"SaveStuff\"\nEnd If\n\nDebug.Print \"I will die!!\"\nEnd Sub\n\n\nThe UserForm\n\nPrivate Type TView\n    IsCancelled As Boolean\n    Confirmed As Boolean\n    IsHiden As Boolean\nEnd Type\n\nPrivate this As TView\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = this.IsCancelled\nEnd Property\nPublic Property Get Confirmed() As Boolean\n    Confirmed = this.Confirmed\nEnd Property\nPublic Property Get IsHiden() As Boolean\n    IsHiden = this.IsHiden\nEnd Property\n\nPrivate Sub CommandButton1_Click()\nDebug.Print \"YES!!!!\"\nthis.Confirmed = True\nthis.IsHiden = True\nMe.Hide\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nDebug.Print \"NO?!?!\"\nthis.Confirmed = False\nthis.IsHiden = True\nMe.Hide\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\nthis.IsCancelled = True\nMe.Hide\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\nDebug.Print \"Murder! I was killed!\"\nEnd Sub\n\n\nSo the idea was in the right direction but the while loop had to contain a DoEvents in order to process the events comming from the user.\n\nSummary: \n\n1. Modeless Userform\n\n2. While loop with DoEvents until user confirmes\n\nThis allows for the user controll of the sheet and a confirmation at any time. The code will run after the user confirms the data is ok."], "tags": ["vba"]}
{"texts": ["Slow Filtering Method on DataGrid", "Sometime ago I asked a question regarding a slow Filtering method for my DataGrid. Months later and I have a relatively quick method, though I am still looking to improve performance, especially when the user is deleting text from the SearchBox as this seems to slow down more than if the user is typing characters in.\n\nOnTypingIntoSearchBox\n\nprivate void OnSearchBoxTextChanged(object sender, TextChangedEventArgs e)\n{\n    ApplyFilter();\n}\n\n\nApplyFilter\n\nprivate void ApplyFilter()\n{\n    if (CurrentJobsCollectionView != null)\n    {\n        CurrentJobsCollectionView.Filter = FilterJobs;\n    }\n    UpdateJobCounter();\n}\n\n\nFilterJobs\n\n    private bool FilterJobs(object o)\n    {\n        return FilterByCheckBox(o) &amp;&amp; FilterByJobsSearchBox(o);\n    }\n\n\nFilterByJobsSearchBox\n\nprivate bool FilterByJobsSearchBox(object o)\n{\n    try\n    {\n        var searchText = CharactersOnly(jobsSearchBox.Text);\n        var job = o as JobModel;\n        if (searchText == string.Empty)\n        {\n            return true;\n        }\n        else\n        {\n            if (CompanyContains(job.JobReference, searchText.ToLower()) || \n                CompanyContains(job.CaseClient, searchText.ToLower()) || \n                CompanyContains(job.JobDescription, searchText.ToLower()) ||\n                CompanyContains(job.JobNotes, searchText.ToLower()) ||\n                CompanyContains(job.JobID.ToString(), searchText.ToLower()))\n            {\n                return true;\n            }\n        }\n        return false;\n    }\n    catch (System.Exception ex)\n    {\n        var hEs = new HandleExceptionService();\n        hEs.HandleException(ex.ToString());\n        return false;\n    }\n}\n\n\nFilterByCheckBox\n\nprivate bool FilterByCheckBox(object o)\n{\n    var today = DateTime.Today;\n    criteria.Clear();\n\n    if (yourJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == yourJobsCheckBox.Tag.ToString()));\n    }\n\n    if (adamJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == adamJobsCheckBox.Tag.ToString()));\n    }\n\n    if (chrisJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == chrisJobsCheckBox.Tag.ToString()));\n    }\n\n    if (danJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == danJobsCheckBox.Tag.ToString()));\n    }\n\n    if (emilyJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == emilyJobsCheckBox.Tag.ToString()));\n    }\n\n    if (kitJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == kitJobsCheckBox.Tag.ToString()));\n    }\n\n    if (mattJobsCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == mattJobsCheckBox.Tag.ToString()));\n    }\n\n    if (unallocatedCheckBox.IsChecked == true)\n    {\n        criteria.Add(new Predicate&lt;JobModel&gt;(x =&gt; x.ITName == unallocatedCheckBox.Tag.ToString()));\n    }\n\n    if (_employees.Children.OfType&lt;CheckBox&gt;().All(c =&gt; Convert.ToBoolean(!c.IsChecked))) // If none are checked\n    {\n        currentJobsDataGrid.ItemsSource = null;\n        completedJobsDataGrid.ItemsSource = null;\n        archivedJobsDataGrid.ItemsSource = null;\n    }\n\n    JobModel job = o as JobModel;\n    bool isIn = true;\n    if (criteria.Count() == 0)\n        return isIn;\n    isIn = criteria.Any(x =&gt; x(job));\n    return isIn;\n}\n\n\nI hope that isn't too much code - apologies if it is. I'm essentially looking for anyway to improve the efficiency of this filtering method, either by the user searching through typing in text or by checking specific checkboxes."], "tags": ["c#", "performance", "wpf"]}
{"texts": ["Python: Combing two programs that analyze strings", "I am trying to combine two programs that analyze strings into one program. The result should look at a parent string and determine if a sub-string has an exact match or a \"close\" match within the parent string; if it does it returns the location of this match \n\ni.e. parent: abcdefefefef \nsub cde is exact and returns 2\nsub efe is exact and returns 4, 6, 8\nsub deg is close and returns 3\nsub z has no match and returns None\n\nThe first program I wrote locates exact matches of a sub-string within a parent string:\n\nimport string\n\ndef subStringMatchExact():\n    print \"This program will index the locations a given sequence\"\n    print \"occurs within a larger sequence\"\n    seq = raw_input(\"Please input a sequence to search within: \")\n    sub = raw_input(\"Please input a sequence to search for: \")\n    n = 0\n        for i in range(0,len(seq)):\n        x = string.find(seq, sub, n, len(seq))\n        if x == -1:\n            break\n        print x\n        n = x + 1\n\n\nThe second analyzes whether or not there is an close match within a parent string and returns True if there is, and false if there isn't. Again a close match is an exact match or one that differs by only one character.\n\nimport string\n\ndef similarstrings():\n    print \"This program will determine whether two strings differ\"\n    print \"by more than one character. It will return True when they\"\n    print \"are the same or differ by one character; otherwise it will\"\n    print \"return False\"\n    str1 = raw_input(\"Enter first string:\")\n    str2 = raw_input(\"Enter second string:\")\n    x = 0\n    for i in range(len(str1)):\n        if str1[i] == str2[i]:\n            x = x + 1\n        else:\n            x = x\n    if x &gt;= len(str1) - 1:\n        print True\n    else:\n        print False\n\n\nAny suggestions on how to combine the two would be much appreciated."], "tags": ["python"]}
{"texts": ["Simple but (hopefully) safe C nodes for data structures", "Nodes will be for simply linked lists, circular lists, maybe later on extending them to work with graphs. I'm trying to be as defensive as possible, will this leak memory? It runs perfectly I'm just concerned about coding style and best practices. Especially regarding the allocation I'm not 100% convinced of my solution. Is it okay to allocate memory for the next component inside the constructor? \n\n// I would have preferred to declare the typedef together with the struct, \n// but this doesn't work.\ntypedef struct node Node;   \n\n\nstruct node {\n    int value;\n    Node *next;\n};\n\n\nNode *create_node(int value) {\n\n    Node *result = malloc(sizeof(Node));\n    // How necessary are these checks? Under which circumstances \n    // could this return NULL?\n    if (result == NULL) {           \n        return NULL;\n    }\n\n    result-&gt;next = malloc(sizeof(Node));\n    if (result-&gt;next == NULL) {\n        free(result);\n        return NULL;\n    }\n\n    result-&gt;value = value;\n\n    return result;\n}\n\n\nvoid destroy_node(Node *node) {\n    if (node != NULL) {\n        //This seems necessary. Or is it not? Could I delete the parent \n        // node and keep the children alive?\n        destroy_node(node-&gt;next);   \n        free(node);\n    }\n}\n\nint main() {\n\n    Node *first = create_node(42);\n    printf(\"%d\\n\", first-&gt;value);\n\n    Node *second = create_node(45);\n    first-&gt;next = second;\n    printf(\"%d\\n\", first-&gt;next-&gt;value);\n\n    destroy_node(first);\n\n    return 0;\n}"], "tags": ["c", "linked-list", "memory-management"]}
{"texts": ["Do I need to delete a vector?", "I want to make a graph from input from a text file in the format:\n\nvertex1 vertex2 cost time \n\n\nwhere vertex1 and vertex2 are strings that form an edge and cost and time are the properties of that edge. This information will be used to construct the Graph based on cost. I want to plan out the project before coding it so I have a good idea of what to do. So far I decided on the following classes:\n\nclass Edge {\nprivate:\n  int vertex1;\n  int vertex1;\n  int cost;\n  int time;\n\npublic:\n  Edge(int v1, int v2, int cost, int time) {\n    this-&gt;vertex1 = v1;\n    this-&gt;vertex2 = v2;\n    this-&gt;cost = cost;\n    this-&gt;time = time;\n  }\n\n  ~Edge();\n\n  int getEdgeCost();\n\n  int getEdgeTime();\n};\n\n\nclass Graph {\nprivate:\n  vector&lt;Edges&gt; edge; //edges in graph\n\npublic:\n  Graph() : edge(0) {}\n\n  ~Graph(){}\n\n  int getTotalCost();\n\n  int getTotalTime();\n\n  void addEdge(Edge e);  \n\n  Graph getMinSpanTree();   \n};\n\n\nclass Vertex {\nprivate:\n  string name;\n  int number;\n  bool visited;\n  vector&lt;Edges&gt; connEdges;  // vector of all edges connected to this vertex\n\npublic:\n  Vertex(string name, int number) {\n    this-&gt;name = name;\n    this-&gt;number = number;\n    visited = true;\n  }\n\n  ~Vertex();\n\n  string getName();\n\n  int getNum();\n\n  bool wasVisited();\n\n  Graph getShortestPath();\n};\n\n\n\nint main(int argc, char* argv[]) {\n\n  std::string ifileName = std::string(argv[1]);\n\n  ifstream ifile;\n  if(ifile)\n    ifile.open(ifileName);\n\n  Edge edge;\n  Graph* p_graph;\n  Vertex v;\n\n  string vert1, vert2;\n  int cost, time; \n\n  int i = 1; // numbers each vertex\n\n  while(ifile.good()) {\n  // read in input, put it in vars above, skipped for brevity\n\n  // make the vertices\n  v1 = new Vertex(vert1, i);\n  i++; // increments vertex number\n  v2 = new Vertex(vert2, i);\n  i++;\n\n  // make the edge \n  edge = new Edge(v1.getNum(), v2.getNum(), cost, time);\n\n  // add it to graph\n  p_graph-&gt;addEdge(edge);\n\n}\n\n\nIs my design correct or is it lacking something? Can it be improved?"], "tags": ["c++", "graph"]}
{"texts": ["Avoid while(true) in task scheduling code", "I am writing a task scheduler (that will one day grow up to be a windows service when I look into them) that should pretty much loop infinitely until I tell the program to stop. But having while(true) seems incorrect. What is the correct way to implement the loop? Use a dummy boolean variable that the code doesn't actually set to false ever (or should it set to false in a catch whose try encompasses the whole inside of the loop?)\n\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace DataPump\n{\n    class TaskManager\n    {\n        // Tasks added externally on an instance of TaskManager\n        public Dictionary&lt;DatapumpTask, Task&gt; Tasks = new Dictionary&lt;DatapumpTask, Task&gt;();\n\n        public void Go()\n        {\n            Func&lt;Task, bool&gt; isBusy = task =&gt; task.Status == TaskStatus.Running || \n                                              task.Status == TaskStatus.WaitingToRun || \n                                              task.Status == TaskStatus.WaitingForActivation;\n\n            //Run Loop  --- To Do move off the main thread\n            while (true)\n            {\n                for (int t = 0; t &lt; Tasks.Count; t++)\n                {\n                    KeyValuePair&lt;DatapumpTask, Task&gt; task = Tasks.ElementAt(t);\n\n                    if (task.Key.NextRun &lt; DateTime.Now &amp;&amp; (task.Value == null || !isBusy(task.Value)))\n                    {\n                        Tasks[task.Key] = Task.Factory.StartNew(() =&gt; task.Key.Run());\n                    }\n\n                    if (task.Value != null &amp;&amp; task.Value.IsFaulted)\n                    {\n                        task.Key.Log(\"Task faulted - something is wrong!\" , LogType.Error);\n                        Tasks[task.Key] = null;\n                    }\n                }\n            }\n        }\n\n    }\n\n\nNote DatapumpTask has a public void Run() method, a public void Log() method that logs to a text file and Run() will set its DateTime NextRun property correctly..."], "tags": ["c#", "task-parallel-library"]}
{"texts": ["Project Euler #4 in Haskell", "Project Euler #4 asks:\n\n\n  Find the largest palindrome made from the product of two 3-digit numbers.\n\n\nThe code is as follows:\n\nmodule Main where\n\nimport Data.List (sortBy)\nimport Data.Ord (comparing)\n\npalindromes :: [Integer]\npalindromes = [calcPalindrome a b c | a &lt;- [1..9], b &lt;- [0..9], c &lt;- [0..9]]\n    where\n        calcPalindrome a b c = 100001 * a + 10010 * b + 1100 * c\n\nis3Digit :: Integer -&gt; Bool\nis3Digit n = n &gt;= 100 &amp;&amp; n &lt;= 999\n\nisDiv :: Integer -&gt; Integer -&gt; Bool\nisDiv n d = n `mod` d == 0\n\n-- returns all multiples of 2 3-digit numbers\n-- for palindromes\nisMultiple :: Integer -&gt; Bool\nisMultiple n = not $ null threeMultiples\n    where\n        multiples :: [(Integer, Integer)]\n        multiples = do\n            d &lt;- [10..99]\n            if n `isDiv` (d * 11)\n            then return (d * 11, n `div` (d * 11))\n            else []\n        threeMultiples :: [(Integer, Integer)]\n        threeMultiples = filter (\\ (m, n) -&gt; is3Digit m &amp;&amp; is3Digit n) multiples\n\nproblem4 :: Integer -&gt; Integer\nproblem4 n =\n    head $ filter isMultiple $ sortBy (flip compare) $ filter (&lt; n) palindromes\n\nmain :: IO ()\nmain = do\n    _ &lt;- getLine\n    contents &lt;- getContents\n    let cases = map read $ lines contents\n    let results = map problem4 cases\n    mapM_ print results\n\n\nI'd appreciate comments on isMultiple and problem4 as they seem rather messy. Any other general comments are welcome too."], "tags": ["haskell", "programming-challenge", "palindrome"]}
{"texts": ["Is this a good way to construct the class for a C++ template partial specialisation of a member function?", "I am teaching myself c++ by doing a series of exercises.\nI liked the idea of working out how hash tables could be done using just the language\nand no std calls. I discovered that you cant do\n&quot;class member function partial template specialisation&quot; and so worked on options for\nhow this would be achieved.\nThe code below is a stripped down version of the useful parts of a hash table.\nLeaving just enough to show the structure of what is needed.\nIs there a better way to construct the class - IE a better idiom to solve partial specialisation?\nI have tried full class specialisation and struct partial template specialisation\nbut this seems the best so far.\nI would be interested in comments about other ways to call the members and fuctions.\nI have thought of:\n\nA 'using' line for all the members/function in the fuctions.\nOne 'using' line to create a typedef that can be used as the prefix.\nPutting the full cast at each use.\n\n#include &quot;stdio.h&quot;\n\ntemplate &lt;typename K, typename H&gt;\nclass hash_table_common {\npublic:\n    H&amp; hash_type()                          // Standard CRTP helper function\n    {\n        return static_cast&lt;H&amp;&gt;(*this);\n    }\n    int&amp; operator[](K key)\n    {\n        return hash_type().get_value(key);\n    }\n    size_t hash(int key)\n    {\n        return key % 10;\n    }\n    int m_storage[10]{ 0 };\n};\n\ntemplate &lt;typename K&gt;\nclass hash_table : public hash_table_common&lt;K, hash_table&lt;K&gt;&gt; {\npublic:\n    class hash_table_common&lt;K, hash_table&lt;K&gt;&gt;&amp; hash_type()\n    {\n        return static_cast&lt;hash_table_common&lt;K, hash_table&lt;K&gt;&gt;&amp;&gt;(*this);\n    }\n    int&amp; get_value(K key)\n    {\n        int hashable = 3; // value_to_int(); Real code will go here, for this demo it works for one value!\n        int index1 = hash_type().hash(hashable);\n        return hash_type().m_storage[index1];\n    }\n};\n\ntemplate &lt;&gt;\nclass hash_table&lt;const char*&gt; : public hash_table_common&lt;const char*, hash_table&lt;const char*&gt;&gt; {\npublic:\n    class hash_table_common&lt;const char*, hash_table&lt;const char*&gt;&gt;&amp; hash_type()\n    {\n        return static_cast&lt;hash_table_common&lt;const char*, hash_table&lt;const char*&gt;&gt;&amp;&gt;(*this);\n    }\n    int&amp; get_value(const char* key)\n    {\n        int hash_as_int = (int)key[0];\n        int index = hash_type().hash(hash_as_int);\n        return hash_type().m_storage[index];\n    }\n};\n#endif\n\nint main() {\n    class hash_table&lt;const char*&gt; a;\n    class hash_table&lt;float&gt; b;\n    a[&quot;word&quot;] = 3;\n    b[4.5f] = 14;\n    printf(&quot;%d %d&quot;, a[&quot;word&quot;], b[4.5f]);\n    return 0;\n}"], "tags": ["c++", "hash-map", "template", "classes"]}
{"texts": ["Multithreading correctly done?", "I rarely write multithreaded code, and am on shaky ground when doing so.  I make mistakes.  I would like a sanity check of something I am going to introduce in one of my apps.\n\nThere will be exactly one running instance of the Thread class below in my application.  (It will be stored in a servlet context attribute.)  \"Clients\" will call one of three methods on the instance, getRunList() to get data from it, signalFreshRunListCreation() to tell the thread to generate new data, and stopThread() to signal the thread to exit.  On its own, the thread creates new data every 30 seconds.\n\nHave I made any errors?  \n\n\npublic class ThreadRunListDefault extends Thread {\n\n    // This set to true signals that the thread should exit.\n    private boolean _boStop = false;\n    // The thread sets this to true just before it sleeps.\n    private boolean _boIsSleeping = false;\n    // An external client sets this to true to signal that a new run list should  be created.\n    private boolean _boFreshRunListRequested = false;\n    // This is a mutex to lock the run list while a fresh one is being created.\n    private Object _lockRunList = new Object();\n    // This is the actual data that will be returned.\n    private List&lt;BeanRunOutput> _runList;\n    // This is the time the thread will sleep between refreshing the data on its own\n    private long _iSleepMilliseconds = 30000;\n\n    @Override\n    public void run() {\n\n        // Loop as long as no client has indicated the thread should stop. \n        while (!_boStop) {\n            // Create the data.\n            this.createFreshRunList();\n\n            // Only sleep if a refresh of the data wasn't requested while we were \n            // creating a fresh run list.\n            if (!_boFreshRunListRequested) {\n                try {\n                    // We set the sleeping flag to true so that signalFreshRunListCreation() will \n                    // know whether or not to call interrupt() on the thread and wake it up.\n                    _boIsSleeping = true;\n                    Thread.sleep(_iSleepMilliseconds);\n                } catch (InterruptedException e) { }\n                _boIsSleeping = false;\n            } \n        }\n    }\n\n    /*\n     * This is the method that will be called by run() to create new data in the _runList member variable.\n     */\n    private void createFreshRunList() {\n        synchronized(this._lockRunList) {\n            // Here we put the code that creates the run list.  \n            // Typically it will take 5 to 10 seconds.\n            _runList = new ArrayList&lt;BeanRunOutput>();\n        }\n    }\n\n    /*\n     * This is the method a client will call to get the data in _runList.\n     */\n    public List&lt;BeanRunOutput> getRunList() {\n        synchronized(this._lockRunList) {\n            return _runList;\n        }\n    }\n\n    /*\n     * This is the method a client will call to signal the thread that a new run list should be created.\n     * If run() is currently gathering data (_boIsSleeping is false), a flag will be set to tell run() \n     * to run again immediately after it is finished, without sleeping first.  If the thread is currently\n     * sleeping, it will be interrupted. \n     */\n    public void signalFreshRunListCreation() {\n        if (_boIsSleeping) {\n            // Thread is sleeping so interrupt it.\n            this.interrupt();\n        } else {\n            // The thread is running so signal it should just run again when \n            // complete (in other words not sleep).\n            _boFreshRunListRequested = true;\n        }\n    }\n\n    /*\n     * This method allows a client to signal the thread to exit.\n    */\n    public void stopThread() {\n        _boStop = true;\n    }\n}"], "tags": ["java", "multithreading", "thread-safety"]}
{"texts": ["PHP creating username with random number", "Trying to complete an add user script. Nothing out of the ordinary, however I have transitioned over to using prepared statements, and I am trying to get better at creating my own functions.\n\n&lt;?php\ninclude(\"../include/sessions.php\");\n\nif(isset($_POST['criteria']))\n{\n  $value = $_POST['criteria'];\n  $firstname = htmlspecialchars(trim($value['firstname']));\n  $lastname = htmlspecialchars(trim($value['lastname']));\n  // few more\n\n  // set blank variable to be passed into function\n  $dbusername = ''; \n\n  // pass necessary variables into the function\n  // $dbc is the database connection needed for the prepared statement\n  function createUsername($firstname, $lastname, $dbusername, $dbc)\n  {\n    // check if $user ever matches $dbusername, if so, rerun loop\n    while($user == $dbusername) \n    {\n      $digits = 4;\n      $randomNumber = rand(pow(10, $digits-1), pow(10, $digits)-1);\n      // get first 3 letters of firstname\n      $first3 = substr($firstname, 0, 3); \n      // get first 3 letters of lastname\n      $last3 = substr($lastname, 0, 3); \n      // set user to $first3, $last3, and $randomNumber\n      $user = $first3 . '' . $last3 . '' . $randomNumber;   \n\n      // prepare statement\n      $select = \"SELECT username FROM users WHERE username = ?;\";        \n      $stmt = $dbc-&gt;prepare($select);\n\n      // pass in the new $user\n      $stmt-&gt;bind_param(\"s\", $user);\n      $stmt-&gt;execute();\n      $result = $stmt-&gt;get_result();\n      $row = $result-&gt;fetch_assoc();    \n\n      // if the created user happens to exist in the database, set it to $dbusername\n      $dbusername = $row['username'];   \n      // rerun the loop if this happens\n    }\n    // if no matches, return the new username\n    return $user;\n  }\n}\n\n$user = createUsername($firstname, $lastname, $dbusername, $dbc);\n\necho 'username is ' . $user; // username should look like this: johbea3647\n?&gt;\n\n\nI tried to notate the code as much as possible. But just in case, I'll break it down here...\n\nThe idea is to take create a brand new username that begins with the first 3 letters of the first and last name, then add a random 4 digit number to the end.\n\nHopefully, as long as the seemingly random username does not exist in the database, then return the new username. However, in the event the random username happens to exist, then run the loop again until there is no match.\n\nI hope this all makes sense. Please review my code and see if there are any problems, or if there is a way to possibly simplify it all.\n\nSo far, everything seems to work. I'm just not too sure about that while loop."], "tags": ["php"]}
{"texts": ["C# Function: IsAvailable(T value)", "I'm sick of writing negative code statements like String.IsNullOrEmpty(value) and so I'm writing a function that checks for availability. It should answer the question, \"Is this value usable?\" without validating the data.\n\nThis function has been exceptionally difficult to write but I have a solution I feel comfortable with using. I'm hoping someone can poke holes in it and give me constructive feedback.\n\npublic static bool IsAvailable&lt;T&gt;(T value)\n{\n    if (value == null)\n        return false;\n\n    var type = typeof(T);\n    if (type.IsValueType)\n        return true;\n\n    if (typeof(IEnumerable).IsAssignableFrom(type))\n    {\n        var enumerator = (value as IEnumerable).Cast&lt;object&gt;();\n        return enumerator.Any(a =&gt; IsAvailable(a));\n    }\n\n    var valueString = Convert.ToString(value);\n    return !String.IsNullOrWhiteSpace(valueString);\n}"], "tags": ["c#", "generics", "null"]}
{"texts": ["Machine independent C library for printing the binary representation of data types to stdout", "I'm curious as to peoples thoughts on this small library I have made. I noticed there are no functions in the C standard library to accomplish this task. \n\nI have tried to make the code machine independent. If anyone has access to machines where short != 2 byte, int != 4 byte, long != 8 byte or where bytes themselves are not 8 bits. I would be curious as to the test results.\n\nGitHub\n\nThe current functions for printing the binary representations are all slight modifications of the below:\n\n#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid printcb(char n)\n{\n    int i;\n    int type_bits = CHAR_BIT;\n    int mask = 1 &lt;&lt; type_bits - 1;\n\n    for (i = 0; i &lt; type_bits; ++i) {\n        if (n &amp; mask)\n            putc('1', stdout);\n        else\n            putc('0', stdout);\n        n &lt;&lt;= 1;\n    }\n    putc('\\n', stdout);\n}"], "tags": ["c"]}
{"texts": ["Repeatedly fetching a URL until the response contains \"state: INIT\"", "I am working on a project in which I need to make a URL call to one of my servers from a bash shell script.\n\n http://hostname.domain.com:8080/beat\n\n\nAfter hitting the above URL, I will be getting the below response, from which I need to parse and extract the value of state:\n\nnum_retries_allowed: 3 count: 30 count_behind: 100 state: INIT num_rounds: 60 hour_col: 2 day_col: 0\n\n\nNow I will keep on hitting the above URL every 10 seconds until the value of the state variable is equal to INIT:\n\nstate = INIT\n\n\nIf the state is equal to INIT then I will exit successfully out of the shell script, otherwise I will keep on trying until the state becomes INIT. \n\nAlso, if the state: string is missing in the $DATA variable by any chance, then I want to assign 0 to the state variable. So if state is equal to 0, then I will also exit out of the shell script successfully.\n\nI am hitting the above URL and checking whether I got a successful response or not. If I got a successful response, then I am breaking out (which means server is running fine), but if I didn't got successful response, then I am checking whether my server is running or not on port 8080. If it is not running, then I will start the server. And I am retrying this for a period of 15 times, and after 15 tries if the server hasn't come back up, then exit out of the shell script with a non-zero status code.\n\nIs the below shell script correct?\n\n#!/bin/bash\n\nHOSTNAME=$hostname\nDATA=\"\"\nRETRY=15\n\necho $HOSTNAME\n\nsleep 1m\n\nwhile true; do\n\n    while [ $RETRY -gt 0 ]\n    do\n        DATA=$(wget -O - -q -t 1 http://$HOSTNAME:8080/beat)\n        if [ $? -eq 0 ]\n        then\n            break\n        else\n            if lsof -Pi :8080 -sTCP:LISTEN -t &gt;/dev/null ;\n            then\n                echo \"Server is running\"\n            else\n                echo \"Server is not running so re-starting the server here\"\n                # starting server here\n            fi\n            let RETRY-=1\n            sleep 30\n        fi\n    done\n\n    if [ $RETRY -eq 0 ]\n    then\n        echo \"Server is still down. Exiting out now.\" &gt;&amp;2\n        exit 2\n    fi\n\n    echo \"Server is up. Now parsing the data out of the beat.\"\n\n    #grep $DATA for state\n    state=$(grep -oP 'state: \\K\\S+' &lt;&lt;&lt; \"$DATA\")\n    [[ -z \"$state\" ]] &amp;&amp; state=0\n\n    echo $state\n\n    #verify the condiitons\n    if [[ $state -eq \"INIT\" || $state -eq \"0\" ]]; then exit 0; fi\n\n    #wait another 10 seconds\n    sleep 10\n\ndone\n\n\nIs there any better way of doing this if I am doing anything wrong?"], "tags": ["regex", "bash", "http", "linux", "shell"]}
{"texts": ["Find-grep-sed for project-wide search & replace", "I always forget how to do this efficiently with Vim's arglist. Drawing inspiration from a post over at Stack Overflow, I wrote a Bash function to perform a project-wide search &amp; replace.\n\nIt does the following:\n\n\nfind files matching a file-pattern\nnarrow down to those files containing a search-pattern\nwithin those files, replace all occurrences of the search-pattern\n\n\nExample usage: greplace **.rb old_method new_method\n\ngreplace() {\n  if [ \"${#}\" != 3 ]; then\n    echo \"Usage: greplace file_pattern search_pattern replacement\"\n    return 1\n  else\n    file_pattern=$1\n    search_pattern=$2\n    replacement=$3\n\n    find . -name \"${file_pattern}\" |\n    xargs grep -rwl \"${search_pattern}\" |\n    xargs sed -i '' \"s/[[:&lt;:]]${search_pattern}[[:&gt;:]]/${replacement}/g\"\n  fi\n}\n\n\nI'm on OSX, so unfortunately I had to use the ugly (and I assume non-portable) [[:&lt;:]] word-boundaries for sed. I tried \\b and \\&lt;, with and without -E (for extended regular expressions), but still no dice.\n\nI also debated whether to bake the word-boundaries in or leave them up to the caller (my poor little fingers). But I can't imagine wanting use this without word boundaries. I'd much rather miss a replacement because it's a variation on the search term than accidentally mangle a word happens to contain the search term.\n\nAnother potential issue is the fact that I'm using sed -i '' to perform the in-place replacements without making any backup files. This seems fine for my use, since I'm invariably using Git for version control. I'm curious how big a risk this is though.\n\nUpdate Props to janos for his pointers and improvements. Here's an updated version:\n\ngreplace() {\n  if [ \"$#\" != 3 ]; then\n    echo \"Usage: greplace file_pattern search_pattern replacement\"\n    return 1\n  else\n    file_pattern=$1\n    search_pattern=$2\n    replacement=$3\n\n    # This works with BSD grep and the sed bundled with OS X.\n    # GNU grep takes `-Z` instead of `--null`.\n    # Other versions of sed may not support the `-i ''` syntax.\n\n    find . -name \"$file_pattern\" -exec grep -lw --null \"$search_pattern\" {} + |\n    xargs -0 sed -i '' \"s/[[:&lt;:]]$search_pattern[[:&gt;:]]/$replacement/g\"\n  fi\n}"], "tags": ["bash", "unix", "sed"]}
{"texts": ["Reverse string by separator", "Here is problem:\nThere is string (domain) divided by dots (like www.part1.partN.com)\nNeed to build reversed by dot string (like com.partN.part1.www)\nBoth strings are utf-8 encoded  \n\nMy solution:\n\nstd::string reverseHost(const std::string&amp; host)\n{\n    std::string ret;\n    ret.reserve(host.size());\n\n    size_t tail = host.size();\n    size_t head = host.find_last_of('.');\n\n    while (head != std::string::npos)\n    {\n        ret.append(host.c_str() + head + 1, tail - head - 1);\n        ret += '.';\n\n        tail = head;\n        head = host.find_last_of('.', tail - 1);\n    }\n\n    ret.append(host.c_str(), tail);\n\n    return ret;\n}\n\n\nNeed to improve speed (or advice how to improve), raw memory and other tricks allowed. ty."], "tags": ["c++", "strings"]}
{"texts": ["Obtaining prediction bands for regression model", "I'm trying to generate prediction bands for an exponential fit to some 2-dimensional data (available here).\n\nThe data (blue points), best fit found by scipy.optimize.curve_fit (red curve), and lower &amp; upper 95% prediction bands (green curves) can be seen in the image below.\n\n\n\nI'd love some confirmation that the code is actually doing things correctly and I haven't missed some step or simply used the wrong statistical tools.\n\nThe references I used are basically this post, and this video, both adapted to work with a general function, rather than being hardcoded to work with a linear function of the form \\$y = a*x+b\\$.\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.optimize import curve_fit\nfrom scipy import stats\n\n\ndef make_plot(x, xd, yd, popt, upb, lpb):\n    # Plot data.\n    plt.scatter(xd, yd)\n    # Plot best fit curve.\n    plt.plot(x, func(x, *popt), c='r')\n    # Prediction band (upper)\n    plt.plot(x, upb, c='g')\n    # Prediction band (lower)\n    plt.plot(x, lpb, c='g')\n    plt.show()\n\n\ndef func(x, a, b, c):\n    '''Exponential 3-param function.'''\n    return a * np.exp(b * x) + c\n\n\ndef predband(x, xd, yd, f_vars, conf=0.95):\n    \"\"\"\n    Code adapted from Rodrigo Nemmen's post:\n    http://astropython.blogspot.com.ar/2011/12/calculating-prediction-band-\n    of-linear.html\n\n    Calculates the prediction band of the regression model at the\n    desired confidence level.\n\n    Clarification of the difference between confidence and prediction bands:\n\n    \"The prediction bands are further from the best-fit line than the\n    confidence bands, a lot further if you have many data points. The 95%\n    prediction band is the area in which you expect 95% of all data points\n    to fall. In contrast, the 95% confidence band is the area that has a\n    95% chance of containing the true regression line.\"\n    (from http://www.graphpad.com/guides/prism/6/curve-fitting/index.htm?\n    reg_graphing_tips_linear_regressio.htm)\n\n    Arguments:\n    - x: array with x values to calculate the confidence band.\n    - xd, yd: data arrays.\n    - a, b, c: linear fit parameters.\n    - conf: desired confidence level, by default 0.95 (2 sigma)\n\n    References:\n    1. http://www.JerryDallal.com/LHSP/slr.htm, Introduction to Simple Linear\n    Regression, Gerard E. Dallal, Ph.D.\n    \"\"\"\n\n    alpha = 1. - conf    # Significance\n    N = xd.size          # data sample size\n    var_n = len(f_vars)  # Number of variables used by the fitted function.\n\n    # Quantile of Student's t distribution for p=(1 - alpha/2)\n    q = stats.t.ppf(1. - alpha / 2., N - var_n)\n\n    # Std. deviation of an individual measurement (Bevington, eq. 6.15)\n    se = np.sqrt(1. / (N - var_n) * np.sum((yd - func(xd, *f_vars)) ** 2))\n\n    # Auxiliary definitions\n    sx = (x - xd.mean()) ** 2\n    sxd = np.sum((xd - xd.mean()) ** 2)\n\n    # Predicted values (best-fit model)\n    yp = func(x, *f_vars)\n    # Prediction band\n    dy = q * se * np.sqrt(1. + (1. / N) + (sx / sxd))\n\n    # Upper &amp; lower prediction bands.\n    lpb, upb = yp - dy, yp + dy\n\n    return lpb, upb\n\n\n# Read data from file.\nxd, yd = np.loadtxt('exponential_data.dat', unpack=True)\n\n# Find best fit of data with 3-parameters exponential function.\npopt, pcov = curve_fit(func, xd, yd)\n\n# Generate equi-spaced x values.\nx = np.linspace(xd.min(), xd.max(), 100)\n\n# Call function to generate lower an upper prediction bands.\nlpb, upb = predband(x, xd, yd, popt, conf=0.95)\n\n# Plot.\nmake_plot(x, xd, yd, popt, upb, lpb)"], "tags": ["python", "statistics", "scipy"]}
{"texts": ["Python Code for List of Month Names starting with current month", "I am looking for a cleaner, more pythonic way to get a list of the name of the months starting with the current month and ending 12 months later.\n\nFor example, it's December so my list should be \n\n['Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov']\n\n\nHere is how I'm currently doing it:\n\nfrom datetime import datetime\n\ncurrentMonth = datetime.now().month\n\nif (currentMonth == 1):\n    theList = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\nelif (currentMonth == 2):\n    theList = ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan']\nelif (currentMonth == 3):\n    theList = ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb']\nelif (currentMonth == 4):\n    theList = ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar']\nelif (currentMonth == 5):\n    theList = ['May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr']\nelif (currentMonth == 6):\n    theList = ['Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May']\nelif (currentMonth == 7):\n    theList = ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']\nelif (currentMonth == 8):\n    theList = ['Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul']\nelif (currentMonth == 9):\n    theList = ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug']\nelif (currentMonth == 10):\n    theList = ['Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep']\nelif (currentMonth == 11):\n    theList = ['Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct']\nelif (currentMonth == 12):\n    theList = ['Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov']\n\nprint(theList)\n\n\nIdeas?"], "tags": ["python", "python-3.x", "datetime"]}
{"texts": ["Finding pairs of numbers within A that add up to N", "I am working on an interview question from Amazon Software Interview:\n\n\n  Given an integer N and an array of unsorted integers A find all pairs of numbers within A which add up to N\n\n\nI have a working solution in Java:\n\nstatic void allPairsAddToN(int[] array, int n) {\n    for(int c=0;c&lt;array.length; c ++) {\n        for(int j=c+1; j&lt;array.length; j++) {\n            if(array[c] + array[j] == n)\n                System.out.println(\"(\" + array[c] +\", \" + array[j] +\")\" );\n        }\n    }\n}\n\n\nIs this the most efficient solution? To me, this is the brute force approach that runs in \\$O(n^2)\\$. But for this problem, wouldn't you have to try every possibility (unsorted)? Is there some trick where you don't?"], "tags": ["java", "algorithm", "array", "interview-questions", "complexity"]}
{"texts": ["Python abilities on strings", "the Encoding scheme is given below:\n  \n  Don't replace the characters in the even places. Replace the characters in the odd places by their place numbers . and if they exceed 'z', then again they will start from 'a'.\n  \n  example: for a message \"hello\" would be \"ieolt\" and for message \"maya\" would be \"naba\"\n  \n  how many lines of code [minimum] do we have to write in order to encode a lengthy string in python in the above format.?\n\n\nmycode is given below:\n\ndef encode(msg):\n    encoded_message = \"\"\n    letters = \"abcdefghijklmnopqrstuvwxyz\"\n    index_of_msg = 0\n    for char in msg.lower():\n        if char.isalpha():\n            if index_of_msg%2 == 0 :          \n                encoded_message += letters[((letters.rfind(char) )+ (index_of_msg+1))%26]  # changed msg.rfind(char) to index_of_msg\n            else:\n                encoded_message += char\n        else:\n            encoded_message += char\n        index_of_msg +=1\n    return encoded_message"], "tags": ["python", "strings"]}
{"texts": ["Ensure that all `h2` tags have a `span` inserted", "I'm running these on page load to ensure that all h2 tags have a span inserted (it's a large WordPress site that needs to have this done to get the right styles)\n\n$('.bottomLine').each(function() {\n    $(this).insertAfter($(this).parent().find('.price'));\n});\n$('.prod-desc &gt; h2').each(function() {\n    $(this).wrapInner('&lt;span /&gt;');\n})\n$('h2.review_text').each(function() {\n    $(this).wrapInner('&lt;span /&gt;');\n})\n$('.related &gt; h2').each(function() {\n    $(this).wrapInner('&lt;span /&gt;');\n})\n$('.up-sells &gt; h2').each(function() {\n    $(this).wrapInner('&lt;span /&gt;');\n})\n\n\nEDIT\n\nI'm kinda getting the message that this is a bad idea so I will expand upon why I think I need to. \n\nI need to create this out of h2 tags. \n\n\n\nWhich I currently make using:\n\n&lt;div class=\"seporator\"&gt;\n  &lt;span&gt;Join us on instgram&lt;/span&gt;\n&lt;/div&gt;\n\n\nand SCSS\n\n.seporator {\n  text-align: center;\n  text-transform: uppercase;\n  padding: 40px 40px 46px;\n  width: 100%;\n\n  span {\n    padding-bottom: 10px;\n    border-bottom: 1px solid $red;\n    line-height: 48px;\n    margin-bottom: 10px;\n  }\n}\n\n\nThroughout the WordPress site I see that the previous theme has been using a CSS hook to style h2 elements within the page as breaks. Therefore when I perform the insertion of a &lt;span&gt; and add h2 to my scss I get the design. \n\n  h2 {\n    @extend .seporator;\n    font-size: 1.5rem;\n  }\n\n\nIf this underlined, correctly spaced design can be achieved using purely h2 tags then I would love to hear about it."], "tags": ["javascript", "jquery", "dom", "wordpress"]}
{"texts": ["BouncyCastle RSA Implementation", "This is my implementation of 1024bit(can be changed) RSA. Is there anything I'm doing wrong?\n\npublic class Rsa:IEncryption\n{\n    public AsymmetricCipherKeyPair Keys { get;private set; }\n\n    private readonly Pkcs1Encoding _engine;\n\n    public Rsa()\n    {\n        Keys = GenerateKeys();\n        _engine = new Pkcs1Encoding(new RsaEngine());\n    }\n\n    public byte[] Encrypt(byte[] buffer)\n    {\n        return Encrypt(buffer, 0, buffer.Length);\n    }\n\n    public byte[] Decrypt(byte[] buffer)\n    {\n        return Decrypt(buffer, 0, buffer.Length);\n    }\n\n    public byte[] Encrypt(byte[] buffer, int offSet, int length)\n    {\n        return RsaProcessor(buffer, offSet, length, Keys.Public);\n    }\n\n    public byte[] Decrypt(byte[] buffer, int offSet, int length)\n    {\n        return RsaProcessor(buffer, offSet, length,Keys.Private);\n    }\n\n    private byte[] RsaProcessor(byte[] data,int offset,int length, AsymmetricKeyParameter key)\n    {\n        _engine.Init(!key.IsPrivate, key);\n\n        var blockSize = _engine.GetInputBlockSize();\n\n        var result = new List&lt;byte&gt;();\n        for (var i = offset; i &lt; offset+length; i += blockSize)\n        {\n            var currentSize = Math.Min(blockSize, offset + length - i);\n            result.AddRange(_engine.ProcessBlock(data, i, currentSize));\n        }\n        return result.ToArray();\n    }\n\n    public static AsymmetricCipherKeyPair GenerateKeys()\n    {\n        var rsaKeyParams = new RsaKeyGenerationParameters(BigInteger.ProbablePrime(512, new Random()),\n                                                          new SecureRandom(), 1024, 25); //Unsure about the certinaty parameter\n        var keyGen = new RsaKeyPairGenerator();\n        keyGen.Init(rsaKeyParams);\n\n        return keyGen.GenerateKeyPair();\n    }\n}"], "tags": ["c#", "cryptography"]}
{"texts": ["Java Doubly Linked List Implementation", "I recently submitted an implementation of a singly linked list and tried to apply some of the suggestions on this implementation. I decided not to implement the List interface as I only wanted to practice what I believed to be the most important methods. I'm wondering how I could tidy this up some more and improve upon it.\n\nSingly Linked List: Java Singly Linked List Implementation\n\nDoublyLinkedList.java\n\npublic class DoublyLinkedList&lt;T&gt; {\n\n    private class Node {\n\n        private T data;\n        Node next, prev;\n\n        public Node() {\n        }\n\n        public Node(T data) {\n            this.data = data;\n        }\n    }\n\n    private Node head, last;\n    private int size;\n\n    public DoublyLinkedList() {\n        this.size = 0;\n    }\n\n    public void addToBeginning(T data) {\n        Node temp = new Node(data);\n        if (head == null) {\n            head = temp;\n            last = head;\n        } else {\n            temp.next = head;\n            head.prev = temp;\n            head = temp;\n        }\n        size++;\n    }\n\n    public void add(T data) {\n        Node temp = new Node(data);\n        if (head == null) {\n            head = temp;\n            last = head;\n        } else {\n            last.next = temp;\n            temp.prev = last;\n            last = temp;\n        }\n        size++;\n    }\n\n    public void add(T data, int index) {\n        Node temp = new Node(data);\n        if (index &lt; 0 || index &gt; size) {\n            throw new IndexOutOfBoundsException();\n        } else if (index == 0) {\n            addToBeginning(data);\n        } else if (index == size) {\n            add(data);\n        } else {\n            Node current = head;\n            for (int i = 0; i &lt; index; i++) {\n                current = current.next;\n            }\n            Node previous = current.prev;\n            previous.next = temp;\n            temp.prev = previous;\n            temp.next = current;\n            current.prev = temp;\n            size++;\n        }\n    }\n\n    public T get(int index) {\n        if (index &lt; 0 || index &gt;= size) {\n            throw new IndexOutOfBoundsException();\n        } else {\n            Node current = head;\n            for (int i = 0; i &lt; index; i++) {\n                current = current.next;\n            }\n            return current.data;\n        }\n    }\n\n    public void delete(int index) {\n        if (index &lt; 0 || index &gt;= size) {\n            throw new IndexOutOfBoundsException();\n        } else if (index == 0) {\n            head = head.next;\n            head.prev = null;\n            size--;\n        } else if (index == size - 1) {\n            last = last.prev;\n            last.next = null;\n            size--;\n        } else {\n            Node current = head;\n            for (int i = 0; i &lt; index; i++) {\n                current = current.next;\n            }\n            Node previous = current.prev;\n            Node next = current.next;\n            previous.next = current.next;\n            next.prev = previous;\n            size--;\n        }\n    }\n\n    public int getSize() {\n        return size;\n    }\n\n    public boolean isEmpty() {\n        return size == 0;\n    }\n}"], "tags": ["java", "linked-list"]}
{"texts": ["String representation of a polynomial", "We all know that math notation is idiosyncratic. Canonical representation of math objects often have irregular grammar rules to improve readability. For example we write a polynomial \\$3x^3 + x^2\\$ instead of more uniform but more verbose \\$3x^3 + 1x^2 + 0x^1 + 0x^0\\$. When a coefficient equals 0, you don't write the term, if the power equals \\$1\\$, you simply write \\$x\\$, and so on. So I wrote a simple program that outputs a string representation of a polynomial, given a list of coefficients:\n\ndef enumerate2(xs, start=0, step=1):\n    for x in xs:\n        yield (start, x)\n        start += step\n\ndef poly(xs):\n    \"\"\"Return string representation of a polynomial.\n\n    &gt;&gt;&gt; poly([2,1,0])\n    \"2x^2 + x\"\n    \"\"\"\n    res = []\n    for e, x in enumerate2(xs, len(xs)-1, -1):\n\n        variable = 'x'\n\n        if x == 1:\n            coefficient = ''\n        elif x == -1:\n            coefficient = '-'\n        else:\n            coefficient = str(x)\n\n        if e == 1:\n            power = ''\n        elif e == 0:\n            power = ''\n            variable = ''\n        else:\n            power = '^' + str(e)\n\n        if x &lt; 0:\n            coefficient = '(' + coefficient\n            power = power + ')'\n\n        if x != 0:\n            res.append(coefficient + variable + power)\n\n    return ' + '.join(res)\n\n\nenumerate2 is a custom version of enumerate that supports variable step. The result looks like this:\n\n&gt;&gt;&gt; poly([2,0,3,-4,-3,2,0,1,10])\n'2x^8 + 3x^6 + (-4x^5) + (-3x^4) + 2x^3 + x + 10'\n\n\nHow do I make this code more elegant and probably more generic? Oh, and the result is sub-optimal, as negative terms are enclosed in brackets, instead of changing the preceding plus sign to minus."], "tags": ["python", "formatting", "symbolic-math"]}
{"texts": ["Does the class have unnecessary and violating Single responsibility principle method?", "I encountered with the following code in the work. The MyItemCoordinator should receive MyItem objects, process them, add them to MyItemList collection and then pass them to the listeners.\n\nMy questions are:\n\n\nWhen I saw NewMyItem method I thought that MyItemCoordinator is a factory but when I saw NewMyItem's implementation I found out that it creates, sorts, calling to listeners and it's not static. So MyItemCoordinator is not a factory and NewMyItem method does way more things that it should to do according to its name, right?\nIf it's not a factory so why NewMyItem method receives so many params, creates an object, adds to the collection? Why not to do:\n\nexample:\n\nvar coordinator = new MyItemCoordinator();\nvar myItem = new MyItem(...PARAMS..)\ncoordinator.AddMyItemToList(myItem)\n\n\nInside AddMyItemToList we can sort and call the listeners. This is more clear way to do, isn't it?\nSo, is this implementation correct? Doesn't it have something wrong?\n\npublic class MyItemCoordinator\n{    \n    ...\n\n    public IList&lt;MyItem&gt; MyItemList = new List&lt;MyItem&gt;();\n\n    public void NewMyItem(int id, ...15_MORE_PARAMS)\n    {\n        MyItem myItem = new MyItem(id,...ONLY_5_PARAMS_WITHIN_15_ARE_USED);\n        AddMyItemToList(myItem);\n        SortMyItemList();\n        if (MyItemDetectedHandler != null)\n            MyItemDetectedHandler(this);\n    }\n\n    public void AddMyItemToList(MyItem myItem)\n    {\n        //makes some checking and adds myItem to MyItemList\n    }\n\n    ...\n}"], "tags": ["c#", "collections", "factory-method"]}
{"texts": ["Printing every digit of a number", "Which of these three methods is better?\n\nimport java.util.* ;    \npublic class anycode{\n\n  public static void print_digits3(int num){\n    //this method converts integer to string and parses it\n    int digit = 0 ;\n    String num_str = new Integer(num).toString() ;\n    int counter = 0  ;\n    while(counter != num_str.length()){\n       System.out.println(\"digit: \" + num_str.charAt(counter)  + \"| real integer digit: \" + Integer.parseInt(num_str.substring(counter,counter+1))) ;\n      counter++ ;\n    }\n\n  }\n\n  public static void print_digits4(int num){\n    //this method converts integer to array of chars and parses it\n     char[]num_sequence_of_chars = new Integer(num).toString().toCharArray() ;\n     for(int i = 0 ; i &lt; num_sequence_of_chars.length ; i++){\n       System.out.println(\"digit :\" + num_sequence_of_chars[i] ) ;    \n     }\n  }\n  public static void print_digits2(int num){\n    //this is the MATH method of parsing number - take every first digit div by\n    // 1000,100,10,1 and update num - num% to get the rest\n\n    //it s clunky, hard to read\n    int digit = 0 ;\n\n    Integer res_int = new Integer(num) ;\n\n    int num_len = res_int.toString().length();// need to know if the number is 3-digit,4-digit etc\n    //so we can know the power of 10 - 10^3, 10^2, 10^1 etc\n    System.out.println(\"len of num : \" + num_len) ;\n    num_len-- ;\n    double base = 0 ;\n    int temp ;\n    while( num_len &gt;= 0){      \n      temp = num ;\n      base = Math.pow(10,num_len) ;      \n      num = num / (int)base ;// type recasting to int is a must, it does not work without it - no idea why\n      System.out.println(\"num :\"  + num) ;\n      num = (int) temp % (int)base ;      \n      num_len-- ;          \n  }\n\n  }\n  public static void print_digits(int num){\n    int digit = 0 ;\n    while(num != 0 ){\n    digit = num%10 ;\n    System.out.print(digit + \"\\t\") ;\n      num = num/ 10 ;      \n    }\n  }\n\n  public static void main(String args[]){\n              print_digits2(7658) ;\n              System.out.println(\"--------------------------\") ;\n              print_digits3(7658) ;\n  }\n\n}\n\n\nHow can I rewrite the print_digits2?  I want a more efficient MATH method of doing - no converting to string \\ char[]."], "tags": ["java", "strings", "parsing", "integer", "comparative-review"]}
{"texts": ["Custom exception handling function or logging library?", "I want to document every exception handled in my code and some states of the code when it works properly.\nWhat I've done is two functions, one that creates an 'error report' (function: error) and one that creates a 'state report'(function: state), and they work by being called in functions where there's stuff I'd like to have documented, they have a code parameter which I use to select the message of the report (apart from the exception, in the case of it being an error report) and then they call another function which takes this information and loads it to a JSON file(function: writeReport). If I'm being clear so far, you can skip all the code examples, my question is at the end.\n\nHere I show you the functions I mentioned before (messages are in spanish because its my main language):\n\n# Exception mesagges (this is the one that records exceptions)\ndef error(code, exception, extra=None):\n    if code == 0:\n        stateReport.message = ('Error indefinido')\n    elif code == 1:\n        stateReport.message = ('Error en la conexion o creacion de la base de datos')\n    elif code == 2:\n        stateReport.message = ('No se pudieron crear las tablas o ya existen')\n    elif code == 3:\n        stateReport.message = (f'No se pudo recuperar la tabla {extra}')\n    elif code == 4:\n        stateReport.message = (f'Error indefinido que no afecta al funcionamiento')\n    elif code == 5:\n        stateReport.message = (f'Error en manipulacion de GUI que no afecta al funcionamiento')\n    elif code == 100:\n        stateReport.message = (f'Error desconocido al presionar una tecla')\n    stateReport.function = (inspect.stack()[1].function)\n    stateReport.date_time = date_time\n    stateReport.error = str(exception)\n    writeReport()\n    return\n\n# State messages (this I use when some special case goes right)\ndef state(code, extra=None):\n    if code == 0:\n        stateReport.message = (f'El programa funciono correctamente')\n    elif code == 1:\n        stateReport.message = (f'Se accedio a la base de datos')\n    elif code == 2:\n        stateReport.message = (f'Se creo exitosamente la nueva tabla')\n    elif code == 3:\n        stateReport.message = (f'Valores ingresados incorrectos. Valor incorrecto: {extra}')\n    stateReport.function = (inspect.stack()[1].function)\n    stateReport.date_time = date_time\n    stateReport.error = '----------&gt;Sin errores&lt;----------' #This means \"No errors\"\n    writeReport()\n\n\ndef writeReport():\n    report = {'date': stateReport.date_time,\n               'function': stateReport.function,\n               'message': stateReport.message,\n               'error': stateReport.error}\n    if not os.path.exists(reportsFile):\n        with open(reportsFile, 'w', newline='') as file:\n            json.dump(report, file, indent=4)\n    else:\n        with open(reportsFile, 'a', newline='') as file:\n            json.dump(report, file, indent=4)\n    return\n\n\nNow, heres a function where I use this feature on, just so you see how I actually implemented it:\n\ntable = 'clientes'\n    ## This is the creation of a &lt;new&gt; table in an sqlite database\ntry:\n    c.execute(f'''CREATE TABLE {table} (\n    id integer,\n    nombre text,\n    apellido text,\n    valoracion real)''')\n    state(2) \n    ##If the table is successfully created a state report is saved with this info\nexcept Exception as e:\n    error(2, e, table) \n    ##On the contrary, if an exception occurs, en error report is recorded\n\n\nThis works great, but today I ran into the logging library (im kinda new in python) and it made me think. Is it better to use loggings in all of this cases? It would create a file with everything, it's allready a python library and I would avoid having three separate functions just for recording stuf, but I dont know if it's logging proper way of using it."], "tags": ["python", "python-3.x", "error-handling", "logging"]}
{"texts": ["AngularJS services for APIs in large applications", "I've been reading about AngularJS services and factories, and how you should strive for a thin controller, but as the project I've been working on grows it seems more and more impractical with as interconnected as the app is.  For a little background, I am using UI-Grid to display most data in the app (20+ grids) and MVC5.  At the moment, I've placed all of my API calls to SQL within the main controller, along with all of my grid definitions:\n\napp.controller('MainController', ['$scope', '$http', '$filter', 'logger', function ($scope, $http, $filter, logger) {\n\n    $scope.project = {};\n\n    /*\n    * Grid Listing Definition\n    */\n    $scope.gridListing = { enableRowSelection: true, enableRowHeaderSelection: false, multiSelect: false, enableColumnMenus: false, enableSorting: false };\n    $scope.gridListing.onRegisterApi = function (gridApi) {\n        // Set api on scope\n        $scope.gridListing.Api = gridApi;\n        gridApi.selection.on.rowSelectionChanged($scope, function (row) {\n            $scope.gridListing.selectedRow = false; // Used for visibility on the view\n            if (row.isSelected) {\n                $scope.gridListing.selectedRow = row.entity;\n            };\n        });\n    };\n    $scope.gridListing.columnDefs = [\n        { field: 'ListingNumber', displayName: 'Number', type: 'number', width: '10%' }\n        , { field: 'CreatedOn', displayName: 'CreatedOn', type: 'date', cellFilter: 'date:\"yyyy-MM-dd\"', width: '10%' }\n        , { field: 'CreatedBy', displayName: 'CreatedBy', width: '10%' }\n        , { field: 'Description', displayName: 'Description' }\n        , { field: 'FunctionState', displayName: 'State', width: '10%' }\n    ];\n\n    $scope.load_gridListing = function () { // Update when new Listing is selected\n        $scope.gridListing.data = []; // Clear grid for new data\n        $http.get('/api/qryListingAPI/?project=' + $scope.project.ProjectID)\n        .then(function (response) {\n            $scope.gridListing.data = response.data;\n        })\n        .catch(function (response) {\n            // Custom logger for error tracking\n            logger.log(usrName, 'app', response.status + \" - \" + response.statusText, logger.Error);\n        });\n    };\n}]);\n\n\nAs the user interacts with objects in the view, like selecting a new project etc. various grids need to be updated to reflect the users selection.  I had tied these \"load\" functions on the view to update grids as needed.  I had originally thought of creating services for each of the views that I use to populate these grids, but with so many, and needing to share between controllers, I elected not to to avoid massive controller definitions and added complexity making sure each controller was on the same page.  I may be misunderstanding how to implement AngularJS the way many say AngularJS should be implemented and making it more complicated than it needs to be.  Any suggestions for implementing an app with 20+ grids and 30+ APIs?"], "tags": ["javascript", "angular.js"]}
{"texts": ["Try every username and password from a list on a website", "This code will be brute force specific site using http POST method.    \n\n def BruteForce(url, username, password):\n        userfile = open(username, \"r\")\n        userlist = userfile.read()\n        userlist = userlist.split(\"\\n\")\n\n        passfile = open(password, \"r\")\n        passlist = passfile.read()\n        passlist = passlist.split(\"\\n\")\n\n        for i in userlist:\n            for j in passlist:\n                data = {\"username\":i, \"password\": j}\n                data2 = {\"username\":i, \"password\": j}\n                data = urllib.urlencode(data)\n                request = urllib2.Request(url, data)\n\n                response = urllib2.urlopen(request)\n                payload = response.read()\n\n                isconnect = \"True\"\n                if(payload.find(isconnect)&gt;=0):\n                    print \"Found, the password is: \" + data2[\"password\"] + \" and the username is: \" + data2[\"username\"]\n                    return \n\n                else:\n                    pass\n\n\nIs this code efficient?\nHow I can improve my code?\nShould I use multithreading mechanism to speed up my script?"], "tags": ["python", "http", "authentication"]}
{"texts": ["Use a context manager to save an object on exit", "The following code uses a context manager to store and load variables into files.\nHowever, it's very annoying to have to set the value property of what is yielded by the context manager (loaded.value).\nI would like to\n\n\nNot have to define a new class like LoadedValue\nSet the yielded value of the context manager (loaded) to be the value that is saved.\n\n\nAny way of doing either of those two (as well as other helpful improvements) would be greatly appreciated.\n\nimport os\nimport pickle\nfrom contextlib import contextmanager\n\nclass LoadedValue:\n    def __init__(self, value):\n        self.value = value\n\n    def __str__(self):\n        return \"&lt;LoadedValue: {}&gt;\".format(self.value)\n\n@contextmanager\ndef load_manager(load_file=\"file.pkl\"):\n    with open(load_file, \"rb\") as f:\n        loaded_object = LoadedValue(pickle.load(f))\n    try:\n        yield loaded_object\n    finally:\n        with open(load_file, \"wb+\") as f:\n            pickle.dump(loaded_object.value, f)\n\nif __name__ == \"__main__\":\n    filename = \"test.pkl\"\n    with open(filename, \"wb+\") as f:\n        pickle.dump(7, f)\n\n    with load_manager(filename) as loaded:\n        print(loaded) # &gt;&gt;&gt; &lt;LoadedValue: 7&gt;\n        loaded.value = 5 # this is what I have to do\n        # loaded = 5  # this is what I want to do\n\n    with load_manager(filename) as loaded:\n        print(loaded) # &gt;&gt;&gt; &lt;LoadedValue: 5&gt;"], "tags": ["python", "python-3.x"]}
{"texts": ["Circle Shadow Experiment", "I'm trying to create a light system, with the midpoint algorithm and Bresenham Line Algorithm. I'm trying to redraw all the time (1 option) or redraw when I need to.  When the circles are too big it becomes a bit laggy.\n\nExample\n\nfunction Light(x, y, range)\n{\n    this.CordX = x;\n    this.CordY = y;\n    this.LuminosityRange = range;\n}\n   setInterval(function(){\n        stats.begin(); // Begin to count FPS\n        ctx.clearRect(0, 0, Width, Height); // Clear Canvas\n\n        // STEP 1 -- DRAW THE BACKGROUND (BLACK)\n        for(var y = 0; y &lt; Height; y++)\n        {    \n            for(var x = 0; x &lt; Width; x++)\n            {\n                var index = x + (y * Width),\n                    indexColor = index * 4;\n\n                shadowBitMapData[indexColor + 0] = shadowBitMapData[indexColor + 1] = shadowBitMapData[indexColor + 2] = 0;\n                shadowBitMapData[indexColor + 3] = 255;\n            }\n        }\n\n        // SETEP 2 -- DRAW THE LIGHT\n        for(var light = 0; light &lt; lamps.length; light++)\n        {\n            var currentLight = lamps[light];\n            var xCL = ~~currentLight.CordX,\n                yCL = ~~currentLight.CordY,\n                iCL = xCL + (yCL * Width),\n                rCL = ~~currentLight.LuminosityRange;\n\n            // MidPoint Algorithm\n            var xMP = rCL,\n                yMP = 0,\n                rEMP = 1 - xMP;\n\n            while(xMP &gt;= yMP)\n            {\n\n                var x1 = xMP + xCL,\n                    x2 = yMP + xCL,\n                    x3 = -xMP + xCL,\n                    x4 = -yMP + xCL;\n\n                var y1 = yMP + yCL,\n                    y2 = xMP + yCL,\n                    y3 = -yMP + yCL,\n                    y4 = -xMP + yCL;\n\n                var index1 = x1 + (y1 * Width);\n                var index2 = x2 + (y2 * Width);\n\n                var index3 = x3 + (y1 * Width);\n                var index4 = x4 + (y2 * Width);\n\n                var index5 = x3 + (y3 * Width);\n                var index6 = x4 + (y4 * Width);\n\n                var index7 = x1 + (y3 * Width);\n                var index8 = x2 + (y4 * Width);\n\n\n                // Fill Top\n                //shadowBitMapData[index6 * 4 + 3] = 0;\n                //shadowBitMapData[index8 * 4 + 3] = 0;\n                BresenhamLine(x4, y4, x2, y4, shadowBitMapData, Width);\n\n                // Fill Mid Top\n                //shadowBitMapData[index5 * 4 + 3] = 0;\n                //shadowBitMapData[index7 * 4 + 3] = 0;\n                BresenhamLine(x3, y3, x1, y3, shadowBitMapData, Width);\n\n                // Fill Mid Bottom\n                //shadowBitMapData[index1 * 4 + 3] = 0;\n                //shadowBitMapData[index3 * 4 + 3] = 0;\n                BresenhamLine(x1, y1, x3, y1, shadowBitMapData, Width);\n\n                // Fill Bottom\n                //shadowBitMapData[index2 * 4 + 3] = 0;\n                //shadowBitMapData[index4 * 4 + 3] = 0;\n                BresenhamLine(x2, y2, x4, y2, shadowBitMapData, Width);\n\n                yMP++;\n\n                if (rEMP &lt; 0)\n                {\n                    rEMP += 2 * yMP + 1;\n                }\n                else\n                {\n                    xMP--;\n                    rEMP += 2 * (yMP - xMP + 1);\n                }\n            }\n        }\n\n        ctx.putImageData(shadowBitMap, 0, 0); // Draw Shadow\n        stats.end(); // End to count FPS\n    }, 1000 / 60);\n\nfunction BresenhamLine(x0, y0, x1, y1, bitmap, Width)\n{\n    var dx = Math.abs(x0 - x1);\n    var dy = Math.abs(y0 - y1);\n\n    var sx = x1 &lt; x0 ? 1 : -1; \n    var sy = y1 &lt; y0 ? 1 : -1; \n\n    var err = dx - dy;\n    var e2;\n\n    var lm = 0;\n    while (true)\n    {\n        bitmap[(x1 + y1 * Width) * 4 + 3] = 0;\n\n        if (x1 == x0 &amp;&amp; y1 == y0) break;\n\n        e2 = 2 * err;\n        if (e2 &gt; -dy) \n        {\n            err = err - dy;\n            x1 = x1 + sx;\n        }\n\n        if (e2 &lt; dx) \n        {\n            err = err + dx;\n            y1 = y1 + sy;\n        }\n    }\n}"], "tags": ["javascript", "performance", "algorithm", "graphics"]}
{"texts": ["Sieve of Eratosthenes implementation is running slowly", "I have written this code to find prime numbers, and it works well, but the calculation speeds are incredibly slow.  Am I doing this wrong? I know that I might be really doing this the wrong way, but please help me!\n\nusing System;\nusing System.Collections.Generic;\n\nnamespace Primenumbers\n{\nclass MainClass\n{\n    public static void Main (string[] args)\n    {\n\n        List&lt;int&gt; NoPrime = new List&lt;int&gt;();\n\n        for(int x = 2; x &lt; 10000;x++)\n        {\n            for(int y = x * 2;y &lt; 10000;y = y + x)\n            {\n\n            if(!NoPrime.Contains(y))\n                {\n                    NoPrime.Add(y);\n                }\n\n            }\n\n        }\n\n        for(int z = 2; z &lt; 10000;z++)\n        {\n            if(!NoPrime.Contains(z))\n            {\n                Console.WriteLine(z);\n            }\n        }\n\n\n    }\n}\n}"], "tags": ["c#", "primes", "sieve-of-eratosthenes"]}
{"texts": ["Menu List and interaction", "I am wondering if someone can review my code and tell me if there is a way to enhance it and make it more efficient.\n\nimport java.util.Scanner;\n\npublic class apples {\n    public static void main (String[] args){\n        Scanner input = new Scanner(System.in);\n\n        int selection;\n\n        for (int i=0; i&lt;4;i++){\n            System.out.println(\"Please enter the selection you would like\");\n            System.out.println(\"Enter 1 for Coffee\");\n            System.out.println(\"Enter 2 for Tea\");\n            System.out.println(\"Enter 3 for Juice\");\n            System.out.println(\"Enter 4 for Fizzy Drink\");\n            selection = input.nextInt();\n            if(selection==1){\n                System.out.println(\"You have chosen coffee\");\n            }\n            if(selection==2){\n                System.out.println(\"You have chosen tea\");\n            }\n            if(selection==3){\n                System.out.println(\"You have chosen juice\");\n            }\n            if(selection==4){\n                System.out.println(\"You have chosen fizzy drink\");\n            }\n            if(selection&lt;1 || selection&gt;4){\n                System.out.println(\"You have made a wrong selection, please re-select\");\n            }\n        }\n    }\n}"], "tags": ["java"]}
{"texts": ["Implementation of IpV4Address", "For legacy reason (guys here LOVE immutable object), I need a struct that contain an IpV4.\n\nI can't use System.Net.IPAddress because it's not a struct.\n\nSo far here what I got:\n\npublic struct IpV4Address\n{\n    readonly byte[] address;\n\n    public IpV4Address(byte[] address)\n    {\n        Throw.IfArgumentIsNull(\"address\", address);\n\n        if (address.Length != 4)\n        {\n            throw new ArgumentException(\"Wrong address length\", \"address\");\n        }\n\n        this.address = new byte[4];\n        Array.Copy(address, this.address, 4);\n    }\n\n    public override string ToString()\n    {\n        return string.Join(\".\", address);\n    }\n\n    /// &lt;summary&gt;\n    ///     Parse a string representing an IPV4.\n    ///     &lt;example&gt;xxx.yyy.zzz.www&lt;/example&gt;\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"quadDotted\"&gt;The string to parse.&lt;/param&gt;\n    /// &lt;returns&gt;The IPV4&lt;/returns&gt;\n    public static IpV4Address Parse(string quadDotted)\n    {\n        Throw.IfArgumentIsNull(\"quadDotted\", quadDotted);\n\n        var bytes = quadDotted.Split('.').Select(byte.Parse).ToArray();\n\n        return new IpV4Address(bytes);\n    }\n\n    /// &lt;summary&gt;\n    ///     Try parse a string representing an IPV4.\n    ///     &lt;example&gt;xxx.yyy.zzz.www&lt;/example&gt;\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"quadDotted\"&gt;The string to parse.&lt;/param&gt;\n    /// &lt;param name=\"result\"&gt;The IPV4&lt;/param&gt;\n    /// &lt;returns&gt;A value indicating whether the parse succeed.&lt;/returns&gt;\n    public static bool TryParse(string quadDotted, out IpV4Address result)\n    {\n        if (quadDotted == null)\n        {\n            goto Fail;\n        }\n\n        var elements = quadDotted.Split('.');\n        if (elements.Length != 4)\n        {\n            goto Fail;\n        }\n\n        var address = new byte[4];\n        for (var i = 0; i &lt; 4; i++)\n        {\n            if (!byte.TryParse(elements[i], out address[i]))\n            {\n                goto Fail;\n            }\n        }\n\n        result = new IpV4Address(address);\n        return true;\n\n        Fail:\n        result = default(IpV4Address);\n        return false;\n    }\n\n\nIt's the first time I use a goto in a C# code. And I don't feel ashamed !"], "tags": ["c#", "parsing", "ip-address"]}
{"texts": ["Best practise way to handle array of pairs", "I am trying to randomly select 4 items out of an array, each item has an index, a name and a price attached to it. Currently I have the following code segment to select 4 at random:\n\n\n\nfunction SelectItems()\n{\n     $arrayItems = array( \n          1 =&gt; \"Name of Item 1\",\n          2 =&gt; \"Name of Item 2\",\n          3 =&gt; \"Name of Item 3\",\n          4 =&gt; \"Name of Item 4\",\n     );\n\n     $arrayItemPrices = array(\n          1 =&gt; \"$6.00\",\n          2 =&gt; \"$4.00\",\n          3 =&gt; \"$5.00\",\n          4 =&gt; \"$15.00\",\n     );\n\n     $randomKeys = array_rand( $arrayItems, 4 );\n     foreach( $randomKeys as $key )\n     {\n          $name = $arrayItems[$key];\n          $price = $arrayItemPrices[$key];\n\n          /* Process item... */\n     }\n}\n\n\nHowever, this is not how I would approach it in C++, I would only use a std::map&lt;int, std::pair&lt;std::string, std::string&gt;&gt;, this would map directly in PHP to an array where the value consisted of a pair of strings, however as there is no pair class in PHP I have done it with two arrays. Is this best practise in PHP?"], "tags": ["php", "array"]}
{"texts": ["Process 2 lists concurrently with the first list adding to the second", "I'm new to multi-threading and concurrency. I've got 2 lists that I want to process concurrently. Processing both lists requires a lot of time.sleep() and waiting for other servers to finish, so I figured rather than do one at a time I could process them simultaneously.\n\nThe first list is un-validated items and I try to validate them and if successful add them to the second list for processing. I want to start validating items in the first list and then while that is going start on the processing of the 2nd list. I've since found out I wanted a Queue for the 2nd list and that has helped but I can't help but feel that even though this works I'm missing something.\n\ndef process_sr(jira, tuple, args, log):\n    ... # does some pretty straight forward stuff but lots of waiting\n    return \"done\"\n\ndef waiting_for_build(tuple, validqueue, log):\n    sr, pr = tuple\n    iter = 0\n    log.info(\"Waiting for {} to re-build\".format(pr))\n    while iter &lt; 30:  # don't add. It's been more than 10 minutes and we need to finish\n        log.debug(\"%s still waiting for Jenkins\", pr)\n        sleep(20)\n        status = pr.build_status()\n        if status is None:\n            break  # don't add. Build finished \"FAILURE\" or didn't build in 10 min\n        elif status == \"Wait\":\n            iter += 1\n        elif status == \"Done\":\n            validqueue.put((sr,pr))\n\ndef build_lists(jira, log):\n    validqueue = Queue()\n    waiting_for_jenkins = []\n    ...  # this builds the two lists\n    return validqueue, waiting_for_jenkins\n\ndef main():\n    args, log = cli_args()\n    jira = JiraWrapper()\n\n    validqueue, waiting_for_jenkins = build_lists(jira, log)\n\n    workers = len(waiting_for_jenkins) + validqueue.qsize()\n\n    threads = []\n    for item in waiting_for_jenkins:\n        name = str(item[1])\n        threads.append(threading.Thread(target=waiting_for_build, name=name, args=(item, validqueue, log)))\n        threads[-1].start()\n\n    def worker(i):\n        log.debug(\"started\")\n        results = []\n        while True:\n            log.debug(\"blocking on queue\")\n            item = validqueue.get()\n            if item is None:\n                log.debug(\"done\")\n                return results\n            log.debug(\"got item %s\", item)\n            result = process_sr(jira, item, args, log)\n            results.append({result:item})\n            log.debug(\"task %s done\", item)\n            validqueue.task_done()\n\n    log.debug(\"%d workers will be spawned\", workers)\n    if not workers:\n        log.info(\"Nothing to do here\")\n    else:\n        with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as executor:  # can't use thread_name_prefix until python 3.6\n            futures = executor.map(worker, range(workers))\n\n            for thread in threads:\n                thread.join()\n            validqueue.join()\n\n            for i in range(workers):\n                validqueue.put(None)\n            for future in futures:\n                log.debug(future)\n\n    exit(0)\n\n\nif __name__ == '__main__':\n    main()\n\n\nI've included as much as I think is needed. The main() method and specifically the two multi-threaded bits are where I'm looking for feedback."], "tags": ["python", "python-3.x", "multithreading", "concurrency"]}
{"texts": ["Admin method in CakePHP to add a venue to the database", "I have a VenuesController and an EventsController. My venues controller has an admin_add method that, well, allows an administrator to add a venue to the database. It looks like this:\n\npublic function admin_add() {\n    if ($this-&gt;request-&gt;is('post')) {\n        if ($this-&gt;Venue-&gt;save($this-&gt;request-&gt;data)) {\n            $message = 'Venue has been created.';\n            $this-&gt;response-&gt;statusCode(201);\n            if ($this-&gt;request-&gt;params['ext'] == 'json') {\n                $this-&gt;set('id', $this-&gt;Venue-&gt;id);\n                $this-&gt;set('_serialize', array('id'));\n            }\n            else {\n                $this-&gt;Session-&gt;setFlash($message, 'flash', array('class' =&gt; 'success'));\n                $this-&gt;redirect(array('action' =&gt; 'index'));\n            }\n        }\n        else {\n            if ($this-&gt;request-&gt;params['ext'] == 'json') {\n                $this-&gt;set('validationErrors', $this-&gt;Venue-&gt;validationErrors);\n                $this-&gt;set('_serialize', array('validationErrors'));\n                $this-&gt;response-&gt;statusCode(400);\n            }\n        }\n    }\n}\n\n\nAs you can see, there are a lot of if () statements which seem like code smells to me. But they\u2019re there because in my CMS\u2019s events section, you can add a venue inline via a modal, which sents the request to this function via AJAX.\n\nSo my question is: can I improve the above VenuesController::admin_add() method, make it more intelligent without the need for the if () statements, and just generally make it more CakePHP-ier?"], "tags": ["php", "controller", "cakephp"]}
{"texts": ["Caesar Cypher guessing game", "Caeser's cipher code where there are a converter and a game part with user input. The code includes keys (settable and not settable).\n\nimport random\n\n\ndef change_letter(original, new_message, key_number, alpha):\n    for letter in original:\n        if letter in alpha.lower():\n            new_message += alpha[(alpha.lower().index(letter) + key_number) % 26].lower()\n        elif letter in alpha:\n            new_message += alpha[(alpha.index(letter) + key_number) % 26]\n        else:\n            new_message += letter\n\n    return new_message\n\n\ndef encipher(the_key, message, inp=True):\n    alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    output_message = \"\"\n\n    if inp:\n        try:\n            the_key = int(input('Key?  \u30fb  '))\n        except ValueError:\n            the_key = input('\\nNot valid input  \u30fb  ')\n            while not the_key.isnumeric():\n                the_key = input('Not valid input  \u30fb  ')\n\n    output_message = change_letter(message, output_message, int(the_key), alphabet)\n\n    return output_message\n\n\ndef convert():\n    while True:\n        key = None\n        type_word = input('\\nType your word  \u30fb  ')\n        print('\\n{}  ::  {}'.format(type_word, encipher(key, type_word)))\n        convert_again = input('\\nWould you like to convert again? | Y/N  \u30fb  ').upper()\n\n        if convert_again == 'Y' or convert_again == 'YES':\n            continue\n        break\n\n\ndef play():\n    while True:\n        key = random.randint(1, 25)\n        words = ('WWE', 'Javascript', 'Pythonista', 'Computer Science', 'Eighty-three', 'Event Log', '5K Freestyle')\n        word = random.choice(words)\n        question = input('\\nWhat is {} of key {}  \u30fb  '.format(word, key)).lower()\n        changed_word = encipher(key, word, inp=False)\n\n        if question == changed_word.lower():\n            print(f'Congratulations! You guessed {changed_word} from {word}')\n        else:\n            print(f'Oops! Wrong answer. The word is {changed_word} from {word}')\n\n        play_again = input('\\nWould you like to play again? | Y/N  \u30fb  ')\n\n        if play_again.upper() == 'YES' or play_again.upper() == 'Y':\n            continue\n        break\n\n\ndef main():\n    while True:\n        convert_or_play = input('C to convert, P to play  \u30fb  ')\n        if convert_or_play.upper() == 'C':\n            convert()\n        elif convert_or_play.upper() == 'P':\n            play()\n        else:\n            break\n        print()\n\n\nif __name__ == '__main__':\n    main()"], "tags": ["python", "beginner", "python-3.x", "game", "caesar-cipher"]}
{"texts": ["Flux: async communication with websockets", "I want to arrange async server-client communication with websockets and vanilla flux architecture. There is an excellent article about \"Async Server-Side Communication with the Flux Architecture\". I gonna implement it analogue with SockJS and ES6 promises:\n\nActionCreator.js     - it's the same but moved to ES6\n\nimport * as constants from ('../constants/constants'),  \nimport TodoService = require('../services/todo-service');\n\nclass ActionCreator {  \n\n  addTodo(text) {\n    var that = this;\n    service.addTodo({text: text}).then(function(todo) {\n        that.dispatch(constants.ADD_TODO, todo);\n    });\n  }\n}\n\nexport default new ActionCreator();\n\n\nservices/todo-service.js - even shorter\n\nimport WebSocketWrapper from 'WebSocketWrapper';\n\nclass TodoService {\n\n    addTodo(todo) {\n        //maybe do something with todos before send them to the server\n        return WebSocketWrapper.send(todo);\n    }\n}\n\nexport default new TodoService();\n\n\nWebSocketWrapper.js \n\n/**\n * Due fact that SockJS provide raw websocket API and do not implement pub/sub, we need to do wrapper, which will corellate request/response\n */\n\nimport SockJS from 'sockjs';\nimport selectn from 'selectn';\n\nvar reqId = 1; \nconst responseDeffers = {};\n\nclass WebSocketWrapper {\n\n    constructor(url) {\n        this.ws = new SockJS(url);\n        this.ws.onopen = this.onOpen;\n        this.ws.onmessage = this.onMessage;\n        this.ws.onclose = this.onClose;\n        this.ws.onerror = this.onError;\n    }, \n\n    onMessage(message) {\n        let requestId = selectn('message.data.request_id');\n        if (!requestId) return;\n        //resolve or reject the promise which is kept in ActionCreator\n        if (message.data.result === 'Ok') resolveRequest(requestId, message);\n        else rejectRequest(requestId, message.error);\n    },\n\n    /**\n     * Return Promise, which will be resolved/rejected on server response with the same requestId\n     */\n    send(request) {  \n        return new Promise(function(resolve, reject) {\n            //cache resolve/reject function to be able to invoke themn on server response\n            responseDeffers[reqId++] = {\n                resolve: res,\n                reject: rej\n            };\n            //send message via websockets\n            if (this.ws.readyState == this.ws.OPEN) {\n                this.ws.send(JSON.stringify(request));\n            } else {\n                reject('Websocket connection is closed');\n            }\n        });\n    },\n\n    resolveRequest(requestId, message) {\n        let response = JSON.parse(message.data);\n        responseDeffers[request_id].resolve(response);\n    },\n\n    rejectRequest(requestId, message) {\n        responseDeffers[requestId].reject(message);\n    }\n\n    onOpen() {},\n\n    oClose() {},\n\n    onError(e) {}\n}\n\nexport default new WebSocketStore(ENV.props.url);"], "tags": ["javascript", "ecmascript-6"]}
{"texts": ["Reducing allocations in arbitrary precision calculations with Julia", "I am new to Julia and have only written in python before which is most likely also reflected by my coding style.\nUnfortunately, my applications require very high numerical precision which is why I am resorting to BigFloat and BigInt in Julia. For some reason, this leads to a major increase in allocations besides the obvious increase in computational time.\nI am wondering where my code can be improved.\nI have attached the current version of my code below with example parameters that allow for execution under 1s.\nusing Combinatorics\n\nfunction gamma_mpnq(m::Int, p::Int, n::Int, q::Int)::BigFloat\n    return sqrt(factorial(big(m)) * factorial(big(n))) / (big(2)^(p + q) * factorial(big(m - 2 * p)) * factorial(big(n - 2 * q)) * factorial(big(q)) * factorial(big(p)))\nend\n\nfunction general_binomial(alpha::Float64, k::Int)\n    &quot;&quot;&quot;\n    Implementation of the generalized binomial.\n    &quot;&quot;&quot;\n    _prod = BigFloat(1.0)\n    for kk in 1:k\n        _prod *= (alpha - kk + 1.)\n    end\n    return _prod / factorial(big(k))\nend\n\nfunction construct_M(nmax::Int, mmax::Int)::Array\n    &quot;&quot;&quot;\n    Construct the matrix M containing all moments &lt;C^n * C*^m&gt; up to nmax and mmax.\n    &quot;&quot;&quot;\n    _M = zeros(BigFloat, nmax, mmax)\n    for mm in 1:nmax\n        for nn in 1:mmax\n            if nn == 1\n                _M[nn, mm] = 1. / doublefactorial(BigInt(2*mm - 1))\n            elseif mm == 1\n                _M[nn, mm] = 1. / doublefactorial(BigInt(2*nn - 1))\n            else\n                _M[nn, mm] = (((nn-1) * _M[nn-1, mm] + (mm-1) * _M[nn, mm-1]) / (2. * (nn-mm)^2 + (nn-1) + (mm-1)))\n            end\n        end\n    end\n    return _M\nend\n\n\nfunction maclaurin_exp(n::Int, m::Int, p::Int, q::Int, M::Array, cutoff::Int)::BigFloat\n    &quot;&quot;&quot;\n    Calculate the expectation value of ((1+C)/(1+C*))^((n-m)/2) * C^p * C*^q\n    using the Maclaurin expansion and the matrix containing all moments M.\n    &quot;&quot;&quot;\n    inner::BigFloat = 0.0\n    @views for nn in 1:cutoff\n        for mm in 1:cutoff\n            inner += (general_binomial((n-m)/2., mm-1) * general_binomial((m-n)/2., nn-1) * M[q+nn, p+mm])\n        end\n    end\n    return inner\nend\n\nfunction Hmn(m::Int, n::Int, M::Array, cutoff::Int)::Float64\n    &quot;&quot;&quot;\n    Calculates a single entry of the Hmn matrix.\n    &quot;&quot;&quot;\n    ppmax = div(m, 2)\n    qqmax = div(n, 2)\n    outer = 0.0\n    for pp in 0:ppmax\n        for qq in 0:qqmax\n            outer += (gamma_mpnq(m, pp, n, qq) * maclaurin_exp(n, m, pp, qq, M, cutoff))\n            # println(pp, &quot; &quot;, qq, &quot; &quot;, outer)\n        end\n    end\n    return outer\nend\n\ndim = 128\ncutoff = 64\nM = construct_M(dim+cutoff, dim+cutoff)\n@btime Hmn(12, 2, M, cutoff)\n\n```"], "tags": ["performance", "julia"]}
{"texts": ["Count groups of open cells around a cell on a grid", "Consider a 3x3 square surrounding a cell (marked @) on a grid:\n\n0 1 1\n1 @ 0\n1 1 1\n\n\nI need to find the number of groups of open cells (ones) surrounding the center cell. In the above example, there are two groups of open cells. All cells have the value 0, closed, or 1, open.\nHere's what I have:\n\n{\n    // x and y coordinates for offsets corresponding\n    // to the eight neighboring cells\n    const xDir = [0, 1, 1, 1, 0,-1,-1,-1];\n    const yDir = [1, 1, 0,-1,-1,-1, 0, 1];\n\n    // generate a randomly open (1) or closed (0) 3 by 3 square of cells\n    const generateSquare = _ =&gt; {\n        const square = [];\n        for (let x = 0; x &lt; 3; x++) {\n            square[x] = [];\n            for (let y = 0; y &lt; 3; y++) {\n                square[x][y] = Number(Math.random() &lt; 0.5);\n            }\n        }\n        return square;\n    };\n\n    // count the number of contiguous groups of open (1) cells\n    const countGroups = square =&gt; {\n        let groups = 0;\n        // loop clockwise through neighbors and count transitions from 0 to 1\n        let prev = square[0][2];\n        for (let i = 0; i &lt; 8; i++) {\n            let curr = square[1 + xDir[i]][1 + yDir[i]];\n            groups += Number(!prev &amp;&amp; curr);\n            prev = curr;\n        }\n        // if there aren't any transitions, check if all neighbors are 1\n        return !groups &amp;&amp; prev ? 1 : groups;\n    };\n\n    const square = generateSquare();\n    console.table(square);\n    console.log(countGroups(square));\n}\n\n\nIs there anything I can improve?"], "tags": ["javascript", "algorithm", "ecmascript-6"]}
{"texts": ["Iterating through 128-byte records in a file", "I need to read records from a flat file, where each 128 bytes constitutes a logical record. The calling module of this below reader does just the following.\n\n\nwhile(iterator.hasNext()){\n    iterator.next();\n    //do Something\n }\n\n\n\nMeans there will be a next() call after every hasNext() invocation.\n\nNow here goes the reader.\n\npublic class FlatFileiteratorReader implements Iterable&lt;String&gt; {\n\n    FileChannel fileChannel;\n\npublic FlatFileiteratorReader(FileInputStream fileInputStream) {\n    fileChannel = fileInputStream.getChannel();\n}\n\nprivate class SampleFileIterator implements Iterator&lt;String&gt; {\n    Charset charset = Charset.forName(\"ISO-8859-1\");\n    ByteBuffer byteBuffer = MappedByteBuffer.allocateDirect(128 * 100);\n    LinkedList&lt;String&gt; recordCollection = new LinkedList&lt;String&gt;();\n    String record = null;\n\n    @Override\n    public boolean hasNext() {\n        if (!recordCollection.isEmpty()) {\n            record = recordCollection.poll();\n            return true;\n        } else {\n            try {\n                int numberOfBytes = fileChannel.read(byteBuffer);\n                if (numberOfBytes &gt; 0) {\n                    byteBuffer.rewind();\n                    loadRecordsIntoCollection(charset.decode(byteBuffer)\n                            .toString().substring(0, numberOfBytes),\n                            numberOfBytes);\n                    byteBuffer.flip();\n                    record = recordCollection.poll();\n                    return true;\n                }\n            } catch (IOException e) {\n                // Report Exception. Real exception logging code in place\n            }\n        }\n        try {\n            fileChannel.close();\n        } catch (IOException e) {\n            // TODO Report Exception. Logging\n        }\n        return false;\n\n    }\n\n    @Override\n    public String next() {\n        return record;\n    }\n\n    @Override\n    public void remove() {\n        // NOT required\n\n    }\n\n    /**\n     * \n     * @param records\n     * @param length\n     */\n    private void loadRecordsIntoCollection(String records, int length) {\n        int numberOfRecords = length / 128;\n        for (int i = 0; i &lt; numberOfRecords; i++) {\n            recordCollection.add(records.substring(i * 128, (i + 1) * 128));\n        }\n    }\n\n}\n\n    @Override\n    public Iterator&lt;String&gt; iterator() {\n        return new SampleFileIterator();\n    }\n}\n\n\nThe code reads 80 mb of data in 1.2 seconds on a machine with 7200 RPM HDD, with Sun JVM and running Windows XP OS. But I'm not that satisfied with the code I have written. Is there any other way to write this in a better way (especially the decoding to character set and taking only the bytes that has been read, I mean the charset.decode(byteBuffer) .toString().substring(0, numberOfBytes) part)?"], "tags": ["java", "performance", "io", "iterator", "file-structure"]}